import{L as o,j as i,z as s}from"./chunk-F5WAPTHD.js";import{a as c,b as D}from"./chunk-7CGTOI24.js";var l=class d{generalDrugs=[{id:"DRG001",name:"Paracetamol 500mg",description:"Pain reliever and fever reducer",manufacturer:"ABC Pharmaceuticals",internationalBarcode:"1234567890123"},{id:"DRG002",name:"Ibuprofen 200mg",description:"Nonsteroidal anti-inflammatory drug",manufacturer:"MedTech Industries",internationalBarcode:"1234567890124"},{id:"DRG003",name:"Amoxicillin 250mg",description:"Antibiotic",manufacturer:"ABC Pharmaceuticals",internationalBarcode:"1234567890125"}];pharmacyDrugs=[{id:"PDRG001",generalDrugId:"DRG001",pharmacyId:"ph1",internalBarcode:"123456",price:5.5,priceAfterDiscount:5,stockQuantity:150,minimumStock:50,expiryDate:new Date("2025-12-31"),status:"active",costLayers:[{quantity:150,unitCost:3.5,purchaseDate:new Date("2024-01-15"),expiryDate:new Date("2025-12-31")}],createdAt:new Date("2024-01-15"),updatedAt:new Date("2024-11-27")},{id:"PDRG002",generalDrugId:"DRG002",pharmacyId:"ph1",internalBarcode:"123457",price:8,priceAfterDiscount:7.5,stockQuantity:100,minimumStock:30,expiryDate:new Date("2025-11-30"),status:"active",costLayers:[{quantity:100,unitCost:5,purchaseDate:new Date("2024-02-10"),expiryDate:new Date("2025-11-30")}],createdAt:new Date("2024-02-10"),updatedAt:new Date("2024-11-26")},{id:"PDRG003",generalDrugId:"DRG003",pharmacyId:"ph1",internalBarcode:"123458",price:12,priceAfterDiscount:11.5,stockQuantity:25,minimumStock:50,expiryDate:new Date("2025-06-30"),status:"active",costLayers:[{quantity:50,unitCost:8,purchaseDate:new Date("2024-03-15"),expiryDate:new Date("2025-06-30")}],createdAt:new Date("2024-03-15"),updatedAt:new Date("2024-11-25")},{id:"PDRG004",generalDrugId:"DRG001",pharmacyId:"ph1",internalBarcode:"123459",price:6,priceAfterDiscount:5.5,stockQuantity:15,minimumStock:40,expiryDate:new Date("2025-01-15"),status:"active",costLayers:[{quantity:40,unitCost:4,purchaseDate:new Date("2024-04-20"),expiryDate:new Date("2025-01-15")}],createdAt:new Date("2024-04-20"),updatedAt:new Date("2024-11-24")},{id:"PDRG005",generalDrugId:"DRG002",pharmacyId:"ph1",internalBarcode:"123460",price:9,priceAfterDiscount:8.5,stockQuantity:200,minimumStock:50,expiryDate:new Date("2026-01-24"),status:"active",costLayers:[{quantity:200,unitCost:6,purchaseDate:new Date("2024-05-10"),expiryDate:new Date("2026-01-24")}],createdAt:new Date("2024-05-10"),updatedAt:new Date("2024-11-23")},{id:"PDRG006",generalDrugId:"DRG003",pharmacyId:"ph1",internalBarcode:"123461",price:15,priceAfterDiscount:14,stockQuantity:8,minimumStock:30,expiryDate:new Date("2026-01-17"),status:"active",costLayers:[{quantity:30,unitCost:10,purchaseDate:new Date("2024-06-01"),expiryDate:new Date("2026-01-17")}],createdAt:new Date("2024-06-01"),updatedAt:new Date("2024-11-22")},{id:"PDRG007",generalDrugId:"DRG001",pharmacyId:"ph1",internalBarcode:"123462",price:5.75,priceAfterDiscount:5.25,stockQuantity:45,minimumStock:60,expiryDate:new Date("2025-03-15"),status:"active",costLayers:[{quantity:60,unitCost:3.75,purchaseDate:new Date("2024-07-15"),expiryDate:new Date("2025-03-15")}],createdAt:new Date("2024-07-15"),updatedAt:new Date("2024-11-21")}];getAllGeneralDrugs(){return i([...this.generalDrugs]).pipe(s(300))}getGeneralDrugById(t){let e=this.generalDrugs.find(a=>a.id===t);return i(e||null).pipe(s(200))}getPharmacyDrugs(t){let e=t?.page||1,a=t?.pageSize||10,r=(e-1)*a,n=r+a,u=[...this.pharmacyDrugs],m=u.slice(r,n).map(p=>{let y=this.generalDrugs.find(h=>h.id===p.generalDrugId);return D(c({},p),{generalDrug:y||void 0})});return i({data:m,total:u.length,page:e,pageSize:a,totalPages:Math.ceil(u.length/a)}).pipe(s(500))}getPharmacyDrugById(t){let e=this.pharmacyDrugs.find(a=>a.id===t);if(e){let a=this.generalDrugs.find(r=>r.id===e.generalDrugId);return i(D(c({},e),{generalDrug:a||void 0})).pipe(s(300))}return i(null).pipe(s(300))}getPharmacyDrugByBarcode(t){let e=this.pharmacyDrugs.find(a=>a.internalBarcode===t);if(e){let a=this.generalDrugs.find(r=>r.id===e.generalDrugId);return i(D(c({},e),{generalDrug:a||void 0})).pipe(s(300))}return i(null).pipe(s(300))}createPharmacyDrug(t){let e=D(c({},t),{id:`PDRG${String(this.pharmacyDrugs.length+1).padStart(3,"0")}`,costLayers:t.costLayers||[],createdAt:new Date,updatedAt:new Date});return this.pharmacyDrugs.push(e),i(e).pipe(s(500))}updatePharmacyDrug(t,e){let a=this.pharmacyDrugs.findIndex(r=>r.id===t);if(a===-1)throw new Error("Pharmacy drug not found");return this.pharmacyDrugs[a]=D(c(c({},this.pharmacyDrugs[a]),e),{id:t,updatedAt:new Date}),i(this.pharmacyDrugs[a]).pipe(s(500))}deletePharmacyDrug(t){let e=this.pharmacyDrugs.findIndex(a=>a.id===t);return e===-1?i(!1).pipe(s(300)):(this.pharmacyDrugs.splice(e,1),i(!0).pipe(s(500)))}searchPharmacyDrugs(t){let e=t.toLowerCase(),r=this.pharmacyDrugs.filter(n=>{let u=this.generalDrugs.find(g=>g.id===n.generalDrugId);return n.internalBarcode.includes(t)||u?.name.toLowerCase().includes(e)||u?.internationalBarcode.includes(t)}).map(n=>{let u=this.generalDrugs.find(g=>g.id===n.generalDrugId);return D(c({},n),{generalDrug:u||void 0})});return i(r).pipe(s(300))}getLowStockDrugs(t){let a=this.pharmacyDrugs.filter(r=>r.stockQuantity<=(t||r.minimumStock)).map(r=>{let n=this.generalDrugs.find(u=>u.id===r.generalDrugId);return D(c({},r),{generalDrug:n||void 0})});return i(a).pipe(s(300))}getExpiringDrugs(t=30){let e=new Date;e.setDate(e.getDate()+t);let r=this.pharmacyDrugs.filter(n=>n.expiryDate&&n.expiryDate<=e&&n.expiryDate>=new Date).map(n=>{let u=this.generalDrugs.find(g=>g.id===n.generalDrugId);return D(c({},n),{generalDrug:u||void 0})});return i(r).pipe(s(300))}static \u0275fac=function(e){return new(e||d)};static \u0275prov=o({token:d,factory:d.\u0275fac,providedIn:"root"})};export{l as a};
