import{a as k}from"./chunk-FTPJSGKJ.js";import"./chunk-ZJFOQAOU.js";import{a as M}from"./chunk-A7FDB3QN.js";import{a as D}from"./chunk-HPCIBSL6.js";import"./chunk-EMAOCJ4C.js";import"./chunk-FRIZRQKD.js";import"./chunk-BYXBJQAS.js";import"./chunk-VSEEBRBA.js";import{a as b,b as h}from"./chunk-P3MRTKB5.js";import{b as I,d as _}from"./chunk-B4EO6REF.js";import{Da as E,Ia as d,Oa as u,Q as s,Ta as v,Xb as C,Ya as n,Za as i,_a as f,bb as S,cb as c,kb as a,lb as o,mb as g,nb as y,va as t,yb as r,zb as p}from"./chunk-Z4T7VGFQ.js";import"./chunk-7CGTOI24.js";function T(m,l){if(m&1&&(n(0,"div")(1,"label",11),a(2),r(3,"translate"),i(),n(4,"p",12),a(5),i()()),m&2){let e=c(2);t(2),o(p(3,2,"movements.reason")),t(3),o(e.movement.reason)}}function w(m,l){if(m&1&&(n(0,"div",17)(1,"span",18),a(2),r(3,"translate"),i(),n(4,"span",12),a(5),i()()),m&2){let e=c(2);t(2),o(p(3,2,"movements.unitCost")),t(3),o(e.formatCost(e.movement.unitCost))}}function L(m,l){if(m&1&&(n(0,"div",3)(1,"div",5)(2,"div",6)(3,"h2",7),a(4),i(),n(5,"p",8),a(6),i(),n(7,"div",9)(8,"div",10)(9,"div")(10,"label",11),a(11),r(12,"translate"),i(),n(13,"p",12),a(14),i()(),n(15,"div")(16,"label",11),a(17),r(18,"translate"),i(),n(19,"p",12),a(20),i()(),n(21,"div")(22,"label",11),a(23),r(24,"translate"),i(),n(25,"p",12),a(26),i()(),n(27,"div")(28,"label",11),a(29),r(30,"translate"),i(),f(31,"app-risk-badge",13),i()(),d(32,T,6,4,"div"),i()(),n(33,"div",6)(34,"h3",14),a(35),r(36,"translate"),i(),f(37,"app-timeline",15),i()(),n(38,"div",0)(39,"div",6)(40,"h3",14),a(41),r(42,"translate"),i(),n(43,"div",16)(44,"div",17)(45,"span",18),a(46),r(47,"translate"),i(),n(48,"span",12),a(49),i()(),n(50,"div",17)(51,"span",18),a(52),r(53,"translate"),i(),n(54,"span",12),a(55),i()(),d(56,w,6,4,"div",17),n(57,"div",17)(58,"span",18),a(59),r(60,"translate"),i(),n(61,"span",12),a(62),i()()()()()()),m&2){let e=c();t(4),o(e.movement.drugName||"Unknown Drug"),t(2),g("Movement ID: ",e.movement.id,""),t(5),o(p(12,23,"movements.type")),t(3),o(e.movement.movementType),t(3),o(p(18,25,"movements.quantity")),t(3),y("",e.movement.quantity>0?"+":"","",e.movement.quantity,""),t(3),o(p(24,27,"movements.staff")),t(3),o(e.movement.staffName),t(3),o(p(30,29,"movements.risk")),t(2),u("level",e.movement.riskLevel)("score",e.movement.riskScore),t(),v(e.movement.reason?32:-1),t(3),o(p(36,31,"movements.timeline")),t(2),u("events",e.timelineEvents),t(4),o(p(42,33,"movements.details")),t(5),o(p(47,35,"movements.previousQuantity")),t(3),o(e.movement.previousQuantity),t(3),o(p(53,37,"movements.newQuantity")),t(3),o(e.movement.newQuantity),t(),v(e.movement.unitCost?56:-1),t(3),o(p(60,39,"movements.timestamp")),t(3),o(e.formatDate(e.movement.timestamp))}}function N(m,l){m&1&&(n(0,"div",4)(1,"p"),a(2),r(3,"translate"),i()()),m&2&&(t(2),o(p(3,1,"common.loading")))}function q(m,l){m&1&&(n(0,"div",4)(1,"p"),a(2),r(3,"translate"),i()()),m&2&&(t(2),o(p(3,1,"movements.notFound")))}var B=class m{route=s(I);movementEngine=s(k);translationService=s(b);router=s(_);movement=null;loading=!1;timelineEvents=[];ngOnInit(){let l=this.route.snapshot.paramMap.get("id");l&&this.loadMovement(l)}loadMovement(l){this.loading=!0,this.movementEngine.getMovementById(l).subscribe({next:e=>{this.movement=e,e&&(this.timelineEvents=[{id:"1",title:this.translationService.translate("movements.movementRecorded"),description:`${e.movementType} - ${e.quantity} units`,timestamp:e.timestamp,type:e.riskLevel==="critical"||e.riskLevel==="high"?"danger":"info",metadata:{[this.translationService.translate("movements.staff")]:e.staffName||this.translationService.translate("movements.unknown"),[this.translationService.translate("movements.risk")]:e.riskLevel}}]),this.loading=!1},error:()=>{this.loading=!1}})}formatDate(l){return new Date(l).toLocaleString()}formatCost(l){return l.toFixed(2)}static \u0275fac=function(e){return new(e||m)};static \u0275cmp=E({type:m,selectors:[["app-movements-detail"]],decls:8,vars:4,consts:[[1,"space-y-6"],[1,"flex","items-center","justify-between"],[1,"text-sm","text-gray-600","hover:text-gray-900",3,"click"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6"],[1,"text-center","py-12"],[1,"lg:col-span-2","space-y-6"],[1,"p-6","rounded-lg",2,"background-color","var(--card-bg)"],[1,"text-xl","font-bold","mb-2"],[1,"text-sm","text-gray-600","mb-4"],[1,"mt-4","space-y-4"],[1,"grid","grid-cols-2","gap-4"],[1,"text-sm","text-gray-600"],[1,"font-medium"],[3,"level","score"],[1,"text-lg","font-semibold","mb-4"],[3,"events"],[1,"space-y-3","text-sm"],[1,"flex","justify-between"],[1,"text-gray-600"]],template:function(e,x){e&1&&(n(0,"div",0)(1,"div",1)(2,"button",2),S("click",function(){return x.router.navigate(["/inventory/movements"])}),a(3),r(4,"translate"),i()(),d(5,L,63,41,"div",3)(6,N,4,3,"div",4)(7,q,4,3,"div",4),i()),e&2&&(t(3),g(" \u2190 ",p(4,2,"common.back")," "),t(2),v(x.movement?5:x.loading?6:7))},dependencies:[C,D,M,h],encapsulation:2})};export{B as MovementsDetailComponent};
