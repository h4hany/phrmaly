import{a as J}from"./chunk-GR6BKOHX.js";import{a as q}from"./chunk-QDLVDHOW.js";import{a as G}from"./chunk-JYPY3KCN.js";import{c as V,e as F,g as z,o as D,p as N,q as O,w as W}from"./chunk-TK76J465.js";import{a as H}from"./chunk-6CFKC637.js";import{a as j}from"./chunk-EIOKHCL2.js";import{a as U}from"./chunk-5PFWNSG3.js";import{a as T,b as P}from"./chunk-3UJCRMW3.js";import{$a as r,Ab as o,Bb as s,Fa as A,Ka as w,Q as b,Qa as m,Va as R,W as k,X as h,Ya as L,Za as B,_a as a,_b as I,ab as M,cb as E,db as g,eb as v,mb as l,nb as p,ob as f,tb as x,ub as C,vb as y,wa as i}from"./chunk-E4S7NVXB.js";import{a as _,b as S}from"./chunk-C6Q5SG76.js";var Q=(u,e)=>e.type;function X(u,e){if(u&1&&(a(0,"div",29)(1,"div")(2,"p",33),l(3),o(4,"translate"),r(),a(5,"p",34),l(6),r()(),a(7,"app-badge",26),l(8),o(9,"translate"),r()()),u&2){let t=e.$implicit,n=v(2);i(3),p(s(4,4,n.getFactorLabel(t.type))),i(3),p(t.description),i(),m("variant",n.getSeverityVariant(t.severity)),i(),f(" ",s(9,6,n.getSeverityLabel(t.severity))," ")}}function Y(u,e){if(u&1){let t=E();a(0,"app-modal",21,0),o(2,"translate"),g("confirmed",function(){k(t);let c=v();return h(c.selectedAccount=null)}),a(3,"div",1)(4,"div",22)(5,"div",23)(6,"div")(7,"p",24),l(8),o(9,"translate"),r(),a(10,"p",25),l(11),r()(),a(12,"app-badge",26),l(13),o(14,"translate"),r()()(),a(15,"div")(16,"h3",27),l(17),o(18,"translate"),r(),a(19,"div",28),L(20,X,10,8,"div",29,Q),r()(),a(22,"div",30)(23,"app-button",31),g("onClick",function(){k(t);let c=v();return h(c.suspendAccount())}),l(24),o(25,"translate"),r(),a(26,"app-button",32),g("onClick",function(){k(t);let c=v();return h(c.restrictAccount())}),l(27),o(28,"translate"),r()()()()}if(u&2){let t=v();m("title",t.selectedAccount.name+" - Risk Assessment")("showFooter",!0)("confirmText",s(2,10,"common.close")),i(8),p(s(9,12,"platform.risk.riskScore")),i(3),p(t.riskScore),i(),m("variant",t.getRiskVariant(t.riskLevel)),i(),f(" ",s(14,14,t.getRiskLabel(t.riskLevel))," "),i(4),p(s(18,16,"platform.risk.riskFactors")),i(3),B(t.riskFactors),i(4),f(" ",s(25,18,"platform.risk.suspend")," "),i(3),f(" ",s(28,20,"platform.risk.restrict")," ")}}var K=class u{accountsService=b(J);translationService=b(T);loading=!1;riskAccounts=[];selectedAccount=null;filters={riskLevel:"",search:""};totalAccounts=0;highRiskAccounts=0;mediumRiskAccounts=0;suspendedAccounts=0;riskScore=75;riskLevel="high";riskFactors=[{type:"payment_overdue",severity:"high",description:"Payment overdue by 30+ days"},{type:"suspicious_activity",severity:"medium",description:"Unusual login patterns detected"}];pagination={page:1,pageSize:10,total:0,totalPages:0};columns=[{key:"name",label:"platform.risk.account",sortable:!0},{key:"riskScore",label:"platform.risk.riskScore",sortable:!0},{key:"riskLevel",label:"platform.risk.riskLevel",sortable:!0},{key:"status",label:"platform.risk.status",sortable:!0},{key:"lastAssessedAt",label:"platform.risk.lastAssessed",sortable:!0}];ngOnInit(){this.loadAccounts()}loadAccounts(){this.loading=!0,this.accountsService.getAll({page:this.pagination.page,pageSize:this.pagination.pageSize,search:this.filters.search||void 0}).subscribe({next:e=>{this.riskAccounts=e.data.map(t=>{let n=Math.floor(Math.random()*100),c=n>=80?"critical":n>=60?"high":n>=40?"medium":"low";return S(_({},t),{riskScore:n,riskLevel:this.translationService.translate(this.getRiskLabel(c)),status:t.status,lastAssessedAt:new Date().toLocaleDateString()})}),this.pagination={page:e.page,pageSize:e.pageSize,total:e.total,totalPages:e.totalPages},this.calculateStats(),this.loading=!1},error:()=>{this.loading=!1}})}calculateStats(){this.totalAccounts=this.riskAccounts.length,this.highRiskAccounts=this.riskAccounts.filter(e=>e.riskScore>=60).length,this.mediumRiskAccounts=this.riskAccounts.filter(e=>e.riskScore>=40&&e.riskScore<60).length,this.suspendedAccounts=this.riskAccounts.filter(e=>e.status==="suspended").length}applyFilters(){this.pagination.page=1,this.loadAccounts()}onPageChange(e){this.pagination.page=e,this.loadAccounts()}viewAccount(e){this.accountsService.getById(e.id).subscribe({next:t=>{this.selectedAccount=t}})}suspendAccount(){this.selectedAccount&&this.accountsService.suspend(this.selectedAccount.id).subscribe({next:()=>{this.loadAccounts(),this.selectedAccount=null}})}restrictAccount(){console.log("Restrict account:",this.selectedAccount)}getRiskLabel(e){return{critical:"platform.risk.levelCritical",high:"platform.risk.levelHigh",medium:"platform.risk.levelMedium",low:"platform.risk.levelLow"}[e]||e}getRiskVariant(e){return{critical:"danger",high:"danger",medium:"warning",low:"success"}[e]||"default"}getFactorLabel(e){return{payment_overdue:"platform.risk.factorPaymentOverdue",suspicious_activity:"platform.risk.factorSuspiciousActivity",compliance_violation:"platform.risk.factorComplianceViolation",high_usage:"platform.risk.factorHighUsage",low_engagement:"platform.risk.factorLowEngagement"}[e]||e}getSeverityLabel(e){return{critical:"platform.risk.severityCritical",high:"platform.risk.severityHigh",medium:"platform.risk.severityMedium",low:"platform.risk.severityLow"}[e]||e}getSeverityVariant(e){return{critical:"danger",high:"danger",medium:"warning",low:"info"}[e]||"default"}static \u0275fac=function(t){return new(t||u)};static \u0275cmp=A({type:u,selectors:[["app-risk-center"]],decls:49,vars:55,consts:[["riskModal",""],[1,"space-y-6"],[1,"text-2xl","font-bold","text-[var(--text-primary)]"],[1,"text-sm","text-[var(--card-text)]","mt-1"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[3,"label","value","icon"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-4"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"block","text-sm","font-medium","text-[var(--card-text)]","mb-1"],[1,"w-full","px-4","py-2","border","border-[var(--border-color)]","rounded-[var(--radius-md)]","text-sm","bg-[var(--card-bg)]","text-[var(--text-primary)]",3,"ngModelChange","ngModel"],["value",""],["value","critical"],["value","high"],["value","medium"],["value","low"],["type","text",1,"w-full","px-4","py-2","border","border-[var(--border-color)]","rounded-[var(--radius-md)]","text-sm","bg-[var(--card-bg)]","text-[var(--text-primary)]",3,"ngModelChange","ngModel","placeholder"],[1,"flex","items-end"],["variant","primary","size","sm",3,"onClick"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-6"],[3,"onPageChange","onRowClick","columns","data","pagination","loading","emptyMessage"],[3,"title","showFooter","confirmText"],[3,"confirmed","title","showFooter","confirmText"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-red-800"],[1,"text-3xl","font-bold","text-red-900"],[3,"variant"],[1,"text-lg","font-semibold","text-[var(--text-primary)]","mb-4"],[1,"space-y-2"],[1,"flex","items-center","justify-between","p-3","bg-[var(--page-bg)]","rounded-lg"],[1,"flex","gap-2"],["variant","danger","size","sm",3,"onClick"],["variant","outline","size","sm",3,"onClick"],[1,"font-medium","text-[var(--text-primary)]"],[1,"text-sm","text-[var(--card-text)]"]],template:function(t,n){t&1&&(a(0,"div",1)(1,"div")(2,"h1",2),l(3),o(4,"translate"),r(),a(5,"p",3),l(6),o(7,"translate"),r()(),a(8,"div",4),M(9,"app-stat-card",5)(10,"app-stat-card",5)(11,"app-stat-card",5)(12,"app-stat-card",5),r(),a(13,"div",6)(14,"div",7)(15,"div")(16,"label",8),l(17),o(18,"translate"),r(),a(19,"select",9),y("ngModelChange",function(d){return C(n.filters.riskLevel,d)||(n.filters.riskLevel=d),d}),a(20,"option",10),l(21),o(22,"translate"),r(),a(23,"option",11),l(24),o(25,"translate"),r(),a(26,"option",12),l(27),o(28,"translate"),r(),a(29,"option",13),l(30),o(31,"translate"),r(),a(32,"option",14),l(33),o(34,"translate"),r()()(),a(35,"div")(36,"label",8),l(37),o(38,"translate"),r(),a(39,"input",15),o(40,"translate"),y("ngModelChange",function(d){return C(n.filters.search,d)||(n.filters.search=d),d}),r()(),a(41,"div",16)(42,"app-button",17),g("onClick",function(){return n.applyFilters()}),l(43),o(44,"translate"),r()()()(),a(45,"div",18)(46,"app-table",19),o(47,"translate"),g("onPageChange",function(d){return n.onPageChange(d)})("onRowClick",function(d){return n.viewAccount(d)}),r()()(),w(48,Y,29,22,"app-modal",20)),t&2&&(i(3),p(s(4,31,"platform.risk.title")),i(3),p(s(7,33,"platform.risk.subtitle")),i(3),m("label","platform.risk.totalAccounts")("value",n.totalAccounts)("icon","users"),i(),m("label","platform.risk.highRisk")("value",n.highRiskAccounts)("icon","alert"),i(),m("label","platform.risk.mediumRisk")("value",n.mediumRiskAccounts)("icon","clock"),i(),m("label","platform.risk.suspended")("value",n.suspendedAccounts)("icon","x-circle"),i(5),p(s(18,35,"platform.risk.riskLevel")),i(2),x("ngModel",n.filters.riskLevel),i(2),p(s(22,37,"common.all")),i(3),p(s(25,39,"platform.risk.levelCritical")),i(3),p(s(28,41,"platform.risk.levelHigh")),i(3),p(s(31,43,"platform.risk.levelMedium")),i(3),p(s(34,45,"platform.risk.levelLow")),i(4),p(s(38,47,"common.search")),i(2),x("ngModel",n.filters.search),m("placeholder",s(40,49,"platform.risk.searchPlaceholder")),i(4),f(" ",s(44,51,"common.search")," "),i(3),m("columns",n.columns)("data",n.riskAccounts)("pagination",n.pagination)("loading",n.loading)("emptyMessage",s(47,53,"platform.risk.noAccounts")),i(2),R(n.selectedAccount?48:-1))},dependencies:[I,W,N,O,V,D,F,z,q,H,P,G,j,U],encapsulation:2})};export{K as RiskCenterComponent};
