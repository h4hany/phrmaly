import{a as D}from"./chunk-3QVO6BSK.js";import{a as ee}from"./chunk-7B74Y6UG.js";import{a as te}from"./chunk-LCE5WCDK.js";import{a as K}from"./chunk-BOTQ5HVH.js";import{a as Z}from"./chunk-WWNH5MHG.js";import"./chunk-T542ZMY7.js";import{a as Y}from"./chunk-URFUYTQU.js";import"./chunk-BYXBJQAS.js";import{a as B,b as G}from"./chunk-3UJCRMW3.js";import{c as X,d as E,e as Q,f as W}from"./chunk-C3O3TVFX.js";import{$a as o,Ab as s,Bb as p,Fa as y,Ka as h,Lb as J,Pa as g,Q as u,Qa as d,Ra as M,Sa as U,Ua as z,Va as b,W as w,X as T,Y as f,Ya as S,Z as N,Za as k,_a as n,_b as x,ab as l,cb as I,db as _,eb as m,ja as q,mb as c,nb as v,ob as V,wa as a,yb as A}from"./chunk-E4S7NVXB.js";import{a as j,b as H}from"./chunk-C6Q5SG76.js";var ie=[{key:"overview",label:"nav.overview",icon:"layout-grid",items:[{path:"/dashboard",label:"nav.dashboard",icon:"layout-grid",exact:!0}],collapsedByDefault:!1,order:1},{key:"operations",label:"nav.operations",icon:"briefcase",items:[{path:"/invoices",label:"nav.sales",icon:"receipt"},{path:"/patients",label:"nav.customers",icon:"user-heart"},{path:"/vouchers",label:"nav.vouchers",icon:"ticket"}],collapsedByDefault:!0,order:2},{key:"people",label:"nav.people",icon:"users",items:[{path:"/pharmacy-staff",label:"nav.staffProfiles",icon:"id-badge"},{path:"/people/attendance",label:"nav.attendance",icon:"clock"},{path:"/people/payroll",label:"nav.payroll",icon:"credit-card"},{path:"/people/performance",label:"nav.performance",icon:"chart"},{path:"/people/training",label:"nav.training",icon:"graduation-cap"}],collapsedByDefault:!0,order:3},{key:"inventory",label:"nav.inventory",icon:"package",items:[{path:"/drugs",label:"nav.products",icon:"pill-bottle"},{path:"/bundles",label:"nav.bundles",icon:"package"},{path:"/inventory/alerts",label:"nav.inventoryAlerts",icon:"bell-warning"},{path:"/inventory/requested-products",label:"nav.requestedProducts",icon:"file-question"},{path:"/inventory/transfers",label:"nav.transfers",icon:"arrows-left-right"},{path:"/inventory/map",label:"nav.pharmacyMap",icon:"map-grid"}],collapsedByDefault:!0,order:4},{key:"procurement",label:"nav.procurement",icon:"factory",items:[{path:"/suppliers",label:"nav.suppliers",icon:"factory"},{path:"/purchases",label:"nav.orders",icon:"clipboard-list"}],collapsedByDefault:!0,order:5},{key:"finance",label:"nav.finance",icon:"credit-card",items:[{path:"/payments",label:"nav.payments",icon:"credit-card"},{path:"/audit-logs",label:"nav.auditLogs",icon:"shield-check"},{path:"/inventory/movements",label:"nav.drugMovements",icon:"activity-pulse"}],collapsedByDefault:!0,order:6},{key:"growth",label:"nav.growth",icon:"trending-up",items:[{path:"/growth/referrals",label:"nav.referrals",icon:"handshake"}],collapsedByDefault:!0,order:7},{key:"system-console",label:"nav.systemConsole",icon:"shield-check",items:[{path:"/system/dashboard",label:"nav.platformDashboard",icon:"layout-grid"},{path:"/system/accounts",label:"nav.accounts",icon:"users"},{path:"/system/subscriptions",label:"nav.subscriptions",icon:"credit-card"},{path:"/system/catalog",label:"nav.globalDrugs",icon:"pill-bottle"},{path:"/system/support",label:"nav.supportTickets",icon:"help-circle"},{path:"/system/feature-flags",label:"nav.platformFeatures",icon:"toggle-sliders"},{path:"/system/risk",label:"nav.accountRisk",icon:"shield-check"},{path:"/system/admins",label:"nav.adminUsers",icon:"id-badge"},{path:"/system/analytics",label:"nav.platformAnalytics",icon:"chart"}],collapsedByDefault:!0,order:7,roles:["super_admin","support_admin","sales_admin","finance_admin"]},{key:"system",label:"nav.system",icon:"settings",items:[{path:"/system/automation",label:"nav.automation",icon:"magic-wand"},{path:"/system/migration",label:"nav.dataImport",icon:"database-arrow-down"},{path:"/system/permissions",label:"nav.accessControl",icon:"lock-key"},{path:"/system/features",label:"nav.featureFlags",icon:"toggle-sliders"},{path:"/payments/methods",label:"nav.paymentMethods",icon:"credit-card"},{path:"/settings",label:"nav.settings",icon:"gear"}],collapsedByDefault:!0,order:8},{key:"support",label:"nav.support",icon:"help-circle",items:[{path:"/reports",label:"nav.helpSupport",icon:"help-circle"}],collapsedByDefault:!1,order:9}];var ne=i=>({exact:i}),oe=(i,t)=>t.key,re=(i,t)=>t.path;function le(i,t){if(i&1&&(n(0,"li")(1,"a",21),s(2,"translate"),l(3,"app-icon",22),n(4,"span"),c(5),s(6,"translate"),o()()()),i&2){let e,r=m(2).$implicit;a(),d("routerLink",r.items[0].path)("routerLinkActive","nav-item-active")("routerLinkActiveOptions",A(11,ne,(e=r.items[0].exact)!==null&&e!==void 0?e:!1)),g("aria-label",p(2,7,r.items[0].label)),a(2),d("name",r.items[0].icon)("color","currentColor"),a(2),v(p(6,9,r.items[0].label))}}function se(i,t){if(i&1&&(n(0,"li")(1,"a",21),s(2,"translate"),l(3,"app-icon",22),n(4,"span"),c(5),s(6,"translate"),o()()()),i&2){let e,r=t.$implicit;a(),d("routerLink",r.path)("routerLinkActive","nav-item-active")("routerLinkActiveOptions",A(11,ne,(e=r.exact)!==null&&e!==void 0?e:!1)),g("aria-label",p(2,7,r.label)),a(2),d("name",r.icon)("color","currentColor"),a(2),v(p(6,9,r.label))}}function pe(i,t){if(i&1&&(n(0,"ul",25),S(1,se,7,13,"li",null,re),o()),i&2){let e=m(3).$implicit,r=m();a(),k(r.getVisibleItems(e))}}function ce(i,t){if(i&1){let e=I();n(0,"li")(1,"button",23),s(2,"translate"),_("click",function(){w(e);let C=m(2).$implicit,F=m();return T(F.toggleGroup(C.key))}),n(3,"div",2),l(4,"app-icon",22),n(5,"span"),c(6),s(7,"translate"),o()(),l(8,"app-icon",24),o(),h(9,pe,3,0,"ul",25),o()}if(i&2){let e=m(2).$implicit,r=m();a(),g("aria-expanded",!r.isGroupCollapsed(e.key))("aria-label",p(2,9,e.label)),a(3),d("name",e.icon)("color","currentColor"),a(2),v(p(7,11,e.label)),a(2),U("rotate-180",!r.isGroupCollapsed(e.key)),d("color","currentColor"),a(),b(r.isGroupCollapsed(e.key)?-1:9)}}function de(i,t){if(i&1&&h(0,le,7,13,"li")(1,ce,10,13,"li"),i&2){let e=m().$implicit;b(e.items.length===1?0:1)}}function me(i,t){if(i&1&&h(0,de,2,1),i&2){let e=t.$implicit,r=m();b(r.shouldShowGroup(e)?0:-1)}}var L=class i{router=u(E);authService=u(Y);platformContext=u(K);translationService=u(B);rbacService=u(Z);groups=ie;collapsedGroups=q({});visibleGroups=J(()=>{let t=this.platformContext.isPlatformMode();return this.groups.filter(e=>this.isGroupVisible(e,t))});ngOnInit(){let t={};this.groups.forEach(e=>{t[e.key]=e.collapsedByDefault??!0}),this.collapsedGroups.set(t)}toggleGroup(t){this.collapsedGroups.update(e=>H(j({},e),{[t]:!e[t]}))}isGroupCollapsed(t){return this.collapsedGroups()[t]??!1}isGroupVisible(t,e){return e?t.key==="system-console":t.key==="system-console"?!1:this.rbacService.canAccessGroup(t.key)}isItemVisible(t){return this.rbacService.canAccessItem(t.path)}getVisibleItems(t){return t.items.filter(e=>this.isItemVisible(e))}shouldShowGroup(t){return this.getVisibleItems(t).length>0}logout(){this.authService.logout(),this.router.navigate(["/login"])}get isRTL(){return this.translationService.getCurrentLanguage()==="ar"}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=y({type:i,selectors:[["app-sidebar"]],decls:39,vars:29,consts:[[1,"w-64","h-full","rounded-[var(--radius-lg)]","flex","flex-col","relative","overflow-hidden","overflow-x-hidden",2,"background-color","var(--sidebar-bg)"],[1,"p-6","border-b","relative","z-10",2,"border-color","rgba(227, 244, 245, 0.1)"],[1,"flex","items-center","gap-3"],[1,"w-10","h-10","rounded-lg","flex","items-center","justify-center",2,"background-color","var(--primary-bg)"],[1,"text-xl","font-bold",2,"color","var(--primary-text)"],[1,"text-xl","font-bold",2,"color","var(--sidebar-text)"],[1,"flex-1","overflow-y-auto","overflow-x-hidden","p-4","relative","z-10"],[1,"absolute","inset-0","pointer-events-none",2,"opacity","0.15"],[1,"absolute"],["src","icons/medicine.svg","alt","",1,"w-24","h-24",2,"filter","brightness(0) invert(1)","opacity","0.4"],[1,"absolute",2,"transform","translateX(-50%)"],[1,"space-y-2","relative","z-10"],[1,"p-4","border-t","relative","z-10",2,"border-color","rgba(227, 244, 245, 0.1)"],[1,"rounded-[var(--radius-md)]","p-4",2,"background-color","rgba(227, 244, 245, 0.1)"],[1,"flex","items-center","gap-2","mb-2"],["name","lock","size","20",3,"color"],[1,"font-semibold","text-sm",2,"color","var(--sidebar-text)"],[1,"text-xs","mb-3",2,"color","var(--sidebar-text)","opacity","0.8"],[1,"w-full","rounded-[var(--radius-md)]","px-4","py-2","text-sm","font-medium","transition-opacity","hover:opacity-90",2,"background-color","var(--primary-bg)","color","var(--primary-text)"],[1,"w-full","flex","items-center","gap-3","px-4","py-3","rounded-[var(--radius-md)]","transition-colors","hover:opacity-80",2,"color","var(--sidebar-text)",3,"click"],["name","logout","size","20",3,"color"],["tabindex","0",1,"flex","items-center","gap-3","px-4","py-3","rounded-[var(--radius-md)]","transition-colors",2,"color","var(--sidebar-text)",3,"routerLink","routerLinkActive","routerLinkActiveOptions"],["size","20",3,"name","color"],["type","button",1,"w-full","flex","items-center","justify-between","gap-3","px-4","py-3","rounded-[var(--radius-md)]","transition-colors","hover:opacity-80",2,"color","var(--sidebar-text)",3,"click"],["name","chevron-down","size","16",1,"transition-transform","duration-200",3,"color"],[1,"mt-2","ml-4","space-y-1","group-transition"]],template:function(e,r){e&1&&(n(0,"aside",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),c(5,"P"),o()(),n(6,"span",5),c(7,"Pharmly"),o()()(),n(8,"nav",6)(9,"div",7)(10,"div",8),l(11,"img",9),o(),n(12,"div",8),l(13,"img",9),o(),n(14,"div",10),l(15,"img",9),o()(),n(16,"ul",11),S(17,me,1,1,null,null,oe),o()(),n(19,"div",12)(20,"div",13)(21,"div",14),l(22,"app-icon",15),n(23,"span",16),c(24),s(25,"translate"),o()(),n(26,"p",17),c(27),s(28,"translate"),o(),n(29,"button",18),c(30),s(31,"translate"),o()()(),n(32,"div",12)(33,"button",19),s(34,"translate"),_("click",function(){return r.logout()}),l(35,"app-icon",20),n(36,"span"),c(37),s(38,"translate"),o()()()()),e&2&&(a(10),M("top",15,"%")("left",-5,"%"),a(2),M("top",50,"%")("right",-5,"%"),a(2),M("bottom",15,"%")("left",50,"%"),a(3),k(r.visibleGroups()),a(5),d("color","var(--sidebar-text)"),a(2),v(p(25,19,"upgrade.title")),a(3),V(" ",p(28,21,"upgrade.description")," "),a(3),V(" ",p(31,23,"upgrade.button")," "),a(3),g("aria-label",p(34,25,"nav.logout")),a(2),d("color","currentColor"),a(2),v(p(38,27,"nav.logout")))},dependencies:[x,Q,W,G,D],styles:[".nav-item-active[_ngcontent-%COMP%]{background-color:var(--sidebar-active-bg)!important;color:var(--sidebar-active-text)!important}.nav-item-active[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{color:var(--sidebar-active-text)!important}.group-transition[_ngcontent-%COMP%]{transition:all .3s ease-in-out}"]})};function ue(i,t){if(i&1&&(n(0,"p",3),c(1),s(2,"translate"),o()),i&2){let e=m();a(),v(p(2,1,e.subtitle))}}var P=class i{themeService=u(ee);translationService=u(B);title="nav.dashboard";subtitle;toggleLanguage(){this.themeService.toggleLanguage()}get currentLanguage(){return this.themeService.getCurrentLanguage()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=y({type:i,selectors:[["app-header"]],inputs:{title:"title",subtitle:"subtitle"},decls:32,vars:20,consts:[[1,"bg-white","rounded-[var(--radius-lg)]","px-6","py-4"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-600","mt-1"],[1,"flex","items-center","gap-4"],[1,"relative"],["type","button",1,"flex","items-center","gap-2","px-3","py-2","border","border-gray-300","rounded-[var(--radius-md)]","text-sm","font-medium","text-gray-700","hover:bg-gray-50","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"],["type","text",1,"pl-10","pr-4","py-2","border","border-gray-300","rounded-[var(--radius-md)]","text-sm","focus:outline-none","focus:ring-2","focus:ring-[var(--primary-bg)]/20","focus:border-[var(--primary-bg)]",2,"background-color","white",3,"placeholder"],["name","search","size","20",1,"absolute","left-3","top-2.5","text-gray-400",3,"color"],[1,"relative","p-2","text-gray-600","hover:text-gray-900"],["name","bell","size","24",3,"color"],["aria-hidden","true",1,"absolute","top-1","right-1","w-2","h-2","bg-red-500","rounded-full"],[1,"flex","items-center","gap-3"],["aria-hidden","true",1,"w-10","h-10","bg-gray-300","rounded-full"],[1,"text-left"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],["name","chevron-down","size","16",3,"color"]],template:function(e,r){e&1&&(n(0,"header",0)(1,"div",1)(2,"div")(3,"h1",2),c(4),s(5,"translate"),o(),h(6,ue,3,3,"p",3),o(),n(7,"div",4)(8,"div",5)(9,"button",6),s(10,"translate"),_("click",function(){return r.toggleLanguage()}),f(),n(11,"svg",7),l(12,"path",8),o(),N(),n(13,"span"),c(14),o()()(),n(15,"div",5),l(16,"input",9),s(17,"translate"),s(18,"translate"),l(19,"app-icon",10),o(),n(20,"button",11),s(21,"translate"),l(22,"app-icon",12)(23,"span",13),o(),n(24,"div",14),l(25,"div",15),n(26,"div",16)(27,"div",17),c(28,"James Bond"),o(),n(29,"div",18),c(30,"@james.bond"),o()(),l(31,"app-icon",19),o()()()()),e&2&&(a(4),v(p(5,10,r.title)),a(2),b(r.subtitle?6:-1),a(3),g("aria-label",p(10,12,"header.language")),a(5),v(r.currentLanguage==="en"?"EN":"AR"),a(2),d("placeholder",p(17,14,"header.search")),g("aria-label",p(18,16,"header.search")),a(3),d("color","currentColor"),a(),g("aria-label",p(21,18,"header.notifications")),a(2),d("color","currentColor"),a(9),d("color","#9CA3AF"))},dependencies:[x,G,D],encapsulation:2})};var ve=(i,t)=>t.id;function be(i,t){i&1&&(f(),n(0,"svg",3),l(1,"path",9),o())}function ge(i,t){i&1&&(f(),n(0,"svg",3),l(1,"path",10),o())}function fe(i,t){i&1&&(f(),n(0,"svg",3),l(1,"path",11),o())}function ye(i,t){i&1&&(f(),n(0,"svg",3),l(1,"path",12),o())}function he(i,t){if(i&1){let e=I();n(0,"div",2)(1,"div"),h(2,be,2,0,":svg:svg",3)(3,ge,2,0,":svg:svg",3)(4,fe,2,0,":svg:svg",3)(5,ye,2,0,":svg:svg",3),o(),n(6,"div",4)(7,"p",5),c(8),o()(),n(9,"button",6),_("click",function(){let C=w(e).$implicit,F=m();return T(F.removeToast(C.id))}),f(),n(10,"svg",7),l(11,"path",8),o()()()}if(i&2){let e=t.$implicit,r=m();z(r.getToastClasses(e.type)),a(),z(r.getIconClasses(e.type)),a(),b(e.type==="success"?2:-1),a(),b(e.type==="error"?3:-1),a(),b(e.type==="warning"?4:-1),a(),b(e.type==="info"?5:-1),a(3),v(e.message)}}var O=class i{toastService=u(te);subscription;messages=[];ngOnInit(){this.subscription=this.toastService.getMessages().subscribe(t=>{this.messages=t})}ngOnDestroy(){this.subscription?.unsubscribe()}removeToast(t){this.toastService.remove(t)}getToastClasses(t){return`bg-white border ${{success:"border-green-200 bg-green-50 text-green-800",error:"border-red-200 bg-red-50 text-red-800",warning:"border-yellow-200 bg-yellow-50 text-yellow-800",info:"border-blue-200 bg-blue-50 text-blue-800"}[t]}`}getIconClasses(t){return`flex-shrink-0 ${{success:"text-green-400",error:"text-red-400",warning:"text-yellow-400",info:"text-blue-400"}[t]}`}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=y({type:i,selectors:[["app-toast"]],decls:3,vars:0,consts:[[1,"fixed","top-4","right-4","z-[9999]","space-y-2"],[1,"min-w-[300px]","max-w-md","rounded-lg","shadow-lg","p-4","flex","items-start","gap-3","animate-slide-in",3,"class"],[1,"min-w-[300px]","max-w-md","rounded-lg","shadow-lg","p-4","flex","items-start","gap-3","animate-slide-in"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5"],[1,"flex-1"],[1,"text-sm","font-medium"],["type","button",1,"text-gray-400","hover:text-gray-600","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule","evenodd"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule","evenodd"],["fill-rule","evenodd","d","M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule","evenodd"],["fill-rule","evenodd","d","M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule","evenodd"]],template:function(e,r){e&1&&(n(0,"div",0),S(1,he,12,9,"div",1,ve),o()),e&2&&(a(),k(r.messages))},dependencies:[x],styles:["@keyframes _ngcontent-%COMP%_slide-in{0%{opacity:0;transform:translate(100%)}to{opacity:1;transform:translate(0)}}.animate-slide-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slide-in .3s ease-out}"]})};var ae=class i{router=u(E);currentTitle="nav.dashboard";subtitle;ngOnInit(){this.updateTitle(),this.router.events.subscribe(()=>{this.updateTitle()})}updateTitle(){let t=this.router.url.split("/")[1]||"dashboard",e={dashboard:"nav.dashboard",patients:"patient.list",drugs:"drug.list",purchases:"nav.orders",invoices:"nav.sales",payments:"nav.payments",suppliers:"nav.suppliers",reports:"nav.helpSupport",settings:"nav.settings",inventory:"inventory.alerts",bundles:"nav.bundles","pharmacy-staff":"nav.pharmacyStaff","audit-logs":"audit.title","inventory-movements":"movements.title","inventory-transfers":"transfers.title","inventory-map":"map.title","growth-referrals":"referrals.title","system-migration":"migration.title","system-automation":"automation.title","system-permissions":"permissions.title","system-features":"featureFlags.title"};this.currentTitle=e[t]||"nav.dashboard",this.subtitle=t==="dashboard"?"dashboard.subtitle":void 0}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=y({type:i,selectors:[["app-main-layout"]],decls:9,vars:2,consts:[[1,"flex","h-screen",2,"background-color","var(--page-bg)"],[1,"py-4","pl-4","flex-shrink-0"],[1,"flex-1","flex","flex-col","overflow-hidden"],[1,"pt-4",2,"padding-left","var(--spacing-page)","padding-right","var(--spacing-page)"],[3,"title","subtitle"],[1,"flex-1","overflow-y-auto",2,"padding","var(--spacing-page)","background-color","var(--page-bg)"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"div",1),l(2,"app-sidebar"),o(),n(3,"div",2)(4,"div",3),l(5,"app-header",4),o(),n(6,"main",5),l(7,"router-outlet"),o()(),l(8,"app-toast"),o()),e&2&&(a(5),d("title",r.currentTitle)("subtitle",r.subtitle))},dependencies:[x,X,L,P,O],encapsulation:2})};export{ae as MainLayoutComponent};
