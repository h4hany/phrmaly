import{a as $}from"./chunk-QDLVDHOW.js";import{a as ee}from"./chunk-JYPY3KCN.js";import{e as H,g as G,o as q,p as J,q as K,w as Q}from"./chunk-TK76J465.js";import{a as X}from"./chunk-6CFKC637.js";import{a as Y}from"./chunk-EIOKHCL2.js";import{a as Z}from"./chunk-5PFWNSG3.js";import{a as j,b as W}from"./chunk-3UJCRMW3.js";import{$a as n,Ab as s,Bb as o,Cb as N,Fa as T,K as E,Ka as D,Q as _,Qa as u,Va as R,W as k,X as P,Xb as V,Y as M,Ya as U,Z as L,Za as O,_a as a,_b as z,ab as y,cb as F,db as v,eb as C,i as g,mb as l,nb as d,ob as A,tb as w,ub as I,vb as B,wa as i,y as f}from"./chunk-E4S7NVXB.js";import{a as b,b as x}from"./chunk-C6Q5SG76.js";var S=class c{admins=[{id:"ADM001",email:"support@pharmly.com",username:"support_admin",fullName:"Support Admin",role:"support_admin",status:"active",permissions:[{resource:"tickets",actions:["read","write","manage"]},{resource:"accounts",actions:["read"]}],lastLoginAt:new Date("2024-11-27"),createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-11-27"),createdBy:"admin001"},{id:"ADM002",email:"sales@pharmly.com",username:"sales_admin",fullName:"Sales Admin",role:"sales_admin",status:"active",permissions:[{resource:"accounts",actions:["read","write"]},{resource:"subscriptions",actions:["read","write","manage"]}],lastLoginAt:new Date("2024-11-26"),createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-11-26"),createdBy:"admin001"}];getAll(t){let e=[...this.admins];t?.role&&(e=e.filter(h=>h.role===t.role)),t?.status&&(e=e.filter(h=>h.status===t.status));let r=t?.page||1,p=t?.pageSize||10,m=(r-1)*p,ie=m+p,ae=e.slice(m,ie);return g({data:ae,total:e.length,page:r,pageSize:p,totalPages:Math.ceil(e.length/p)}).pipe(f(500))}getById(t){let e=this.admins.find(r=>r.id===t);return g(e||null).pipe(f(300))}create(t){let e=x(b({},t),{id:`ADM${String(this.admins.length+1).padStart(3,"0")}`,createdAt:new Date,updatedAt:new Date});return this.admins.push(e),g(e).pipe(f(500))}update(t,e){let r=this.admins.find(p=>p.id===t);if(!r)throw new Error("Admin not found");return Object.assign(r,e,{updatedAt:new Date}),g(r).pipe(f(500))}static \u0275fac=function(e){return new(e||c)};static \u0275prov=E({token:c,factory:c.\u0275fac,providedIn:"root"})};var re=(c,t)=>t.resource;function le(c,t){if(c&1&&(a(0,"div",33)(1,"p",34),l(2),n(),a(3,"p",35),l(4),n()()),c&2){let e=t.$implicit;i(2),d(e.resource),i(2),d(e.actions.join(", "))}}function se(c,t){if(c&1){let e=F();a(0,"app-modal",27,0),s(2,"translate"),v("confirmed",function(){k(e);let p=C();return P(p.selectedAdmin=null)}),a(3,"div",1)(4,"div",28)(5,"div")(6,"label",12),l(7),s(8,"translate"),n(),a(9,"p",29),l(10),n()(),a(11,"div")(12,"label",12),l(13),s(14,"translate"),n(),a(15,"app-badge",30),l(16),s(17,"translate"),n()(),a(18,"div")(19,"label",12),l(20),s(21,"translate"),n(),a(22,"app-badge",30),l(23),s(24,"translate"),n()(),a(25,"div")(26,"label",12),l(27),s(28,"translate"),n(),a(29,"p",29),l(30),s(31,"date"),n()()(),a(32,"div")(33,"h3",31),l(34),s(35,"translate"),n(),a(36,"div",32),U(37,le,5,2,"div",33,re),n()()()()}if(c&2){let e=C();u("title",e.selectedAdmin.fullName)("showFooter",!0)("confirmText",o(2,14,"common.close")),i(7),d(o(8,16,"platform.admins.email")),i(3),d(e.selectedAdmin.email),i(3),d(o(14,18,"platform.admins.role")),i(2),u("variant",e.getRoleVariant(e.selectedAdmin.role)),i(),A(" ",o(17,20,e.getRoleLabel(e.selectedAdmin.role))," "),i(4),d(o(21,22,"platform.admins.status")),i(2),u("variant",e.getStatusVariant(e.selectedAdmin.status)),i(),A(" ",o(24,24,e.getStatusLabel(e.selectedAdmin.status))," "),i(4),d(o(28,26,"platform.admins.lastLogin")),i(3),d(e.selectedAdmin.lastLoginAt?N(31,28,e.selectedAdmin.lastLoginAt,"short"):"-"),i(4),d(o(35,31,"platform.admins.permissions")),i(3),O(e.selectedAdmin.permissions)}}var te=class c{adminsService=_(S);translationService=_(j);loading=!1;admins=[];selectedAdmin=null;filters={role:"",status:""};totalAdmins=0;activeAdmins=0;supportAdmins=0;salesAdmins=0;pagination={page:1,pageSize:10,total:0,totalPages:0};columns=[{key:"fullName",label:"platform.admins.name",sortable:!0},{key:"email",label:"platform.admins.email",sortable:!0},{key:"role",label:"platform.admins.role",sortable:!0},{key:"status",label:"platform.admins.status",sortable:!0},{key:"lastLoginAt",label:"platform.admins.lastLogin",sortable:!0}];showCreateModal=!1;ngOnInit(){this.loadAdmins()}loadAdmins(){this.loading=!0,this.adminsService.getAll({page:this.pagination.page,pageSize:this.pagination.pageSize,role:this.filters.role||void 0,status:this.filters.status||void 0}).subscribe({next:t=>{this.admins=t.data.map(e=>x(b({},e),{role:this.translationService.translate(this.getRoleLabel(e.role)),status:this.translationService.translate(this.getStatusLabel(e.status)),lastLoginAt:e.lastLoginAt?new Date(e.lastLoginAt).toLocaleDateString():"-"})),this.pagination={page:t.page,pageSize:t.pageSize,total:t.total,totalPages:t.totalPages},this.calculateStats(t.data),this.loading=!1},error:()=>{this.loading=!1}})}calculateStats(t){this.totalAdmins=t.length,this.activeAdmins=t.filter(e=>e.status==="active").length,this.supportAdmins=t.filter(e=>e.role==="support_admin").length,this.salesAdmins=t.filter(e=>e.role==="sales_admin").length}applyFilters(){this.pagination.page=1,this.loadAdmins()}onPageChange(t){this.pagination.page=t,this.loadAdmins()}viewAdmin(t){this.adminsService.getById(t.id).subscribe({next:e=>{this.selectedAdmin=e}})}getRoleLabel(t){return{super_admin:"platform.admins.roleSuperAdmin",support_admin:"platform.admins.roleSupport",sales_admin:"platform.admins.roleSales",finance_admin:"platform.admins.roleFinance"}[t]||t}getRoleVariant(t){return{super_admin:"danger",support_admin:"info",sales_admin:"success",finance_admin:"warning"}[t]||"default"}getStatusLabel(t){return{active:"platform.admins.statusActive",inactive:"platform.admins.statusInactive",suspended:"platform.admins.statusSuspended"}[t]||t}getStatusVariant(t){return{active:"success",inactive:"default",suspended:"danger"}[t]||"default"}static \u0275fac=function(e){return new(e||c)};static \u0275cmp=T({type:c,selectors:[["app-admins"]],decls:66,vars:67,consts:[["adminModal",""],[1,"space-y-6"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-[var(--text-primary)]"],[1,"text-sm","text-[var(--card-text)]","mt-1"],["variant","primary",3,"onClick"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","inline","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[3,"label","value","icon"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-4"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"block","text-sm","font-medium","text-[var(--card-text)]","mb-1"],[1,"w-full","px-4","py-2","border","border-[var(--border-color)]","rounded-[var(--radius-md)]","text-sm","bg-[var(--card-bg)]","text-[var(--text-primary)]",3,"ngModelChange","ngModel"],["value",""],["value","super_admin"],["value","support_admin"],["value","sales_admin"],["value","finance_admin"],["value","active"],["value","inactive"],["value","suspended"],[1,"flex","items-end"],["variant","primary","size","sm",3,"onClick"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-6"],[3,"onPageChange","onRowClick","columns","data","pagination","loading","emptyMessage"],[3,"title","showFooter","confirmText"],[3,"confirmed","title","showFooter","confirmText"],[1,"grid","grid-cols-2","gap-4"],[1,"text-[var(--text-primary)]"],[3,"variant"],[1,"text-lg","font-semibold","text-[var(--text-primary)]","mb-4"],[1,"space-y-2"],[1,"p-3","bg-[var(--page-bg)]","rounded-lg"],[1,"font-medium","text-[var(--text-primary)]"],[1,"text-sm","text-[var(--card-text)]"]],template:function(e,r){e&1&&(a(0,"div",1)(1,"div",2)(2,"div")(3,"h1",3),l(4),s(5,"translate"),n(),a(6,"p",4),l(7),s(8,"translate"),n()(),a(9,"app-button",5),v("onClick",function(){return r.showCreateModal=!0}),M(),a(10,"svg",6),y(11,"path",7),n(),l(12),s(13,"translate"),n()(),L(),a(14,"div",8),y(15,"app-stat-card",9)(16,"app-stat-card",9)(17,"app-stat-card",9)(18,"app-stat-card",9),n(),a(19,"div",10)(20,"div",11)(21,"div")(22,"label",12),l(23),s(24,"translate"),n(),a(25,"select",13),B("ngModelChange",function(m){return I(r.filters.role,m)||(r.filters.role=m),m}),a(26,"option",14),l(27),s(28,"translate"),n(),a(29,"option",15),l(30),s(31,"translate"),n(),a(32,"option",16),l(33),s(34,"translate"),n(),a(35,"option",17),l(36),s(37,"translate"),n(),a(38,"option",18),l(39),s(40,"translate"),n()()(),a(41,"div")(42,"label",12),l(43),s(44,"translate"),n(),a(45,"select",13),B("ngModelChange",function(m){return I(r.filters.status,m)||(r.filters.status=m),m}),a(46,"option",14),l(47),s(48,"translate"),n(),a(49,"option",19),l(50),s(51,"translate"),n(),a(52,"option",20),l(53),s(54,"translate"),n(),a(55,"option",21),l(56),s(57,"translate"),n()()(),a(58,"div",22)(59,"app-button",23),v("onClick",function(){return r.applyFilters()}),l(60),s(61,"translate"),n()()()(),a(62,"div",24)(63,"app-table",25),s(64,"translate"),v("onPageChange",function(m){return r.onPageChange(m)})("onRowClick",function(m){return r.viewAdmin(m)}),n()()(),D(65,se,39,33,"app-modal",26)),e&2&&(i(4),d(o(5,35,"platform.admins.title")),i(3),d(o(8,37,"platform.admins.subtitle")),i(5),A(" ",o(13,39,"platform.admins.create")," "),i(3),u("label","platform.admins.totalAdmins")("value",r.totalAdmins)("icon","users"),i(),u("label","platform.admins.activeAdmins")("value",r.activeAdmins)("icon","check-circle"),i(),u("label","platform.admins.supportAdmins")("value",r.supportAdmins)("icon","help-circle"),i(),u("label","platform.admins.salesAdmins")("value",r.salesAdmins)("icon","chart"),i(5),d(o(24,41,"platform.admins.role")),i(2),w("ngModel",r.filters.role),i(2),d(o(28,43,"common.all")),i(3),d(o(31,45,"platform.admins.roleSuperAdmin")),i(3),d(o(34,47,"platform.admins.roleSupport")),i(3),d(o(37,49,"platform.admins.roleSales")),i(3),d(o(40,51,"platform.admins.roleFinance")),i(4),d(o(44,53,"platform.admins.status")),i(2),w("ngModel",r.filters.status),i(2),d(o(48,55,"common.all")),i(3),d(o(51,57,"platform.admins.statusActive")),i(3),d(o(54,59,"platform.admins.statusInactive")),i(3),d(o(57,61,"platform.admins.statusSuspended")),i(4),A(" ",o(61,63,"common.search")," "),i(3),u("columns",r.columns)("data",r.admins)("pagination",r.pagination)("loading",r.loading)("emptyMessage",o(64,65,"platform.admins.noAdmins")),i(2),R(r.selectedAdmin?65:-1))},dependencies:[z,V,Q,J,K,q,H,G,$,X,W,ee,Y,Z],encapsulation:2})};export{te as AdminsComponent};
