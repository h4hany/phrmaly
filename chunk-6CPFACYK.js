import{a as G}from"./chunk-PHYGXT4G.js";import{a as D}from"./chunk-IONILDPT.js";import{a as P}from"./chunk-JBZ5JDSH.js";import"./chunk-ONVEZIWC.js";import{a as F}from"./chunk-K7KLI742.js";import{a as H}from"./chunk-H653ED7N.js";import{b as j}from"./chunk-7YN2F2UA.js";import{d as Q}from"./chunk-J2A4D5WT.js";import{Cb as E,Da as S,Ia as C,Oa as p,Q as y,Ta as L,W as u,Wb as N,X as c,Y as g,Ya as n,Z as b,Za as o,_a as f,ab as w,bb as v,cb as _,gb as T,hb as V,ib as I,kb as h,lb as B,mb as x,va as l,yb as a,zb as s}from"./chunk-ILVQMZIM.js";import{a as k,b as M}from"./chunk-7CGTOI24.js";var R=["deleteModal"];function q(d,t){if(d&1&&f(0,"app-alert",3),d&2){let e=_();p("title",e.errorMessage)}}function z(d,t){if(d&1){let e=w();n(0,"div",17)(1,"button",18),a(2,"translate"),v("click",function(){let r=u(e).$implicit,m=_();return c(m.editBundle(r.id))}),g(),n(3,"svg",19),f(4,"path",20),o()(),b(),n(5,"button",21),a(6,"translate"),v("click",function(){let r=u(e).$implicit,m=_();return c(m.confirmDelete(r))}),g(),n(7,"svg",19),f(8,"path",22),o()()()}d&2&&(l(),p("title",s(2,2,"common.edit")),l(4),p("title",s(6,4,"common.delete")))}var A=class d{router=y(Q);bundlesService=y(G);bundles=[];searchQuery="";errorMessage="";loading=!1;deleting=!1;selectedBundleId=null;selectedBundleName="";deleteModal;columns=[{key:"id",label:"table.bundleId",sortable:!0},{key:"name",label:"table.name",sortable:!0},{key:"fixedPrice",label:"table.fixedPrice",sortable:!0},{key:"itemsCount",label:"table.items",sortable:!0},{key:"status",label:"table.status",sortable:!0},{key:"actions",label:"table.action"}];ngOnInit(){this.loadBundles()}loadBundles(){this.loading=!0,this.bundlesService.getAll().subscribe({next:t=>{this.bundles=t.map(e=>M(k({},e),{fixedPrice:e.fixedPrice.toFixed(2),itemsCount:e.items.length})),this.loading=!1},error:()=>{this.errorMessage="Failed to load bundles",this.loading=!1}})}onSearch(){if(this.searchQuery.trim()){let t=this.searchQuery.toLowerCase();this.bundles=this.bundles.filter(e=>e.name.toLowerCase().includes(t)||e.id.toLowerCase().includes(t))}else this.loadBundles()}navigateToNew(){this.router.navigate(["/bundles/new"])}editBundle(t){this.router.navigate(["/bundles",t,"edit"])}confirmDelete(t){this.selectedBundleId=t.id,this.selectedBundleName=t.name,this.deleteModal.open()}deleteBundle(){this.selectedBundleId&&(this.deleting=!0,this.bundlesService.delete(this.selectedBundleId).subscribe({next:t=>{t&&(this.loadBundles(),this.deleteModal.close(),this.selectedBundleId=null,this.selectedBundleName=""),this.deleting=!1},error:()=>{this.errorMessage="Failed to delete bundle",this.deleting=!1}}))}static \u0275fac=function(e){return new(e||d)};static \u0275cmp=S({type:d,selectors:[["app-bundles-list"]],viewQuery:function(e,i){if(e&1&&T(R,5),e&2){let r;V(r=I())&&(i.deleteModal=r.first)}},decls:32,vars:30,consts:[["actionTemplate",""],["deleteModal",""],[1,"space-y-6"],["type","error",3,"title"],[1,"flex","items-center","justify-between","gap-4"],[1,"flex-1","max-w-lg"],[1,"relative"],["type","text",1,"w-full","pl-10","pr-4","py-2.5","border","border-gray-300","rounded-[var(--radius-md)]","text-sm","focus:outline-none","focus:ring-2","focus:ring-[var(--primary-color)]","focus:border-[var(--primary-color)]",3,"input","placeholder","value"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","absolute","left-3","top-2.5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],[1,"flex","gap-3"],["variant","outline"],["variant","primary",3,"onClick"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","inline","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],["rowIdKey","id",3,"columns","data","emptyMessage","loading"],[3,"confirmed","title","showFooter","confirmText","confirmLoading"],[1,"flex","items-center","gap-2"],[1,"p-1","text-gray-600","hover:text-gray-900",3,"click","title"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"p-1","text-gray-600","hover:text-red-600",3,"click","title"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"]],template:function(e,i){if(e&1){let r=w();n(0,"div",2),C(1,q,1,1,"app-alert",3),n(2,"div",4)(3,"div",5)(4,"div",6)(5,"input",7),a(6,"translate"),v("input",function(O){return u(r),i.searchQuery=O.target.value,c(i.onSearch())}),o(),g(),n(7,"svg",8),f(8,"path",9),o()()(),b(),n(9,"div",10)(10,"app-button",11),h(11),a(12,"translate"),o(),n(13,"app-button",12),v("onClick",function(){return u(r),c(i.navigateToNew())}),g(),n(14,"svg",13),f(15,"path",14),o(),h(16),a(17,"translate"),o()()(),b(),n(18,"app-table",15),C(19,z,9,6,"ng-template",null,0,E),o(),n(21,"app-modal",16,1),a(23,"translate"),a(24,"translate"),v("confirmed",function(){return u(r),c(i.deleteBundle())}),n(25,"p"),h(26),a(27,"translate"),n(28,"strong"),h(29),o(),h(30),a(31,"translate"),o()()()}e&2&&(l(),L(i.errorMessage?1:-1),l(4),p("placeholder",s(6,16,"common.search"))("value",i.searchQuery),l(6),B(s(12,18,"common.export")),l(5),x(" ",s(17,20,"button.addNewBundle")," "),l(2),p("columns",i.columns)("data",i.bundles)("emptyMessage","empty.noBundles")("loading",i.loading),l(3),p("title",s(23,22,"button.deleteBundle"))("showFooter",!0)("confirmText",s(24,24,"common.delete"))("confirmLoading",i.deleting),l(5),x("",s(27,26,"modal.deleteBundleConfirm")," "),l(3),B(i.selectedBundleName),l(),B(s(31,28,"modal.cannotUndo")))},dependencies:[N,F,P,D,H,j],encapsulation:2})};export{A as BundlesListComponent};
