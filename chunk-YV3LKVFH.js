import{a as O}from"./chunk-TCUYX7IT.js";import{a as j}from"./chunk-XG6FMBJJ.js";import{a as H}from"./chunk-6CFKC637.js";import{a as G}from"./chunk-5PFWNSG3.js";import{b as N}from"./chunk-3UJCRMW3.js";import{b as V,d as A}from"./chunk-C3O3TVFX.js";import{$a as i,Ab as d,Bb as g,Cb as x,Fa as I,Ka as u,Q as _,Qa as b,Sa as y,Va as s,W as S,Wa as k,Wb as T,X as D,Xb as L,Y as h,Ya as w,Z as C,Za as M,_a as t,_b as P,ab as v,cb as B,db as E,eb as m,mb as n,nb as o,ob as f,wa as r}from"./chunk-E4S7NVXB.js";import"./chunk-C6Q5SG76.js";function U(a,l){if(a&1&&v(0,"app-alert",1),a&2){let e=m();b("title",e.errorMessage)}}function q(a,l){if(a&1&&(t(0,"div",16)(1,"label",14),n(2,"Description"),i(),t(3,"p",17),n(4),i()()),a&2){let e=m(2);r(4),o(e.drug.generalDrug==null?null:e.drug.generalDrug.description)}}function F(a,l){if(a&1&&(t(0,"div")(1,"label",14),n(2,"Price After Discount"),i(),t(3,"p",20),n(4),i()()),a&2){let e=m(2);r(4),o(e.drug.priceAfterDiscount)}}function z(a,l){a&1&&(t(0,"span",30),n(1,"(Expiring Soon)"),i())}function R(a,l){if(a&1&&(t(0,"div")(1,"label",14),n(2,"Expiry Date"),i(),t(3,"p",17),n(4),d(5,"date"),u(6,z,2,0,"span",30),i()()),a&2){let e=m(2);r(3),y("text-red-600",e.isExpiringSoon(e.drug.expiryDate)),r(),f(" ",x(5,4,e.drug.expiryDate,"mediumDate")," "),r(2),s(e.isExpiringSoon(e.drug.expiryDate)?6:-1)}}function $(a,l){if(a&1&&(t(0,"tr")(1,"td",36),n(2),i(),t(3,"td",36),n(4),i(),t(5,"td",36),n(6),d(7,"date"),i(),t(8,"td",36),n(9),d(10,"date"),i()()),a&2){let e=l.$implicit;r(2),o(e.quantity),r(2),o(e.unitCost),r(2),o(x(7,4,e.purchaseDate,"short")),r(3),o(x(10,7,e.expiryDate,"short"))}}function J(a,l){if(a&1&&(t(0,"div",22)(1,"h2",12),n(2,"Cost Layers"),i(),t(3,"div",31)(4,"table",32)(5,"thead",33)(6,"tr")(7,"th",34),n(8,"Quantity"),i(),t(9,"th",34),n(10,"Unit Cost"),i(),t(11,"th",34),n(12,"Purchase Date"),i(),t(13,"th",34),n(14,"Expiry Date"),i()()(),t(15,"tbody",35),w(16,$,11,10,"tr",null,k),i()()()()),a&2){let e=m(2);r(16),M(e.drug.costLayers)}}function K(a,l){if(a&1){let e=B();t(0,"div",2)(1,"div",4)(2,"h1",5),n(3,"Product Details"),i(),t(4,"div",6)(5,"app-button",7),E("onClick",function(){S(e);let c=m();return D(c.editDrug())}),h(),t(6,"svg",8),v(7,"path",9),i(),n(8," Edit "),i(),C(),t(9,"app-button",7),E("onClick",function(){S(e);let c=m();return D(c.goBack())}),h(),t(10,"svg",8),v(11,"path",10),i(),n(12," Back "),i()()(),C(),t(13,"div",11)(14,"h2",12),n(15,"General Information"),i(),t(16,"div",13)(17,"div")(18,"label",14),n(19,"Drug Name"),i(),t(20,"p",15),n(21),i()(),u(22,q,5,1,"div",16),t(23,"div")(24,"label",14),n(25,"Manufacturer"),i(),t(26,"p",17),n(27),i()(),t(28,"div")(29,"label",14),n(30,"International Barcode"),i(),t(31,"p",18),n(32),i()(),t(33,"div")(34,"label",14),n(35,"Internal Barcode (PLU)"),i(),t(36,"p",18),n(37),i()()()(),t(38,"div",11)(39,"h2",12),n(40,"Stock Information"),i(),t(41,"div",19)(42,"div")(43,"label",14),n(44,"Price"),i(),t(45,"p",20),n(46),i()(),u(47,F,5,1,"div"),t(48,"div")(49,"label",14),n(50,"Stock Quantity"),i(),t(51,"p",20),n(52),i()(),t(53,"div")(54,"label",14),n(55,"Minimum Stock"),i(),t(56,"p",17),n(57),i()(),u(58,R,7,7,"div"),t(59,"div")(60,"label",14),n(61,"Status"),i(),t(62,"app-badge",21),n(63),d(64,"titlecase"),i()()()(),u(65,J,18,0,"div",22),t(66,"div",11)(67,"h2",12),n(68),d(69,"translate"),i(),t(70,"div",23)(71,"div")(72,"label",14),n(73),d(74,"translate"),i(),t(75,"p",15),n(76),i()(),t(77,"div")(78,"label",14),n(79),d(80,"translate"),i(),t(81,"p",15),n(82),i()(),t(83,"div")(84,"label",14),n(85),d(86,"translate"),i(),t(87,"p",15),n(88),i()()(),t(89,"div",24)(90,"app-button",25),E("onClick",function(){S(e);let c=m();return D(c.viewShelfMap())}),h(),t(91,"svg",26),v(92,"path",27),i(),n(93),d(94,"translate"),i()()(),C(),t(95,"div",28)(96,"div",29)(97,"div")(98,"label",14),n(99,"Created At"),i(),t(100,"p",17),n(101),d(102,"date"),i()(),t(103,"div")(104,"label",14),n(105,"Last Updated"),i(),t(106,"p",17),n(107),d(108,"date"),i()()()()()}if(a&2){let e=m();r(21),o((e.drug.generalDrug==null?null:e.drug.generalDrug.name)||"N/A"),r(),s(e.drug.generalDrug!=null&&e.drug.generalDrug.description?22:-1),r(5),o((e.drug.generalDrug==null?null:e.drug.generalDrug.manufacturer)||"N/A"),r(5),o((e.drug.generalDrug==null?null:e.drug.generalDrug.internationalBarcode)||"N/A"),r(5),o(e.drug.internalBarcode),r(9),o(e.drug.price),r(),s(e.drug.priceAfterDiscount!==e.drug.price?47:-1),r(4),y("text-red-600",e.drug.stockQuantity<e.drug.minimumStock),r(),f(" ",e.drug.stockQuantity," "),r(5),o(e.drug.minimumStock),r(),s(e.drug.expiryDate?58:-1),r(4),b("variant",e.getStatusVariant(e.drug.status)),r(),f(" ",g(64,25,e.drug.status)," "),r(2),s(e.drug.costLayers&&e.drug.costLayers.length>0?65:-1),r(3),o(g(69,27,"drug.shelfLocation")),r(5),o(g(74,29,"drug.shelf")),r(3),o(e.getShelfLocation().shelf),r(3),o(g(80,31,"drug.row")),r(3),o(e.getShelfLocation().row),r(3),o(g(86,33,"drug.column")),r(3),o(e.getShelfLocation().column),r(5),f(" ",g(94,35,"drug.viewOnMap")," "),r(8),o(x(102,37,e.drug.createdAt,"medium")),r(6),o(x(108,40,e.drug.updatedAt,"medium"))}}function W(a,l){a&1&&(t(0,"div",3)(1,"p",37),n(2,"Loading product details..."),i()())}var Q=class a{route=_(V);router=_(A);drugsService=_(O);drug=null;loading=!0;errorMessage="";ngOnInit(){let l=this.route.snapshot.paramMap.get("id");l?this.loadDrug(l):(this.errorMessage="Product ID is required",this.loading=!1)}loadDrug(l){this.loading=!0,this.errorMessage="",this.drugsService.getPharmacyDrugById(l).subscribe({next:e=>{this.drug=e,this.loading=!1,e||(this.errorMessage="Product not found")},error:e=>{this.errorMessage="Failed to load product details",this.loading=!1,console.error("Error loading drug:",e)}})}editDrug(){this.drug&&this.router.navigate(["/drugs",this.drug.id,"edit"])}goBack(){this.router.navigate(["/drugs"])}getStatusVariant(l){return l==="active"?"success":l==="out_of_stock"?"danger":"default"}isExpiringSoon(l){let e=new Date,p=new Date(l),c=Math.floor((p.getTime()-e.getTime())/(1e3*60*60*24));return c<=30&&c>=0}getShelfLocation(){let l=["A","B","C","D"],e=parseInt(this.drug?.id?.slice(-1)||"1",10)%l.length;return{shelf:l[e],row:Math.floor(Math.random()*4)+1,column:Math.floor(Math.random()*8)+1}}viewShelfMap(){this.router.navigate(["/inventory/map"],{queryParams:{drugId:this.drug?.id}})}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=I({type:a,selectors:[["app-drug-detail"]],decls:4,vars:2,consts:[[1,"space-y-[var(--spacing-gap)]"],["type","error",3,"title"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-[var(--spacing-card)]"],[1,"text-center","py-12"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-[var(--text-primary)]"],[1,"flex","gap-3"],["variant","outline",3,"onClick"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","inline","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"mb-6","pb-6","border-b","border-[var(--border-color)]"],[1,"text-lg","font-semibold","text-[var(--text-primary)]","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],[1,"block","text-sm","font-medium","text-[var(--card-text)]","mb-1"],[1,"text-[var(--text-primary)]","font-medium"],[1,"md:col-span-2"],[1,"text-[var(--text-primary)]"],[1,"text-[var(--text-primary)]","font-mono"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"text-[var(--text-primary)]","font-medium","text-lg"],[3,"variant"],[1,"mb-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"mt-4"],["variant","outline","size","sm",3,"onClick"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","inline","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"],[1,"pt-6","border-t","border-[var(--border-color)]"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","text-sm"],[1,"ml-2","text-xs"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-[var(--border-color)]"],[1,"bg-[var(--page-bg)]"],[1,"px-4","py-3","text-left","text-xs","font-medium","text-[var(--card-text)]","uppercase"],[1,"bg-[var(--card-bg)]","divide-y","divide-[var(--border-color)]"],[1,"px-4","py-3","text-sm","text-[var(--text-primary)]"],[1,"text-[var(--card-text)]"]],template:function(e,p){e&1&&(t(0,"div",0),u(1,U,1,1,"app-alert",1)(2,K,109,43,"div",2)(3,W,3,0,"div",3),i()),e&2&&(r(),s(p.errorMessage?1:-1),r(),s(p.drug?2:p.loading?3:-1))},dependencies:[P,T,L,H,j,G,N],encapsulation:2})};export{Q as DrugDetailComponent};
