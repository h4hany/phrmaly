import{a as A}from"./chunk-THCZEFPZ.js";import"./chunk-P5TE6FOK.js";import"./chunk-N3GUYB4W.js";import{c as w,e as M,g as x,o as T,p as L,q as I,w as P}from"./chunk-VW37JDOU.js";import{a as E}from"./chunk-YJWIIGXE.js";import{b as S}from"./chunk-7DC7YEPQ.js";import{$a as i,$b as _,Bb as p,Cb as d,Ga as D,Ra as h,ab as a,eb as f,nb as r,ob as y,pb as m,ub as g,vb as u,wb as c,xa as l}from"./chunk-OKFD3A6M.js";import{a as b,b as C}from"./chunk-KAT7YFEL.js";var B=class v{loading=!1;filters={entityType:"",user:"",action:"",fromDate:"",toDate:""};allLogs=[{id:"1",timestamp:new Date("2024-11-27T10:30:00"),user:"John Doe",action:"Updated",entity:"Patient",entityId:"PAT001",details:"Updated phone number"},{id:"2",timestamp:new Date("2024-11-27T09:15:00"),user:"Jane Smith",action:"Created",entity:"Invoice",entityId:"INV001",details:"Created new invoice"},{id:"3",timestamp:new Date("2024-11-26T14:20:00"),user:"John Doe",action:"Deleted",entity:"Drug",entityId:"DRG001",details:"Deleted drug"},{id:"4",timestamp:new Date("2024-11-26T11:45:00"),user:"Jane Smith",action:"Viewed",entity:"Patient",entityId:"PAT002",details:"Viewed patient profile"},{id:"5",timestamp:new Date("2024-11-25T16:30:00"),user:"John Doe",action:"Created",entity:"Purchase",entityId:"PUR001",details:"Created purchase invoice"}];filteredLogs=[];pagination={page:1,pageSize:10,total:0,totalPages:0};columns=[{key:"timestamp",label:"patient.audit.timestamp",sortable:!0},{key:"user",label:"patient.audit.user",sortable:!0},{key:"action",label:"patient.audit.action",sortable:!0},{key:"entity",label:"patient.audit.entity",sortable:!0},{key:"entityId",label:"patient.audit.entityId",sortable:!1}];ngOnInit(){this.applyFilters()}applyFilters(){this.loading=!0;let o=[...this.allLogs];if(this.filters.entityType&&(o=o.filter(n=>n.entity===this.filters.entityType)),this.filters.user&&(o=o.filter(n=>n.user.toLowerCase().includes(this.filters.user.toLowerCase()))),this.filters.action&&(o=o.filter(n=>n.action===this.filters.action)),this.filters.fromDate){let n=new Date(this.filters.fromDate);o=o.filter(e=>e.timestamp>=n)}if(this.filters.toDate){let n=new Date(this.filters.toDate);n.setHours(23,59,59,999),o=o.filter(e=>e.timestamp<=n)}let s=(this.pagination.page-1)*this.pagination.pageSize,t=s+this.pagination.pageSize;this.filteredLogs=o.slice(s,t).map(n=>C(b({},n),{timestamp:this.formatDate(n.timestamp)})),this.pagination.total=o.length,this.pagination.totalPages=Math.ceil(o.length/this.pagination.pageSize),this.loading=!1}clearFilters(){this.filters={entityType:"",user:"",action:"",fromDate:"",toDate:""},this.pagination.page=1,this.applyFilters()}onPageChange(o){this.pagination.page=o,this.applyFilters()}formatDate(o){let s=o instanceof Date?o:new Date(o);if(isNaN(s.getTime()))return"";let t=["january","february","march","april","may","june","july","august","september","october","november","december"],n=s.getDate(),e=t[s.getMonth()],W=s.getFullYear();return`${n}, ${e}, ${W}`}static \u0275fac=function(s){return new(s||v)};static \u0275cmp=D({type:v,selectors:[["app-audit-logs"]],decls:62,vars:42,consts:[[1,"space-y-[var(--spacing-gap)]"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-[var(--spacing-card)]"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-[var(--text-primary)]"],[1,"bg-[var(--page-bg)]","rounded-[var(--radius-md)]","p-4","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"block","text-sm","font-medium","text-[var(--card-text)]","mb-1"],[1,"w-full","px-4","py-2","border","border-[var(--border-color)]","rounded-[var(--radius-md)]","text-sm","bg-[var(--card-bg)]","text-[var(--text-primary)]","focus:outline-none","focus:ring-2","focus:ring-[var(--primary-color)]",3,"ngModelChange","ngModel"],["value",""],["value","Patient"],["value","Invoice"],["value","Drug"],["value","Purchase"],["type","text",1,"w-full","px-4","py-2","border","border-[var(--border-color)]","rounded-[var(--radius-md)]","text-sm","bg-[var(--card-bg)]","text-[var(--text-primary)]","focus:outline-none","focus:ring-2","focus:ring-[var(--primary-color)]",3,"ngModelChange","ngModel","placeholder"],["value","Created"],["value","Updated"],["value","Deleted"],["value","Viewed"],[1,"flex","gap-2"],["type","date",1,"flex-1","px-4","py-2","border","border-[var(--border-color)]","rounded-[var(--radius-md)]","text-sm","bg-[var(--card-bg)]","text-[var(--text-primary)]","focus:outline-none","focus:ring-2","focus:ring-[var(--primary-color)]",3,"ngModelChange","ngModel"],[1,"flex","gap-3","mt-4"],["variant","primary","size","sm",3,"onClick"],["variant","outline","size","sm",3,"onClick"],[3,"onPageChange","columns","data","pagination","loading","emptyMessage"]],template:function(s,t){s&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),r(4),p(5,"translate"),a()(),i(6,"div",4)(7,"div",5)(8,"div")(9,"label",6),r(10),p(11,"translate"),a(),i(12,"select",7),c("ngModelChange",function(e){return u(t.filters.entityType,e)||(t.filters.entityType=e),e}),i(13,"option",8),r(14),p(15,"translate"),a(),i(16,"option",9),r(17,"Patient"),a(),i(18,"option",10),r(19,"Invoice"),a(),i(20,"option",11),r(21,"Drug"),a(),i(22,"option",12),r(23,"Purchase"),a()()(),i(24,"div")(25,"label",6),r(26),p(27,"translate"),a(),i(28,"input",13),p(29,"translate"),c("ngModelChange",function(e){return u(t.filters.user,e)||(t.filters.user=e),e}),a()(),i(30,"div")(31,"label",6),r(32),p(33,"translate"),a(),i(34,"select",7),c("ngModelChange",function(e){return u(t.filters.action,e)||(t.filters.action=e),e}),i(35,"option",8),r(36),p(37,"translate"),a(),i(38,"option",14),r(39,"Created"),a(),i(40,"option",15),r(41,"Updated"),a(),i(42,"option",16),r(43,"Deleted"),a(),i(44,"option",17),r(45,"Viewed"),a()()(),i(46,"div")(47,"label",6),r(48),p(49,"translate"),a(),i(50,"div",18)(51,"input",19),c("ngModelChange",function(e){return u(t.filters.fromDate,e)||(t.filters.fromDate=e),e}),a(),i(52,"input",19),c("ngModelChange",function(e){return u(t.filters.toDate,e)||(t.filters.toDate=e),e}),a()()()(),i(53,"div",20)(54,"app-button",21),f("onClick",function(){return t.applyFilters()}),r(55),p(56,"translate"),a(),i(57,"app-button",22),f("onClick",function(){return t.clearFilters()}),r(58),p(59,"translate"),a()()(),i(60,"app-table",23),p(61,"translate"),f("onPageChange",function(e){return t.onPageChange(e)}),a()()()),s&2&&(l(4),y(d(5,20,"audit.title")),l(6),m(" ",d(11,22,"audit.entityType")," "),l(2),g("ngModel",t.filters.entityType),l(2),y(d(15,24,"common.all")),l(12),m(" ",d(27,26,"audit.user")," "),l(2),g("ngModel",t.filters.user),h("placeholder",d(29,28,"common.search")),l(4),m(" ",d(33,30,"audit.action")," "),l(2),g("ngModel",t.filters.action),l(2),y(d(37,32,"common.all")),l(12),m(" ",d(49,34,"audit.dateRange")," "),l(3),g("ngModel",t.filters.fromDate),l(),g("ngModel",t.filters.toDate),l(3),m(" ",d(56,36,"audit.applyFilters")," "),l(3),m(" ",d(59,38,"audit.clearFilters")," "),l(2),h("columns",t.columns)("data",t.filteredLogs)("pagination",t.pagination)("loading",t.loading)("emptyMessage",d(61,40,"audit.noLogs")))},dependencies:[_,P,L,I,w,T,M,x,A,E,S],encapsulation:2})};export{B as AuditLogsComponent};
