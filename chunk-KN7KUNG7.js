import{a as q}from"./chunk-UW4RQ676.js";import{a as A}from"./chunk-PRIAQIJ7.js";import{a as G}from"./chunk-NOBFKF32.js";import{a as F}from"./chunk-77NWAUUO.js";import{a as L}from"./chunk-L2QHXWDV.js";import{b as z}from"./chunk-EO5VULWO.js";import{b as j,d as N}from"./chunk-5NQMXUDV.js";import"./chunk-TXY55LQM.js";import{$a as f,Ab as P,Ea as B,G as w,Ja as u,Pa as b,R as g,Tb as V,Ua as v,Vb as H,X as _,Xa as D,Y as I,Ya as M,Z as h,Za as i,_ as C,_a as n,bb as T,cb as S,db as c,j as y,lb as a,mb as r,nb as s,wa as t,yb as p,zb as d}from"./chunk-F5WAPTHD.js";import{a as E,b as k}from"./chunk-7CGTOI24.js";var W=(o,l)=>l.id;function $(o,l){if(o&1&&f(0,"app-alert",1),o&2){let e=c();b("title",e.errorMessage)}}function R(o,l){if(o&1&&(i(0,"div")(1,"label",17),a(2),p(3,"translate"),n(),i(4,"p",34),a(5),n()()),o&2){let e=c(2);t(2),r(d(3,2,"invoice.paymentMethod")),t(3),r(e.invoice.paymentMethod)}}function J(o,l){o&1&&(i(0,"th",25),a(1),p(2,"translate"),n()),o&2&&(t(),r(d(2,1,"invoice.discount")))}function K(o,l){if(o&1&&(i(0,"td",35),a(1),n()),o&2){let e=c().$implicit;t(),s(" ",e.discount?e.discount:"-"," ")}}function Q(o,l){if(o&1&&(i(0,"tr",28)(1,"td",35),a(2),n(),i(3,"td",35),a(4),n(),i(5,"td",35),a(6),n(),u(7,K,2,1,"td",35),i(8,"td",36),a(9),n()()),o&2){let e=l.$implicit,m=c(2);t(2),r(e.drugName),t(2),r(e.quantity),t(2),r(e.unitPrice),t(),v(m.hasItemsWithDiscount()?7:-1),t(2),r(e.totalPrice)}}function U(o,l){if(o&1&&(i(0,"div",32)(1,"span"),a(2),p(3,"translate"),n(),i(4,"span",19),a(5),n()()),o&2){let e=c(2);t(2),s("",d(3,2,"invoice.discount"),":"),t(3),r(e.invoice.discount)}}function X(o,l){if(o&1&&(i(0,"div",32)(1,"span"),a(2),p(3,"translate"),n(),i(4,"span",19),a(5),n()()),o&2){let e=c(2);t(2),s("",d(3,2,"invoice.promoCode"),":"),t(3),r(e.invoice.promoCode)}}function Y(o,l){if(o&1){let e=T();i(0,"div",2)(1,"div",4)(2,"h1",5),a(3),p(4,"translate"),n(),i(5,"div",6)(6,"app-button",7),S("onClick",function(){_(e);let x=c();return I(x.printInvoice())}),h(),i(7,"svg",8),f(8,"path",9),n(),a(9),p(10,"translate"),n(),C(),i(11,"app-button",7),S("onClick",function(){_(e);let x=c();return I(x.exportPdf())}),h(),i(12,"svg",8),f(13,"path",10),n(),a(14),p(15,"translate"),n(),C(),i(16,"app-button",11),S("onClick",function(){_(e);let x=c();return I(x.editInvoice())}),h(),i(17,"svg",8),f(18,"path",12),n(),a(19),p(20,"translate"),n(),C(),i(21,"app-button",11),S("onClick",function(){_(e);let x=c();return I(x.goBack())}),h(),i(22,"svg",8),f(23,"path",13),n(),a(24),p(25,"translate"),n()()(),C(),i(26,"div",14)(27,"h2",15),a(28),p(29,"translate"),n(),i(30,"div",16)(31,"div")(32,"label",17),a(33),p(34,"translate"),n(),i(35,"p",18),a(36),n()(),i(37,"div")(38,"label",17),a(39),p(40,"translate"),n(),i(41,"p",19),a(42),n()(),i(43,"div")(44,"label",17),a(45),p(46,"translate"),n(),i(47,"app-badge",20),a(48),p(49,"translate"),n()(),u(50,R,6,4,"div"),i(51,"div")(52,"label",17),a(53),p(54,"translate"),n(),i(55,"p",19),a(56),p(57,"date"),n()()()(),i(58,"div",21)(59,"h2",15),a(60),p(61,"translate"),n(),i(62,"div",22)(63,"table",23)(64,"thead",24)(65,"tr")(66,"th",25),a(67),p(68,"translate"),n(),i(69,"th",25),a(70),p(71,"translate"),n(),i(72,"th",25),a(73),p(74,"translate"),n(),u(75,J,3,3,"th",25),i(76,"th",26),a(77),p(78,"translate"),n()()(),i(79,"tbody",27),D(80,Q,10,5,"tr",28,W),n()()()(),i(82,"div",29)(83,"div",30)(84,"div",31)(85,"div",32)(86,"span"),a(87),p(88,"translate"),n(),i(89,"span",18),a(90),n()(),u(91,U,6,4,"div",32)(92,X,6,4,"div",32),i(93,"div",33)(94,"span"),a(95),p(96,"translate"),n(),i(97,"span"),a(98),n()()()()()()}if(o&2){let e=c();t(3),r(d(4,30,"invoice.details")),t(3),b("loading",e.printing),t(3),s(" ",d(10,32,"invoice.print")," "),t(2),b("loading",e.exporting),t(3),s(" ",d(15,34,"invoice.exportPdf")," "),t(5),s(" ",d(20,36,"common.edit")," "),t(5),s(" ",d(25,38,"common.back")," "),t(4),r(d(29,40,"invoice.invoiceInfo")),t(5),r(d(34,42,"invoice.invoiceNumber")),t(3),r(e.invoice.invoiceNumber),t(3),r(d(40,44,"invoice.patient")),t(3),r((e.invoice.patient==null?null:e.invoice.patient.fullName)||"N/A"),t(3),r(d(46,46,"invoice.paymentStatus")),t(2),b("variant",e.getPaymentStatusVariant(e.invoice.paymentStatus)),t(),s(" ",d(49,48,e.getPaymentStatusLabel(e.invoice.paymentStatus))," "),t(2),v(e.invoice.paymentMethod?50:-1),t(3),r(d(54,50,"invoice.createdAt")),t(3),r(P(57,52,e.invoice.createdAt,"medium")),t(4),r(d(61,55,"invoice.items")),t(7),r(d(68,57,"invoice.itemName")),t(3),r(d(71,59,"invoice.quantity")),t(3),r(d(74,61,"invoice.unitPrice")),t(2),v(e.hasItemsWithDiscount()?75:-1),t(2),r(d(78,63,"invoice.totalPrice")),t(3),M(e.invoice.items),t(7),s("",d(88,65,"invoice.subtotal"),":"),t(3),r(e.invoice.subtotal),t(),v(e.invoice.discount>0?91:-1),t(),v(e.invoice.promoCode?92:-1),t(3),s("",d(96,67,"invoice.total"),":"),t(3),r(e.invoice.total)}}function Z(o,l){o&1&&(i(0,"div",3)(1,"p",37),a(2),p(3,"translate"),n()()),o&2&&(t(2),r(d(3,1,"common.loading")))}var O=class o{route=g(j);router=g(N);invoicesService=g(q);patientsService=g(G);invoice=null;loading=!0;errorMessage="";printing=!1;exporting=!1;ngOnInit(){let l=this.route.snapshot.paramMap.get("id");l?this.loadInvoice(l):(this.errorMessage="Invoice ID is required",this.loading=!1)}loadInvoice(l){this.loading=!0,this.errorMessage="",this.invoicesService.getById(l).pipe(w(e=>e?e.patientId?this.patientsService.getById(e.patientId).pipe(w(m=>y([k(E({},e),{patient:m||void 0})]))):y([E({},e)]):(this.errorMessage="Invoice not found",this.loading=!1,y([])))).subscribe({next:e=>{e&&e.length>0&&(this.invoice=e[0]),this.loading=!1},error:e=>{this.errorMessage="Failed to load invoice details",this.loading=!1,console.error("Error loading invoice:",e)}})}editInvoice(){this.invoice&&this.router.navigate(["/invoices",this.invoice.id,"edit"])}goBack(){this.router.navigate(["/invoices"])}getPaymentStatusVariant(l){return l==="paid"?"success":l==="partial"?"warning":"default"}getPaymentStatusLabel(l){return l==="paid"?"invoice.status.paid":l==="partial"?"invoice.status.partial":"invoice.status.pending"}hasItemsWithDiscount(){return this.invoice?.items.some(l=>l.discount)??!1}printInvoice(){this.printing=!0,setTimeout(()=>{window.print(),this.printing=!1},300)}exportPdf(){this.exporting=!0,setTimeout(()=>{console.log("Exporting PDF..."),alert("PDF export functionality will be implemented with backend integration"),this.exporting=!1},1e3)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=B({type:o,selectors:[["app-invoice-detail"]],decls:4,vars:2,consts:[[1,"space-y-[var(--spacing-gap)]"],["type","error",3,"title"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-[var(--spacing-card)]"],[1,"text-center","py-12"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-[var(--text-primary)]"],[1,"flex","gap-3"],["variant","outline",3,"onClick","loading"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","inline","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],["variant","outline",3,"onClick"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"mb-6","pb-6","border-b","border-[var(--border-color)]"],[1,"text-lg","font-semibold","text-[var(--text-primary)]","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],[1,"block","text-sm","font-medium","text-[var(--card-text)]","mb-1"],[1,"text-[var(--text-primary)]","font-medium"],[1,"text-[var(--text-primary)]"],[3,"variant"],[1,"mb-6"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-[var(--border-color)]"],[1,"bg-[var(--page-bg)]"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-[var(--card-text)]","uppercase","tracking-wider"],[1,"px-6","py-3","text-right","text-xs","font-medium","text-[var(--card-text)]","uppercase","tracking-wider"],[1,"bg-[var(--card-bg)]","divide-y","divide-[var(--border-color)]"],[1,"hover:bg-[var(--page-bg)]","transition-colors"],[1,"pt-6","border-t","border-[var(--border-color)]"],[1,"flex","justify-end"],[1,"w-full","max-w-md","space-y-3"],[1,"flex","justify-between","text-sm","text-[var(--card-text)]"],[1,"flex","justify-between","text-lg","font-bold","text-[var(--text-primary)]","pt-3","border-t","border-[var(--border-color)]"],[1,"text-[var(--text-primary)]","capitalize"],[1,"px-6","py-4","text-sm","text-[var(--text-primary)]"],[1,"px-6","py-4","text-sm","text-[var(--text-primary)]","text-right","font-medium"],[1,"text-[var(--card-text)]"]],template:function(e,m){e&1&&(i(0,"div",0),u(1,$,1,1,"app-alert",1)(2,Y,99,69,"div",2)(3,Z,4,3,"div",3),n()),e&2&&(t(),v(m.errorMessage?1:-1),t(),v(m.invoice?2:m.loading?3:-1))},dependencies:[H,V,L,F,A,z],encapsulation:2})};export{O as InvoiceDetailComponent};
