import{a as Q}from"./chunk-W24DLKMY.js";import{a as L}from"./chunk-LNJRAZKD.js";import{c as A,d as v,e as V,f as q,h as G,j as O,m as R,n as k,o as D,p as j,t as U,v as W}from"./chunk-J4RW7IXS.js";import{a as J}from"./chunk-GHDX2O3N.js";import"./chunk-C4LLEIGY.js";import"./chunk-BYXBJQAS.js";import{a as K}from"./chunk-K7KLI742.js";import{a as z}from"./chunk-H653ED7N.js";import{b as H}from"./chunk-7YN2F2UA.js";import{b as B,d as T}from"./chunk-J2A4D5WT.js";import{Da as P,Ia as u,Oa as c,Q as d,Qa as _,Ta as h,Wb as w,Ya as t,Za as e,_a as f,bb as x,cb as M,kb as a,lb as g,mb as E,va as r,yb as l,zb as m}from"./chunk-ILVQMZIM.js";import{a as N,b as I}from"./chunk-7CGTOI24.js";function Y(o,n){if(o&1&&f(0,"app-alert",1),o&2){let s=M();c("title",s.errorMessage)}}function Z(o,n){o&1&&(t(0,"p",7),a(1,"Full name is required"),e())}function $(o,n){o&1&&(t(0,"p",7),a(1,"Valid email is required"),e())}function ee(o,n){o&1&&(t(0,"p",7),a(1,"Role is required"),e())}var X=class o{fb=d(U);router=d(T);route=d(B);pharmacyStaffService=d(Q);pharmacyContext=d(J);staffForm;loading=!1;errorMessage="";isEdit=!1;staffId=null;ngOnInit(){this.staffId=this.route.snapshot.paramMap.get("id"),this.isEdit=!!this.staffId&&this.route.snapshot.url[this.route.snapshot.url.length-1]?.path==="edit";let s=this.pharmacyContext.getCurrentPharmacy()?.id||"ph1";this.staffForm=this.fb.group({fullName:["",[v.required]],email:["",[v.required,v.email]],phone:[""],username:[""],role:["",[v.required]],status:["active"],notes:[""]}),this.isEdit&&this.staffId&&this.loadStaff()}loadStaff(){this.loading=!0,this.pharmacyStaffService.getById(this.staffId).subscribe({next:n=>{n&&this.staffForm.patchValue({fullName:n.fullName,email:n.email,phone:n.phone||"",username:n.username||"",role:n.role,status:n.status,notes:""}),this.loading=!1},error:()=>{this.errorMessage="Failed to load staff member",this.loading=!1}})}onSubmit(){if(this.staffForm.invalid){this.staffForm.markAllAsTouched();return}this.loading=!0,this.errorMessage="";let s=this.pharmacyContext.getCurrentPharmacy()?.id||"ph1",i=I(N({},this.staffForm.value),{pharmacyId:s});(this.isEdit?this.pharmacyStaffService.update(this.staffId,i):this.pharmacyStaffService.create(i)).subscribe({next:()=>{this.router.navigate(["/pharmacy-staff"])},error:()=>{this.errorMessage=this.isEdit?"Failed to update staff member":"Failed to create staff member",this.loading=!1}})}onCancel(){this.router.navigate(["/pharmacy-staff"])}static \u0275fac=function(s){return new(s||o)};static \u0275cmp=P({type:o,selectors:[["app-pharmacy-staff-form"]],decls:67,vars:38,consts:[[3,"title"],["type","error",3,"title"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],[1,"text-red-500"],["type","text","formControlName","fullName",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]"],[1,"mt-1","text-sm","text-red-600"],["type","email","formControlName","email",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]"],["type","tel","formControlName","phone",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]"],["type","text","formControlName","username",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]"],["formControlName","role",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]"],["value",""],["value","account_owner"],["value","pharmacy_manager"],["value","pharmacy_staff"],["formControlName","status",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]"],["value","active"],["value","inactive"],[1,"md:col-span-2"],["formControlName","notes","rows","3",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]"],[1,"flex","items-center","justify-end","gap-4","pt-6","border-t"],["type","button","variant","outline",3,"onClick"],["type","submit","variant","primary",3,"loading","disabled"]],template:function(s,i){if(s&1&&(t(0,"app-form-wrapper",0),l(1,"translate"),l(2,"translate"),u(3,Y,1,1,"app-alert",1),t(4,"form",2),x("ngSubmit",function(){return i.onSubmit()}),t(5,"div",3)(6,"div")(7,"label",4),a(8," Full Name "),t(9,"span",5),a(10,"*"),e()(),f(11,"input",6),u(12,Z,2,0,"p",7),e(),t(13,"div")(14,"label",4),a(15," Email "),t(16,"span",5),a(17,"*"),e()(),f(18,"input",8),u(19,$,2,0,"p",7),e(),t(20,"div")(21,"label",4),a(22,"Phone"),e(),f(23,"input",9),e(),t(24,"div")(25,"label",4),a(26,"Username"),e(),f(27,"input",10),e(),t(28,"div")(29,"label",4),a(30," Role "),t(31,"span",5),a(32,"*"),e()(),t(33,"select",11)(34,"option",12),a(35),l(36,"translate"),e(),t(37,"option",13),a(38),l(39,"translate"),e(),t(40,"option",14),a(41),l(42,"translate"),e(),t(43,"option",15),a(44),l(45,"translate"),e()(),u(46,ee,2,0,"p",7),e(),t(47,"div")(48,"label",4),a(49,"Status"),e(),t(50,"select",16)(51,"option",17),a(52,"Active"),e(),t(53,"option",18),a(54,"Inactive"),e()()(),t(55,"div",19)(56,"label",4),a(57,"Notes"),e(),f(58,"textarea",20),e()(),t(59,"div",21)(60,"app-button",22),x("onClick",function(){return i.onCancel()}),a(61),l(62,"translate"),e(),t(63,"app-button",23),a(64),l(65,"translate"),l(66,"translate"),e()()()()),s&2){let p,y,S,b,C,F;c("title",i.isEdit?m(1,20,"staff.edit"):m(2,22,"staff.add")),r(3),h(i.errorMessage?3:-1),r(),c("formGroup",i.staffForm),r(7),_("border-red-500",((p=i.staffForm.get("fullName"))==null?null:p.invalid)&&((p=i.staffForm.get("fullName"))==null?null:p.touched)),r(),h((y=i.staffForm.get("fullName"))!=null&&y.invalid&&((y=i.staffForm.get("fullName"))!=null&&y.touched)?12:-1),r(6),_("border-red-500",((S=i.staffForm.get("email"))==null?null:S.invalid)&&((S=i.staffForm.get("email"))==null?null:S.touched)),r(),h((b=i.staffForm.get("email"))!=null&&b.invalid&&((b=i.staffForm.get("email"))!=null&&b.touched)?19:-1),r(14),_("border-red-500",((C=i.staffForm.get("role"))==null?null:C.invalid)&&((C=i.staffForm.get("role"))==null?null:C.touched)),r(2),g(m(36,24,"form.selectStatus")),r(3),g(m(39,26,"staff.accountOwner")),r(3),g(m(42,28,"staff.pharmacyManager")),r(3),g(m(45,30,"staff.pharmacyStaff")),r(2),h((F=i.staffForm.get("role"))!=null&&F.invalid&&((F=i.staffForm.get("role"))!=null&&F.touched)?46:-1),r(15),E(" ",m(62,32,"common.cancel")," "),r(2),c("loading",i.loading)("disabled",i.staffForm.invalid),r(),E(" ",i.isEdit?m(65,34,"staff.update"):m(66,36,"staff.create")," ")}},dependencies:[w,W,G,D,j,A,k,V,q,O,R,L,K,z,H],encapsulation:2})};export{X as PharmacyStaffFormComponent};
