import{a as O}from"./chunk-RDKAGODG.js";import"./chunk-3GG4LG3P.js";import"./chunk-543QFZRG.js";import"./chunk-YHIVJIYC.js";import{a as x,b as N}from"./chunk-IVMEOUAV.js";import"./chunk-RI4HLURJ.js";import{a as I}from"./chunk-THCZEFPZ.js";import"./chunk-P5TE6FOK.js";import"./chunk-N3GUYB4W.js";import{c as L,e as T,g as _,w}from"./chunk-VW37JDOU.js";import{a as B}from"./chunk-YJWIIGXE.js";import"./chunk-YUKQXM5O.js";import"./chunk-M3W4QUEG.js";import"./chunk-BYXBJQAS.js";import"./chunk-QHH3SHC3.js";import{a as E}from"./chunk-GYQ2QOAA.js";import{b as P}from"./chunk-7DC7YEPQ.js";import{$a as i,$b as M,Bb as l,Cb as p,Ga as C,Ra as m,S as k,ab as o,bb as d,eb as D,nb as c,ob as f,pb as S,ub as g,vb as h,wb as v,xa as t}from"./chunk-OKFD3A6M.js";import{a as b,b as u}from"./chunk-KAT7YFEL.js";var R=class y{hrPerformanceService=k(O);loading=!1;performanceLeaderboard=[];riskLeaderboard=[];filters={startDate:"",endDate:""};performanceColumns=[{key:"rank",label:"hr.performance.rank",sortable:!1},{key:"staffName",label:"hr.performance.staff",sortable:!0},{key:"overallScore",label:"hr.performance.score",sortable:!0},{key:"performanceGrade",label:"hr.performance.grade",sortable:!0},{key:"sales",label:"hr.performance.sales",sortable:!0},{key:"attendance",label:"hr.performance.attendance",sortable:!0}];riskColumns=[{key:"rank",label:"hr.performance.rank",sortable:!1},{key:"staffName",label:"hr.performance.staff",sortable:!0},{key:"riskScore",label:"hr.performance.riskScore",sortable:!0},{key:"riskLevel",label:"hr.performance.riskLevel",sortable:!0},{key:"suspiciousMovements",label:"hr.performance.suspiciousMovements",sortable:!0},{key:"errors",label:"hr.performance.errors",sortable:!0}];riskTrendData={};rankingData={};chartOptions={};ngOnInit(){let a=new Date,e=new Date;e.setMonth(e.getMonth()-1),this.filters.startDate=e.toISOString().split("T")[0],this.filters.endDate=a.toISOString().split("T")[0],this.loadData()}loadData(){this.loading=!0;let a=new Date(this.filters.startDate),e=new Date(this.filters.endDate);this.hrPerformanceService.getPerformanceLeaderboard(a,e,10).subscribe({next:r=>{this.performanceLeaderboard=r.map((s,n)=>u(b({},s),{rank:n+1,sales:this.formatCurrency(s.sales.totalRevenue),attendance:`${s.attendance.percentage}%`})),this.loading=!1,this.loadRiskLeaderboard(a,e),this.loadCharts(r)},error:()=>{this.loading=!1}})}loadRiskLeaderboard(a,e){this.hrPerformanceService.getRiskLeaderboard(a,e,10).subscribe({next:r=>{this.riskLeaderboard=r.map((s,n)=>u(b({},s),{rank:n+1,suspiciousMovements:s.inventory.suspiciousMovements,errors:s.errors.totalErrors}))}})}loadCharts(a){this.riskTrendData={labels:a.map(e=>e.staffName),datasets:[{label:"Risk Score",data:a.map(e=>e.riskScore),backgroundColor:a.map(e=>e.riskLevel==="critical"?"rgba(239, 68, 68, 0.8)":e.riskLevel==="high"?"rgba(245, 158, 11, 0.8)":e.riskLevel==="medium"?"rgba(59, 130, 246, 0.8)":"rgba(16, 185, 129, 0.8)")}]},this.rankingData={labels:a.map(e=>e.staffName),datasets:[{label:"Performance Score",data:a.map(e=>e.overallScore),backgroundColor:"rgba(22, 101, 52, 0.8)"}]},this.chartOptions={responsive:!0,maintainAspectRatio:!1,indexAxis:"y"}}formatCurrency(a){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(a)}applyFilters(){this.loadData()}static \u0275fac=function(e){return new(e||y)};static \u0275cmp=C({type:y,selectors:[["app-performance"]],decls:35,vars:40,consts:[[1,"space-y-6"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-[var(--text-primary)]"],[1,"flex","gap-3"],["type","date",1,"px-4","py-2","border","border-[var(--border-color)]","rounded-[var(--radius-md)]","text-sm","bg-[var(--card-bg)]","text-[var(--text-primary)]",3,"ngModelChange","ngModel"],["variant","primary","size","sm",3,"onClick"],[3,"title","active"],[1,"space-y-6","p-6"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-6"],[3,"columns","data","loading","emptyMessage"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"text-lg","font-semibold","text-[var(--text-primary)]","mb-4"],[3,"type","data","options"]],template:function(e,r){e&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2),c(3),l(4,"translate"),o(),i(5,"div",3)(6,"input",4),v("ngModelChange",function(n){return h(r.filters.startDate,n)||(r.filters.startDate=n),n}),o(),i(7,"input",4),v("ngModelChange",function(n){return h(r.filters.endDate,n)||(r.filters.endDate=n),n}),o(),i(8,"app-button",5),D("onClick",function(){return r.applyFilters()}),c(9),l(10,"translate"),o()()(),i(11,"app-tabs")(12,"app-tab",6),l(13,"translate"),i(14,"div",7)(15,"div",8),d(16,"app-table",9),l(17,"translate"),o()()(),i(18,"app-tab",6),l(19,"translate"),i(20,"div",7)(21,"div",8),d(22,"app-table",9),l(23,"translate"),o()()()(),i(24,"div",10)(25,"div",8)(26,"h3",11),c(27),l(28,"translate"),o(),d(29,"app-chart",12),o(),i(30,"div",8)(31,"h3",11),c(32),l(33,"translate"),o(),d(34,"app-chart",12),o()()()),e&2&&(t(3),f(p(4,24,"hr.performance.title")),t(3),g("ngModel",r.filters.startDate),t(),g("ngModel",r.filters.endDate),t(2),S(" ",p(10,26,"common.search")," "),t(3),m("title",p(13,28,"hr.performance.leaderboard"))("active",!0),t(4),m("columns",r.performanceColumns)("data",r.performanceLeaderboard)("loading",r.loading)("emptyMessage",p(17,30,"hr.performance.noData")),t(2),m("title",p(19,32,"hr.performance.riskHeatmap"))("active",!1),t(4),m("columns",r.riskColumns)("data",r.riskLeaderboard)("loading",r.loading)("emptyMessage",p(23,34,"hr.performance.noData")),t(5),f(p(28,36,"hr.performance.riskTrend")),t(2),m("type","bar")("data",r.riskTrendData)("options",r.chartOptions),t(3),f(p(33,38,"hr.performance.ranking")),t(2),m("type","bar")("data",r.rankingData)("options",r.chartOptions))},dependencies:[M,w,L,T,_,I,B,P,E,N,x],encapsulation:2})};export{R as PerformanceComponent};
