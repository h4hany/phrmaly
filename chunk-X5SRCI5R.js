import{a as fe}from"./chunk-OKJ336RD.js";import{a as ue,b as ge}from"./chunk-I6DMCTZT.js";import{a as z}from"./chunk-PXA4LIDN.js";import{a as se}from"./chunk-X72QHXER.js";import{a as D}from"./chunk-ZKJ45IBQ.js";import{a as N}from"./chunk-GHDX2O3N.js";import"./chunk-C4LLEIGY.js";import"./chunk-BYXBJQAS.js";import{a as V}from"./chunk-JBZ5JDSH.js";import{a as me}from"./chunk-ONVEZIWC.js";import{a as ve}from"./chunk-CLRJGXDB.js";import{a as ce}from"./chunk-K7KLI742.js";import{a as de}from"./chunk-H653ED7N.js";import{b as C}from"./chunk-7YN2F2UA.js";import{b as le,d as pe}from"./chunk-J2A4D5WT.js";import{Ab as _,Bb as P,Da as b,Ia as y,K as ie,Oa as m,Pa as Q,Q as f,Ta as x,Ub as j,Vb as B,W as q,Wa as ae,Wb as h,X as Y,Xa as oe,Y as Z,Ya as n,Z as K,Za as i,_a as c,ab as re,bb as O,cb as v,i as T,kb as p,lb as s,mb as I,nb as X,ob as R,sa as ne,va as e,y as S,yb as r,zb as d}from"./chunk-ILVQMZIM.js";import{a as W,b as J}from"./chunk-7CGTOI24.js";function ye(o,l){if(o&1&&(n(0,"div")(1,"label",8),p(2),r(3,"translate"),i(),n(4,"p",10),p(5),i()()),o&2){let t=v();e(2),s(d(3,2,"patient.email")),e(3),s(t.patient.email)}}function he(o,l){if(o&1&&(n(0,"div")(1,"label",8),p(2),r(3,"translate"),i(),n(4,"p",10),p(5),i()()),o&2){let t=v();e(2),s(d(3,2,"patient.occupation")),e(3),s(t.patient.occupation)}}function Ce(o,l){if(o&1&&(p(0),r(1,"date")),o&2){let t=v(2);I(" ",_(1,1,t.patient.validUntil,"MM/yy")," ")}}function Ie(o,l){o&1&&p(0," - ")}function we(o,l){if(o&1&&(p(0),r(1,"date")),o&2){let t=v(2);I(" ",_(1,1,t.patient.issuedDate,"MM/yy")," ")}}function Pe(o,l){o&1&&p(0," - ")}function _e(o,l){if(o&1&&c(0,"img",32),o&2){let t=v(2);m("src",t.getPharmacyLogo(),ne)}}function Te(o,l){if(o&1&&(n(0,"div",33)(1,"span",34),p(2),i()()),o&2){let t=v(2);e(2),s(t.getPharmacyInitials())}}function Se(o,l){if(o&1&&(n(0,"div",12)(1,"div",16)(2,"div",17),c(3,"div",18)(4,"div",19)(5,"div",20)(6,"div",21)(7,"div",22),i(),n(8,"div",23)(9,"div")(10,"div",24),p(11),i(),n(12,"div",25),p(13,"CARD NUMBER"),i(),n(14,"div",26),p(15),i()(),n(16,"div",27)(17,"div",28)(18,"div")(19,"div",29),p(20,"VALID"),i(),n(21,"div",30),y(22,Ce,2,4)(23,Ie,1,0),i()(),n(24,"div")(25,"div",29),p(26),r(27,"translate"),i(),n(28,"div",30),y(29,we,2,4)(30,Pe,1,0),i()()(),n(31,"div",31),y(32,_e,1,1,"img",32)(33,Te,3,1,"div",33),i()()()()()),o&2){let t=v();e(11),s(t.patient.fullName),e(4),I(" ",t.patient.cardId," "),e(7),x(t.patient.validUntil?22:23),e(4),s(d(27,6,"patient.issuedDate")),e(3),x(t.patient.issuedDate?29:30),e(3),x(t.getPharmacyLogo()?32:33)}}function Ee(o,l){if(o&1&&(n(0,"div",14)(1,"label",8),p(2),r(3,"translate"),i(),n(4,"p",10),p(5),i()()),o&2){let t=v();e(2),s(d(3,2,"patient.notes")),e(3),s(t.patient.address.notes)}}var L=class o{patient;pharmacyContext=f(N);totalOrders=12;totalSpent=2450.75;loyaltyPoints=245;walletBalance=150.5;ordersIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>';moneyIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';starIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg>';walletIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>';getPharmacyLogo(){return this.pharmacyContext.getCurrentPharmacy()?.logoUrl||null}getPharmacyInitials(){let l=this.pharmacyContext.getCurrentPharmacy();return l?.name?l.name.split(" ").map(t=>t[0]).join("").toUpperCase().slice(0,2):"PH"}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=b({type:o,selectors:[["patient-overview-tab"]],inputs:{patient:"patient"},decls:87,vars:85,consts:[[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[3,"label","value","icon"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-6"],[1,"text-lg","font-semibold","text-[var(--text-primary)]","mb-4"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6"],[1,"lg:col-span-2"],[1,"grid","grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-[var(--card-text)]","mb-1"],[1,"text-[var(--text-primary)]","font-medium"],[1,"text-[var(--text-primary)]"],[1,"text-[var(--text-primary)]","capitalize"],[1,"lg:col-span-1"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],[1,"md:col-span-2","lg:col-span-3"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","text-sm"],[1,"relative","rounded-2xl","p-8","shadow-xl","overflow-hidden",2,"background-color","var(--sidebar-bg)","min-height","220px"],[1,"absolute","inset-0","opacity-[0.15]","pointer-events-none",2,"color","var(--sidebar-text)"],[1,"absolute","rounded-full",2,"top","-10%","left","-5%","width","120px","height","120px","background-color","currentColor"],[1,"absolute","rounded-full",2,"top","10%","right","-8%","width","80px","height","80px","background-color","currentColor"],[1,"absolute","rounded-full",2,"bottom","-5%","right","10%","width","100px","height","100px","background-color","currentColor"],[1,"absolute","rounded-full",2,"bottom","15%","left","-5%","width","60px","height","60px","background-color","currentColor"],[1,"absolute","rounded-full",2,"top","50%","left","-8%","width","70px","height","70px","background-color","currentColor","transform","translateY(-50%)"],[1,"relative","z-10","flex","flex-col","justify-between","h-full",2,"color","var(--sidebar-text)"],[1,"text-lg","font-semibold","mb-6"],[1,"text-sm","opacity-90","mb-3"],[1,"text-xl","font-mono","tracking-wider","mb-8"],[1,"flex","items-end","justify-between"],[1,"flex","gap-6"],[1,"text-xs","opacity-80","mb-1"],[1,"text-sm","font-semibold"],[1,"flex","items-center","justify-center"],["alt","Pharmacy Logo",1,"h-10","w-auto","object-contain",3,"src"],[1,"w-16","h-10","rounded-lg","flex","items-center","justify-center",2,"background-color","rgba(227, 244, 245, 0.2)"],[1,"font-bold","text-lg",2,"color","var(--sidebar-text)"]],template:function(t,a){if(t&1&&(n(0,"div",0)(1,"div",1),c(2,"app-stat-card",2),r(3,"translate"),c(4,"app-stat-card",2),r(5,"translate"),r(6,"currency"),c(7,"app-stat-card",2),r(8,"translate"),c(9,"app-stat-card",2),r(10,"translate"),r(11,"currency"),i(),n(12,"div",3)(13,"h2",4),p(14),r(15,"translate"),i(),n(16,"div",5)(17,"div",6)(18,"div",7)(19,"div")(20,"label",8),p(21),r(22,"translate"),i(),n(23,"p",9),p(24),i()(),n(25,"div")(26,"label",8),p(27),r(28,"translate"),i(),n(29,"p",10),p(30),r(31,"date"),i()(),n(32,"div")(33,"label",8),p(34),r(35,"translate"),i(),n(36,"p",11),p(37),i()(),n(38,"div")(39,"label",8),p(40),r(41,"translate"),i(),n(42,"p",10),p(43),i()(),y(44,ye,6,4,"div")(45,he,6,4,"div"),i()(),y(46,Se,34,8,"div",12),i()(),n(47,"div",3)(48,"h2",4),p(49),r(50,"translate"),i(),n(51,"div",13)(52,"div")(53,"label",8),p(54),r(55,"translate"),i(),n(56,"p",10),p(57),i()(),n(58,"div")(59,"label",8),p(60),r(61,"translate"),i(),n(62,"p",10),p(63),i()(),n(64,"div")(65,"label",8),p(66),r(67,"translate"),i(),n(68,"p",10),p(69),i()(),y(70,Ee,6,4,"div",14),i()(),n(71,"div",3)(72,"div",15)(73,"div")(74,"label",8),p(75),r(76,"translate"),i(),n(77,"p",10),p(78),r(79,"date"),i()(),n(80,"div")(81,"label",8),p(82),r(83,"translate"),i(),n(84,"p",10),p(85),r(86,"date"),i()()()()()),t&2){let u,g;e(2),m("label",d(3,36,"patient.overview.totalOrders"))("value",a.totalOrders)("icon",a.ordersIcon),e(2),m("label",d(5,38,"patient.overview.totalSpent"))("value",(u=P(6,40,a.totalSpent,"USD","","1.2-2"))!==null&&u!==void 0?u:"0.00")("icon",a.moneyIcon),e(3),m("label",d(8,45,"patient.overview.loyaltyPoints"))("value",a.loyaltyPoints)("icon",a.starIcon),e(2),m("label",d(10,47,"patient.overview.walletBalance"))("value",(g=P(11,49,a.walletBalance,"USD","","1.2-2"))!==null&&g!==void 0?g:"0.00")("icon",a.walletIcon),e(5),s(d(15,54,"patient.personalInfo")),e(7),s(d(22,56,"patient.fullName")),e(3),s(a.patient.fullName),e(3),s(d(28,58,"patient.dateOfBirth")),e(3),s(_(31,60,a.patient.dateOfBirth,"mediumDate")),e(4),s(d(35,63,"patient.gender")),e(3),s(a.patient.gender),e(3),s(d(41,65,"patient.phone")),e(3),s(a.patient.phone),e(),x(a.patient.email?44:-1),e(),x(a.patient.occupation?45:-1),e(),x(a.patient.cardId?46:-1),e(3),s(d(50,67,"patient.addressInfo")),e(5),s(d(55,69,"patient.city")),e(3),s(a.patient.address.city),e(3),s(d(61,71,"patient.area")),e(3),s(a.patient.address.area),e(3),s(d(67,73,"patient.street")),e(3),s(a.patient.address.street),e(),x(a.patient.address.notes?70:-1),e(5),s(d(76,75,"invoice.createdAt")),e(3),s(_(79,77,a.patient.createdAt,"medium")),e(4),s(d(83,80,"common.lastUpdated")),e(3),s(_(86,82,a.patient.updatedAt,"medium"))}},dependencies:[h,B,j,D,C],encapsulation:2})};var A=class o{patientId;invoicesService=f(z);invoices=[];loading=!1;pagination={page:1,pageSize:10,total:0,totalPages:0};columns=[{key:"invoiceNumber",label:"invoice.invoiceNumber",sortable:!0},{key:"createdAt",label:"invoice.createdAt",sortable:!0},{key:"itemsCount",label:"invoice.items",sortable:!1},{key:"total",label:"invoice.total",sortable:!0},{key:"paymentStatus",label:"invoice.paymentStatus",sortable:!0}];ngOnInit(){this.loadInvoices()}loadInvoices(){this.loading=!0,this.invoicesService.getAll({page:this.pagination.page,pageSize:this.pagination.pageSize}).subscribe({next:l=>{let t=l.data.filter(a=>a.patientId===this.patientId);this.invoices=t.map(a=>J(W({},a),{itemsCount:`${a.items.length} items`})),this.pagination=J(W({},this.pagination),{total:t.length,totalPages:Math.ceil(t.length/this.pagination.pageSize)}),this.loading=!1},error:()=>{this.loading=!1}})}onPageChange(l){this.pagination.page=l,this.loadInvoices()}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=b({type:o,selectors:[["patient-orders-tab"]],inputs:{patientId:"patientId"},decls:7,vars:10,consts:[[1,"space-y-6"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-6"],[1,"text-lg","font-semibold","text-[var(--text-primary)]","mb-4"],[3,"onPageChange","columns","data","pagination","loading","emptyMessage"]],template:function(t,a){t&1&&(n(0,"div",0)(1,"div",1)(2,"h2",2),p(3),r(4,"translate"),i(),n(5,"app-table",3),r(6,"translate"),O("onPageChange",function(g){return a.onPageChange(g)}),i()()()),t&2&&(e(3),s(d(4,6,"patient.orders.title")),e(2),m("columns",a.columns)("data",a.invoices)("pagination",a.pagination)("loading",a.loading)("emptyMessage",d(6,8,"patient.orders.noOrders")))},dependencies:[h,V,C],encapsulation:2})};var M=class o{pharmacyContextService=f(N);getPatientTimeline(l){return this.pharmacyContextService.getCurrentPharmacy()?.id?T([{id:"1",title:"Prescription Filled",description:"Paracetamol 500mg - 2 boxes",timestamp:new Date("2024-11-25"),type:"success",metadata:{invoice:"INV-001",amount:"15.00"}},{id:"2",title:"Refill Reminder Sent",description:"Amoxicillin 250mg refill due in 5 days",timestamp:new Date("2024-11-20"),type:"info",metadata:{drug:"Amoxicillin 250mg"}},{id:"3",title:"Loyalty Points Earned",description:"+150 points for purchase",timestamp:new Date("2024-11-25"),type:"success",metadata:{points:"150"}}]).pipe(S(300)):T([]).pipe(S(300))}getLoyaltyWallet(l){return this.pharmacyContextService.getCurrentPharmacy()?.id?T({patientId:l,points:1250,tier:"gold",totalSpent:2450,nextTierPoints:250}).pipe(S(300)):T(null).pipe(S(300))}getRefillReminders(l){return this.pharmacyContextService.getCurrentPharmacy()?.id?T([{id:"1",patientId:l,drugId:"PDRG001",drugName:"Paracetamol 500mg",lastFilledDate:new Date("2024-11-01"),nextRefillDate:new Date("2024-12-01"),daysUntilRefill:4,status:"upcoming"},{id:"2",patientId:l,drugId:"PDRG003",drugName:"Amoxicillin 250mg",lastFilledDate:new Date("2024-11-15"),nextRefillDate:new Date("2024-11-29"),daysUntilRefill:-2,status:"overdue"}]).pipe(S(300)):T([]).pipe(S(300))}static \u0275fac=function(t){return new(t||o)};static \u0275prov=ie({token:o,factory:o.\u0275fac,providedIn:"root"})};var Be=(o,l)=>l.id;function De(o,l){if(o&1&&(n(0,"span",23),p(1),r(2,"translate"),r(3,"translate"),i()),o&2){let t=v().$implicit,a=v(2);e(),R("(",a.Math.abs(t.daysUntilRefill)," ",d(2,3,"common.days")," ",d(3,5,"patient.overdue"),")")}}function ke(o,l){if(o&1&&(n(0,"span",24),p(1),r(2,"translate"),i()),o&2){let t=v().$implicit;e(),X("(",t.daysUntilRefill," ",d(2,2,"common.days"),")")}}function Me(o,l){if(o&1&&(n(0,"div",20)(1,"div",21)(2,"div",22),p(3),i(),n(4,"div",16),p(5),r(6,"translate"),y(7,De,4,7,"span",23)(8,ke,3,4,"span",24),i()(),n(9,"app-badge",25),p(10),i()()),o&2){let t=l.$implicit,a=v(2);Q("border-color",a.getReminderBorderColor(t.status)),e(3),s(t.drugName),e(2),X(" ",d(6,8,"patient.refillDue"),": ",a.formatDate(t.nextRefillDate)," "),e(2),x(t.daysUntilRefill<0?7:8),e(2),m("variant",a.getReminderVariant(t.status)),e(),I(" ",t.status," ")}}function Oe(o,l){if(o&1&&(n(0,"div",8)(1,"h3",11),p(2),r(3,"translate"),i(),n(4,"div",18),ae(5,Me,11,10,"div",19,Be),i()()),o&2){let t=v();e(2),s(d(3,1,"patient.refillReminders")),e(3),oe(t.refillReminders)}}var U=class o{patientId;engagementEngine=f(M);walletBalance=150.5;loyaltyPoints=245;currentTier="Silver";nextTier="Gold";nextTierPoints=500;pointsToNextTier=255;refillReminders=[];Math=Math;ngOnInit(){this.loadRefillReminders()}loadRefillReminders(){this.engagementEngine.getRefillReminders(this.patientId).subscribe({next:l=>{this.refillReminders=l}})}getReminderBorderColor(l){return l==="overdue"?"#ef4444":l==="due"?"#f59e0b":"#e5e7eb"}getReminderVariant(l){return l==="overdue"?"danger":l==="due"?"warning":"info"}formatDate(l){return new Date(l).toLocaleDateString()}walletIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>';starIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg>';badgeIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path></svg>';trendIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>';get tierProgress(){return Math.min(100,this.loyaltyPoints/this.nextTierPoints*100)}transactions=[{id:"1",date:new Date("2024-11-27"),type:"earned",points:50,description:"Purchase reward"},{id:"2",date:new Date("2024-11-20"),type:"redeemed",points:-25,description:"Points redemption"},{id:"3",date:new Date("2024-11-15"),type:"earned",points:30,description:"Purchase reward"}];columns=[{key:"date",label:"table.date",sortable:!0},{key:"type",label:"patient.loyalty.type",sortable:!0},{key:"points",label:"patient.loyalty.points",sortable:!0},{key:"description",label:"patient.loyalty.description",sortable:!1}];pagination={page:1,pageSize:10,total:3,totalPages:1};static \u0275fac=function(t){return new(t||o)};static \u0275cmp=b({type:o,selectors:[["patient-loyalty-tab"]],inputs:{patientId:"patientId"},decls:55,vars:68,consts:[[1,"space-y-6"],[1,"bg-gradient-to-br","from-blue-500","to-purple-600","rounded-[var(--radius-lg)]","p-6","text-white"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-lg","font-semibold"],[1,"text-2xl","font-bold"],[1,"grid","grid-cols-2","gap-4","text-sm"],[1,"opacity-80","mb-1"],[1,"text-xl","font-semibold"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-6"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[3,"label","value","icon"],[1,"text-lg","font-semibold","text-[var(--text-primary)]","mb-4"],[1,"space-y-2"],[1,"flex","justify-between","text-sm","text-[var(--card-text)]"],[1,"w-full","bg-gray-200","rounded-full","h-4"],[1,"bg-[var(--primary-bg)]","h-4","rounded-full","transition-all","duration-300"],[1,"text-sm","text-[var(--card-text)]"],[3,"columns","data","pagination","emptyMessage"],[1,"space-y-3"],[1,"flex","items-center","justify-between","p-3","border","rounded-lg",3,"border-color"],[1,"flex","items-center","justify-between","p-3","border","rounded-lg"],[1,"flex-1"],[1,"font-medium","text-[var(--text-primary)]"],[1,"text-red-600","ml-2"],[1,"text-amber-600","ml-2"],[3,"variant"]],template:function(t,a){if(t&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),p(4),r(5,"translate"),i(),n(6,"div",4),p(7),r(8,"currency"),i()(),n(9,"div",5)(10,"div")(11,"div",6),p(12),r(13,"translate"),i(),n(14,"div",7),p(15),i()(),n(16,"div")(17,"div",6),p(18),r(19,"translate"),i(),n(20,"div",7),p(21),i()()()(),y(22,Oe,7,3,"div",8),n(23,"div",9),c(24,"app-stat-card",10),r(25,"translate"),r(26,"currency"),c(27,"app-stat-card",10),r(28,"translate"),c(29,"app-stat-card",10),r(30,"translate"),c(31,"app-stat-card",10),r(32,"translate"),i(),n(33,"div",8)(34,"h3",11),p(35),r(36,"translate"),i(),n(37,"div",12)(38,"div",13)(39,"span"),p(40),i(),n(41,"span"),p(42),r(43,"translate"),i()(),n(44,"div",14),c(45,"div",15),i(),n(46,"div",16),p(47),r(48,"translate"),i()()(),n(49,"div",8)(50,"h3",11),p(51),r(52,"translate"),i(),c(53,"app-table",17),r(54,"translate"),i()()),t&2){let u;e(4),s(d(5,34,"patient.loyalty.walletCard")),e(3),s(P(8,36,a.walletBalance,"USD","","1.2-2")),e(5),s(d(13,41,"patient.loyalty.loyaltyPoints")),e(3),I("",a.loyaltyPoints," pts"),e(3),s(d(19,43,"patient.loyalty.currentTier")),e(3),s(a.currentTier),e(),x(a.refillReminders.length>0?22:-1),e(2),m("label",d(25,45,"patient.loyalty.walletBalance"))("value",(u=P(26,47,a.walletBalance,"USD","","1.2-2"))!==null&&u!==void 0?u:"0.00")("icon",a.walletIcon),e(3),m("label",d(28,52,"patient.loyalty.loyaltyPoints"))("value",a.loyaltyPoints)("icon",a.starIcon),e(2),m("label",d(30,54,"patient.loyalty.currentTier"))("value",a.currentTier)("icon",a.badgeIcon),e(2),m("label",d(32,56,"patient.loyalty.pointsToNextTier"))("value",a.pointsToNextTier)("icon",a.trendIcon),e(4),s(d(36,58,"patient.loyalty.tierProgress")),e(5),s(a.currentTier),e(2),R("",a.loyaltyPoints," / ",a.nextTierPoints," ",d(43,60,"patient.loyalty.points"),""),e(3),Q("width",a.tierProgress,"%"),e(2),R(" ",a.pointsToNextTier," ",d(48,62,"patient.loyalty.pointsUntil")," ",a.nextTier," "),e(4),s(d(52,64,"patient.loyalty.history")),e(2),m("columns",a.columns)("data",a.transactions)("pagination",a.pagination)("emptyMessage",d(54,66,"patient.loyalty.noTransactions"))}},dependencies:[h,B,D,V,me,C],encapsulation:2})};var F=class o{patientId;invoicesService=f(z);totalRevenue=0;avgOrderValue=0;totalOrders=0;lastOrderDate=new Date;moneyIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';chartIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>';ordersIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>';calendarIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>';chartData={labels:[],datasets:[{label:"Revenue",data:[],borderColor:"rgb(75, 192, 192)",backgroundColor:"rgba(75, 192, 192, 0.2)",tension:.1}]};chartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top"},tooltip:{enabled:!0}},scales:{y:{beginAtZero:!0,ticks:{callback:function(l){return l.toFixed(2)}}}}};ngOnInit(){this.loadRevenueData()}loadRevenueData(){this.invoicesService.getAll({page:1,pageSize:100}).subscribe({next:l=>{let t=l.data.filter(g=>g.patientId===this.patientId);if(this.totalOrders=t.length,this.totalRevenue=t.reduce((g,w)=>g+w.total,0),this.avgOrderValue=this.totalOrders>0?this.totalRevenue/this.totalOrders:0,t.length>0){let g=t.sort((w,ee)=>new Date(ee.createdAt).getTime()-new Date(w.createdAt).getTime());this.lastOrderDate=g[0].createdAt}let a=["Jan","Feb","Mar","Apr","May","Jun"],u=a.map((g,w)=>t.filter($=>new Date($.createdAt).getMonth()===w).reduce(($,te)=>$+te.total,0));this.chartData={labels:a,datasets:[{label:"Revenue",data:u,borderColor:"rgb(75, 192, 192)",backgroundColor:"rgba(75, 192, 192, 0.2)",tension:.1}]}}})}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=b({type:o,selectors:[["patient-revenue-tab"]],inputs:{patientId:"patientId"},decls:18,vars:39,consts:[[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[3,"label","value","icon"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-6"],[1,"text-lg","font-semibold","text-[var(--text-primary)]","mb-4"],["type","line",3,"data","options","height"]],template:function(t,a){if(t&1&&(n(0,"div",0)(1,"div",1),c(2,"app-stat-card",2),r(3,"translate"),r(4,"currency"),c(5,"app-stat-card",2),r(6,"translate"),r(7,"currency"),c(8,"app-stat-card",2),r(9,"translate"),c(10,"app-stat-card",2),r(11,"translate"),r(12,"date"),i(),n(13,"div",3)(14,"h3",4),p(15),r(16,"translate"),i(),c(17,"app-chart",5),i()()),t&2){let u,g,w;e(2),m("label",d(3,16,"patient.revenue.totalRevenue"))("value",(u=P(4,18,a.totalRevenue,"USD","","1.2-2"))!==null&&u!==void 0?u:"0.00")("icon",a.moneyIcon),e(3),m("label",d(6,23,"patient.revenue.avgOrderValue"))("value",(g=P(7,25,a.avgOrderValue,"USD","","1.2-2"))!==null&&g!==void 0?g:"0.00")("icon",a.chartIcon),e(3),m("label",d(9,30,"patient.revenue.totalOrders"))("value",a.totalOrders)("icon",a.ordersIcon),e(2),m("label",d(11,32,"patient.revenue.lastOrderDate"))("value",(w=_(12,34,a.lastOrderDate,"shortDate"))!==null&&w!==void 0?w:"-")("icon",a.calendarIcon),e(5),s(d(16,37,"patient.revenue.chartTitle")),e(2),m("data",a.chartData)("options",a.chartOptions)("height",300)}},dependencies:[h,B,j,se,D,C],encapsulation:2})};function Re(o,l){if(o&1&&(n(0,"div")(1,"label",5),p(2),r(3,"translate"),i(),n(4,"div",6)(5,"p",7),p(6),i()()()),o&2){let t=v();e(2),s(d(3,2,"patient.medicalNotes")),e(4),s(t.patient.medicalNotes)}}function je(o,l){o&1&&(n(0,"div",3)(1,"p",4),p(2),r(3,"translate"),i()()),o&2&&(e(2),s(d(3,1,"patient.medical.noNotes")))}var H=class o{patient;static \u0275fac=function(t){return new(t||o)};static \u0275cmp=b({type:o,selectors:[["patient-medical-tab"]],inputs:{patient:"patient"},decls:15,vars:10,consts:[[1,"space-y-6"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-6"],[1,"text-lg","font-semibold","text-[var(--text-primary)]","mb-4"],[1,"text-center","py-12"],[1,"text-[var(--card-text)]"],[1,"block","text-sm","font-medium","text-[var(--card-text)]","mb-2"],[1,"bg-[var(--page-bg)]","rounded-[var(--radius-md)]","p-4"],[1,"text-[var(--text-primary)]","whitespace-pre-wrap"]],template:function(t,a){t&1&&(n(0,"div",0)(1,"div",1)(2,"h2",2),p(3),r(4,"translate"),i(),y(5,Re,7,4,"div")(6,je,4,3,"div",3),i(),n(7,"div",1)(8,"h3",2),p(9),r(10,"translate"),i(),n(11,"div",3)(12,"p",4),p(13),r(14,"translate"),i()()()()),t&2&&(e(3),s(d(4,4,"patient.medicalInfo")),e(2),x(a.patient.medicalNotes?5:6),e(4),s(d(10,6,"patient.medical.additionalInfo")),e(4),s(d(14,8,"patient.medical.comingSoon")))},dependencies:[h,C],encapsulation:2})};var G=class o{patientId;engagementEngine=f(M);timelineEvents=[];ngOnInit(){this.loadTimeline()}loadTimeline(){this.engagementEngine.getPatientTimeline(this.patientId).subscribe({next:l=>{this.timelineEvents=l}})}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=b({type:o,selectors:[["patient-timeline-tab"]],inputs:{patientId:"patientId"},decls:2,vars:2,consts:[[1,"space-y-6"],[3,"events","emptyMessage"]],template:function(t,a){t&1&&(n(0,"div",0),c(1,"app-timeline",1),i()),t&2&&(e(),m("events",a.timelineEvents)("emptyMessage","timeline.empty"))},dependencies:[h,fe],encapsulation:2})};function Ne(o,l){if(o&1&&c(0,"app-alert",1),o&2){let t=v();m("title",t.errorMessage)}}function Ve(o,l){if(o&1){let t=re();n(0,"div",2)(1,"div",4)(2,"h1",5),p(3),r(4,"translate"),i(),n(5,"div",6)(6,"app-button",7),O("onClick",function(){q(t);let u=v();return Y(u.editPatient())}),Z(),n(7,"svg",8),c(8,"path",9),i(),p(9),r(10,"translate"),i(),K(),n(11,"app-button",7),O("onClick",function(){q(t);let u=v();return Y(u.goBack())}),Z(),n(12,"svg",8),c(13,"path",10),i(),p(14),r(15,"translate"),i()()(),K(),n(16,"app-tabs")(17,"app-tab",11),r(18,"translate"),c(19,"patient-overview-tab",12),i(),n(20,"app-tab",11),r(21,"translate"),c(22,"patient-orders-tab",13),i(),n(23,"app-tab",11),r(24,"translate"),c(25,"patient-loyalty-tab",13),i(),n(26,"app-tab",11),r(27,"translate"),c(28,"patient-revenue-tab",13),i(),n(29,"app-tab",11),r(30,"translate"),c(31,"patient-medical-tab",12),i(),n(32,"app-tab",11),r(33,"translate"),c(34,"patient-timeline-tab",13),i()()()}if(o&2){let t=v();e(3),s(d(4,21,"patient.details")),e(6),I(" ",d(10,23,"common.edit")," "),e(5),I(" ",d(15,25,"common.back")," "),e(3),m("title",d(18,27,"patient.tabs.overview"))("active",!0),e(2),m("patient",t.patient),e(),m("title",d(21,29,"patient.tabs.orders"))("active",!1),e(2),m("patientId",t.patient.id),e(),m("title",d(24,31,"patient.tabs.loyalty"))("active",!1),e(2),m("patientId",t.patient.id),e(),m("title",d(27,33,"patient.tabs.revenue"))("active",!1),e(2),m("patientId",t.patient.id),e(),m("title",d(30,35,"patient.tabs.medical"))("active",!1),e(2),m("patient",t.patient),e(),m("title",d(33,37,"patient.tabs.timeline"))("active",!1),e(2),m("patientId",t.patient.id)}}function ze(o,l){o&1&&(n(0,"div",3)(1,"p",14),p(2,"Loading patient details..."),i()())}var be=class o{route=f(le);router=f(pe);patientsService=f(ve);patient=null;loading=!0;errorMessage="";ngOnInit(){let l=this.route.snapshot.paramMap.get("id");l?this.loadPatient(l):(this.errorMessage="Patient ID is required",this.loading=!1)}loadPatient(l){this.loading=!0,this.errorMessage="",this.patientsService.getById(l).subscribe({next:t=>{this.patient=t,this.loading=!1,t||(this.errorMessage="Patient not found")},error:t=>{this.errorMessage="Failed to load patient details",this.loading=!1,console.error("Error loading patient:",t)}})}editPatient(){this.patient&&this.router.navigate(["/patients",this.patient.id,"edit"])}goBack(){this.router.navigate(["/patients"])}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=b({type:o,selectors:[["app-patient-detail"]],decls:4,vars:2,consts:[[1,"space-y-[var(--spacing-gap)]"],["type","error",3,"title"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-[var(--spacing-card)]"],[1,"text-center","py-12"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-[var(--text-primary)]"],[1,"flex","gap-3"],["variant","outline",3,"onClick"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","inline","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[3,"title","active"],[3,"patient"],[3,"patientId"],[1,"text-[var(--card-text)]"]],template:function(t,a){t&1&&(n(0,"div",0),y(1,Ne,1,1,"app-alert",1)(2,Ve,35,39,"div",2)(3,ze,3,0,"div",3),i()),t&2&&(e(),x(a.errorMessage?1:-1),e(),x(a.patient?2:a.loading?3:-1))},dependencies:[h,ce,de,C,ge,ue,L,A,U,F,H,G],encapsulation:2})};export{be as PatientDetailComponent};
