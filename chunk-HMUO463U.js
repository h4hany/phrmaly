import{a as ge}from"./chunk-HZMAO6XJ.js";import{a as ee,c as te,d as _,e as ie,f as ne,h as ae,j as le,m as oe,n as re,o as pe,p as se,t as de,v as ue}from"./chunk-NWB6AJFO.js";import{a as he}from"./chunk-XHZERUE7.js";import{a as ve}from"./chunk-7YIMD4Q6.js";import{a as me}from"./chunk-WY32ECM4.js";import{a as ce,b as fe}from"./chunk-XBZAXIUZ.js";import{b as J,d as X}from"./chunk-VPFLKGZN.js";import"./chunk-CYRIZKVF.js";import{$a as c,Ea as q,Ja as v,Kb as Y,Pa as h,R as x,Ra as b,Ta as H,Ua as g,Wb as z,X as S,Xa as K,Y as F,Ya as U,Za as a,_a as n,bb as L,cb as y,db as E,hb as $,ib as Q,jb as j,ka as w,lb as r,mb as u,nb as f,va as Z,vb as W,wa as i,yb as p,zb as s}from"./chunk-W6WRXJJ4.js";import"./chunk-7CGTOI24.js";var Ce=["input"],xe=["container"],Ee=(l,e)=>e.value;function Se(l,e){if(l&1){let o=L();a(0,"button",6),y("mousedown",function(){let d=S(o).$implicit,m=E(2);return F(m.selectOption(d))}),r(1),n()}if(l&2){let o=e.$implicit,t=E(2);H(t.getOptionClasses(o.value)),i(),f(" ",o.label," ")}}function Fe(l,e){if(l&1&&(a(0,"div",4),K(1,Se,2,3,"button",5,Ee),n()),l&2){let o=E();i(),U(o.filteredOptions())}}var G=class l{options=[];placeholder="Type to search...";disabled=!1;allowCustom=!0;hasError=!1;inputRef;containerRef;value=w("");displayValue=w("");isOpen=w(!1);filteredOptions=w([]);onChange=e=>{};onTouched=()=>{};constructor(){Y(()=>{let e=this.value();if(e){let o=this.options.find(t=>t.value===e);this.displayValue.set(o?.label||e)}else this.displayValue.set("")})}onClickOutside(e){this.containerRef&&!this.containerRef.nativeElement.contains(e.target)&&this.isOpen.set(!1)}onInput(e){let t=e.target.value;if(this.displayValue.set(t),t){let d=this.options.filter(m=>m.label.toLowerCase().includes(t.toLowerCase()));this.filteredOptions.set(d),this.isOpen.set(!0)}else this.filteredOptions.set(this.options),this.isOpen.set(!0);this.allowCustom&&(this.value.set(t),this.onChange(t))}onFocus(){this.disabled||(this.filteredOptions.set(this.options),this.isOpen.set(!0))}onBlur(){setTimeout(()=>{this.isOpen.set(!1),this.onTouched()},200)}selectOption(e){this.value.set(e.value),this.displayValue.set(e.label),this.isOpen.set(!1),this.onChange(e.value),this.onTouched()}get inputClasses(){let e="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#166534] focus:border-[#166534] text-sm";return this.disabled?`${e} opacity-50 cursor-not-allowed bg-gray-100`:e}getOptionClasses(e){let o="block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 cursor-pointer";return e===this.value()?`${o} bg-[var(--primary-color)]/10 text-[var(--primary-color)] font-medium`:`${o} text-gray-900`}writeValue(e){this.value.set(e||"")}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e}static \u0275fac=function(o){return new(o||l)};static \u0275cmp=q({type:l,selectors:[["app-autocomplete"]],viewQuery:function(o,t){if(o&1&&($(Ce,5),$(xe,5)),o&2){let d;Q(d=j())&&(t.inputRef=d.first),Q(d=j())&&(t.containerRef=d.first)}},hostBindings:function(o,t){o&1&&y("click",function(m){return t.onClickOutside(m)},!1,Z)},inputs:{options:"options",placeholder:"placeholder",disabled:"disabled",allowCustom:"allowCustom",hasError:"hasError"},features:[W([{provide:ee,useExisting:l,multi:!0}])],decls:5,vars:8,consts:[["container",""],["input",""],[1,"relative"],["type","text",3,"input","focus","blur","value","placeholder","disabled"],[1,"absolute","z-10","mt-1","w-full","bg-white","shadow-lg","max-h-60","rounded-[var(--radius-md)]","py-1","text-base","ring-1","ring-black","ring-opacity-5","overflow-auto","focus:outline-none"],["type","button",3,"class"],["type","button",3,"mousedown"]],template:function(o,t){if(o&1){let d=L();a(0,"div",2,0)(2,"input",3,1),y("input",function(C){return S(d),F(t.onInput(C))})("focus",function(){return S(d),F(t.onFocus())})("blur",function(){return S(d),F(t.onBlur())}),n(),v(4,Fe,3,0,"div",4),n()}o&2&&(i(2),H(t.inputClasses),b("border-red-500",t.hasError),h("value",t.displayValue())("placeholder",t.placeholder)("disabled",t.disabled),i(2),g(t.isOpen()&&t.filteredOptions().length>0?4:-1))},dependencies:[z],encapsulation:2})};function we(l,e){if(l&1&&c(0,"app-alert",1),l&2){let o=E();h("title",o.errorMessage)}}function Oe(l,e){l&1&&(a(0,"p",7),r(1),p(2,"translate"),n()),l&2&&(i(),u(s(2,1,"validation.fullNameRequired")))}function Ne(l,e){l&1&&(a(0,"p",7),r(1),p(2,"translate"),n()),l&2&&(i(),u(s(2,1,"validation.dateOfBirthRequired")))}function Be(l,e){l&1&&(a(0,"p",7),r(1),p(2,"translate"),n()),l&2&&(i(),u(s(2,1,"validation.genderRequired")))}function Ie(l,e){l&1&&(a(0,"p",7),r(1),p(2,"translate"),n()),l&2&&(i(),u(s(2,1,"validation.phoneRequired")))}function Ae(l,e){l&1&&(a(0,"p",7),r(1),p(2,"translate"),n()),l&2&&(i(),u(s(2,1,"validation.emailInvalid")))}function Te(l,e){l&1&&(a(0,"p",7),r(1),p(2,"translate"),n()),l&2&&(i(),u(s(2,1,"validation.cityRequired")))}function Pe(l,e){l&1&&(a(0,"p",7),r(1),p(2,"translate"),n()),l&2&&(i(),u(s(2,1,"validation.areaRequired")))}var be=class l{fb=x(de);router=x(X);route=x(J);patientsService=x(he);translationService=x(ce);translate(e){return this.translationService.translate(e)}patientForm;loading=!1;errorMessage="";isEdit=!1;patientId=null;occupationOptions=[{value:"doctor",label:"Doctor"},{value:"engineer",label:"Engineer"},{value:"teacher",label:"Teacher"},{value:"nurse",label:"Nurse"},{value:"accountant",label:"Accountant"},{value:"lawyer",label:"Lawyer"},{value:"architect",label:"Architect"},{value:"pharmacist",label:"Pharmacist"},{value:"dentist",label:"Dentist"},{value:"manager",label:"Manager"},{value:"student",label:"Student"},{value:"retired",label:"Retired"},{value:"business_owner",label:"Business Owner"},{value:"government_employee",label:"Government Employee"},{value:"private_employee",label:"Private Employee"}];cityOptions=[{value:"cairo",label:"Cairo"},{value:"alexandria",label:"Alexandria"},{value:"giza",label:"Giza"},{value:"shubra_el_kheima",label:"Shubra El Kheima"},{value:"port_said",label:"Port Said"},{value:"suez",label:"Suez"},{value:"luxor",label:"Luxor"},{value:"aswan",label:"Aswan"},{value:"mansoura",label:"Mansoura"},{value:"tanta",label:"Tanta"},{value:"ismailia",label:"Ismailia"},{value:"assiut",label:"Assiut"},{value:"zagazig",label:"Zagazig"},{value:"damanhur",label:"Damanhur"},{value:"minya",label:"Minya"}];areaOptions=[{value:"nasr_city",label:"Nasr City"},{value:"maadi",label:"Maadi"},{value:"zamalek",label:"Zamalek"},{value:"heliopolis",label:"Heliopolis"},{value:"downtown",label:"Downtown"},{value:"new_cairo",label:"New Cairo"},{value:"6_october",label:"6th October"},{value:"sheikh_zayed",label:"Sheikh Zayed"},{value:"al_rehab",label:"Al Rehab"},{value:"madinet_nasr",label:"Madinet Nasr"},{value:"shubra",label:"Shubra"},{value:"abbassia",label:"Abbassia"},{value:"ain_shams",label:"Ain Shams"},{value:"mokattam",label:"Mokattam"},{value:"new_helipolis",label:"New Heliopolis"}];ngOnInit(){this.patientId=this.route.snapshot.paramMap.get("id"),this.isEdit=!!this.patientId,this.patientForm=this.fb.group({fullName:["",[_.required]],dateOfBirth:["",[_.required]],gender:["",[_.required]],phone:["",[_.required]],email:["",[_.email]],occupation:[""],city:["",[_.required]],area:["",[_.required]],street:["",[_.required]],addressNotes:[""],medicalNotes:[""]}),this.isEdit&&this.patientId&&this.loadPatient()}loadPatient(){this.patientsService.getById(this.patientId).subscribe({next:e=>{e&&this.patientForm.patchValue({fullName:e.fullName,dateOfBirth:this.formatDateForInput(e.dateOfBirth),gender:e.gender,phone:e.phone,email:e.email||"",occupation:e.occupation||"",city:e.address.city,area:e.address.area,street:e.address.street,addressNotes:e.address.notes||"",medicalNotes:e.medicalNotes||""})},error:e=>{this.errorMessage=this.translate("error.loadPatient")}})}onSubmit(){if(this.patientForm.valid){this.loading=!0,this.errorMessage="";let e=this.patientForm.value,o={fullName:e.fullName,dateOfBirth:new Date(e.dateOfBirth),gender:e.gender,phone:e.phone,email:e.email||void 0,occupation:e.occupation||void 0,address:{city:e.city,area:e.area,street:e.street,notes:e.addressNotes||void 0},medicalNotes:e.medicalNotes||void 0};(this.isEdit?this.patientsService.update(this.patientId,o):this.patientsService.create(o)).subscribe({next:()=>{this.router.navigate(["/patients"])},error:d=>{this.errorMessage=d.message||this.translate("error.savePatient"),this.loading=!1}})}else Object.keys(this.patientForm.controls).forEach(e=>{this.patientForm.get(e)?.markAsTouched()})}onCancel(){this.router.navigate(["/patients"])}formatDateForInput(e){let o=new Date(e),t=o.getFullYear(),d=String(o.getMonth()+1).padStart(2,"0"),m=String(o.getDate()).padStart(2,"0");return`${t}-${d}-${m}`}static \u0275fac=function(o){return new(o||l)};static \u0275cmp=q({type:l,selectors:[["app-patient-form"]],decls:113,vars:103,consts:[[3,"title"],["type","error",3,"title"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],[1,"text-red-500"],["type","text","formControlName","fullName",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]"],[1,"mt-1","text-sm","text-red-600"],["type","date","formControlName","dateOfBirth",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]"],["formControlName","gender",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]"],["value",""],["value","male"],["value","female"],["value","other"],["type","tel","formControlName","phone",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]"],["type","email","formControlName","email",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]"],["formControlName","occupation",3,"options","placeholder","allowCustom"],[1,"border-t","pt-6"],[1,"text-lg","font-medium","text-gray-900","mb-4"],["formControlName","city",3,"options","placeholder","allowCustom","hasError"],["formControlName","area",3,"options","placeholder","allowCustom","hasError"],[1,"md:col-span-2"],["type","text","formControlName","street",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]"],["formControlName","addressNotes","rows","3",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]"],["formControlName","medicalNotes","rows","4",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]",3,"placeholder"],[1,"flex","items-center","justify-end","gap-4","pt-6","border-t"],["type","button","variant","outline",3,"onClick"],["type","submit","variant","primary",3,"loading","disabled"]],template:function(o,t){if(o&1&&(a(0,"app-form-wrapper",0),p(1,"translate"),v(2,we,1,1,"app-alert",1),a(3,"form",2),y("ngSubmit",function(){return t.onSubmit()}),a(4,"div",3)(5,"div")(6,"label",4),r(7),p(8,"translate"),a(9,"span",5),r(10,"*"),n()(),c(11,"input",6),v(12,Oe,3,3,"p",7),n(),a(13,"div")(14,"label",4),r(15),p(16,"translate"),a(17,"span",5),r(18,"*"),n()(),c(19,"input",8),v(20,Ne,3,3,"p",7),n(),a(21,"div")(22,"label",4),r(23),p(24,"translate"),a(25,"span",5),r(26,"*"),n()(),a(27,"select",9)(28,"option",10),r(29),p(30,"translate"),n(),a(31,"option",11),r(32),p(33,"translate"),n(),a(34,"option",12),r(35),p(36,"translate"),n(),a(37,"option",13),r(38),p(39,"translate"),n()(),v(40,Be,3,3,"p",7),n(),a(41,"div")(42,"label",4),r(43),p(44,"translate"),a(45,"span",5),r(46,"*"),n()(),c(47,"input",14),v(48,Ie,3,3,"p",7),n(),a(49,"div")(50,"label",4),r(51),p(52,"translate"),n(),c(53,"input",15),v(54,Ae,3,3,"p",7),n(),a(55,"div")(56,"label",4),r(57),p(58,"translate"),n(),c(59,"app-autocomplete",16),p(60,"translate"),n()(),a(61,"div",17)(62,"h3",18),r(63),p(64,"translate"),n(),a(65,"div",3)(66,"div")(67,"label",4),r(68),p(69,"translate"),a(70,"span",5),r(71,"*"),n()(),c(72,"app-autocomplete",19),p(73,"translate"),v(74,Te,3,3,"p",7),n(),a(75,"div")(76,"label",4),r(77),p(78,"translate"),a(79,"span",5),r(80,"*"),n()(),c(81,"app-autocomplete",20),p(82,"translate"),v(83,Pe,3,3,"p",7),n(),a(84,"div",21)(85,"label",4),r(86),p(87,"translate"),a(88,"span",5),r(89,"*"),n()(),c(90,"input",22),n(),a(91,"div",21)(92,"label",4),r(93),p(94,"translate"),n(),c(95,"textarea",23),n()()(),a(96,"div",17)(97,"h3",18),r(98),p(99,"translate"),n(),a(100,"div")(101,"label",4),r(102),p(103,"translate"),n(),c(104,"textarea",24),p(105,"translate"),n()(),a(106,"div",25)(107,"app-button",26),y("onClick",function(){return t.onCancel()}),r(108),p(109,"translate"),n(),a(110,"app-button",27),r(111),p(112,"translate"),n()()()()),o&2){let d,m,C,O,N,B,I,A,T,P,V,M,R,D,k;h("title",s(1,55,t.isEdit?"form.editPatient":"form.addPatient")),i(2),g(t.errorMessage?2:-1),i(),h("formGroup",t.patientForm),i(4),f(" ",s(8,57,"patient.fullName")," "),i(4),b("border-red-500",((d=t.patientForm.get("fullName"))==null?null:d.invalid)&&((d=t.patientForm.get("fullName"))==null?null:d.touched)),i(),g((m=t.patientForm.get("fullName"))!=null&&m.invalid&&((m=t.patientForm.get("fullName"))!=null&&m.touched)?12:-1),i(3),f(" ",s(16,59,"patient.dateOfBirth")," "),i(4),b("border-red-500",((C=t.patientForm.get("dateOfBirth"))==null?null:C.invalid)&&((C=t.patientForm.get("dateOfBirth"))==null?null:C.touched)),i(),g((O=t.patientForm.get("dateOfBirth"))!=null&&O.invalid&&((O=t.patientForm.get("dateOfBirth"))!=null&&O.touched)?20:-1),i(3),f(" ",s(24,61,"patient.gender")," "),i(4),b("border-red-500",((N=t.patientForm.get("gender"))==null?null:N.invalid)&&((N=t.patientForm.get("gender"))==null?null:N.touched)),i(2),u(s(30,63,"form.selectGender")),i(3),u(s(33,65,"form.gender.male")),i(3),u(s(36,67,"form.gender.female")),i(3),u(s(39,69,"form.gender.other")),i(2),g((B=t.patientForm.get("gender"))!=null&&B.invalid&&((B=t.patientForm.get("gender"))!=null&&B.touched)?40:-1),i(3),f(" ",s(44,71,"patient.phone")," "),i(4),b("border-red-500",((I=t.patientForm.get("phone"))==null?null:I.invalid)&&((I=t.patientForm.get("phone"))==null?null:I.touched)),i(),g((A=t.patientForm.get("phone"))!=null&&A.invalid&&((A=t.patientForm.get("phone"))!=null&&A.touched)?48:-1),i(3),u(s(52,73,"patient.email")),i(2),b("border-red-500",((T=t.patientForm.get("email"))==null?null:T.invalid)&&((T=t.patientForm.get("email"))==null?null:T.touched)),i(),g((P=t.patientForm.get("email"))!=null&&P.invalid&&((P=t.patientForm.get("email"))!=null&&P.touched)?54:-1),i(3),u(s(58,75,"patient.occupation")),i(2),h("options",t.occupationOptions)("placeholder",s(60,77,"form.selectOrType"))("allowCustom",!0),i(4),u(s(64,79,"patient.addressInfo")),i(5),f(" ",s(69,81,"patient.city")," "),i(4),h("options",t.cityOptions)("placeholder",s(73,83,"form.selectOrType"))("allowCustom",!0)("hasError",!!((V=t.patientForm.get("city"))!=null&&V.invalid&&((V=t.patientForm.get("city"))!=null&&V.touched))),i(2),g((M=t.patientForm.get("city"))!=null&&M.invalid&&((M=t.patientForm.get("city"))!=null&&M.touched)?74:-1),i(3),f(" ",s(78,85,"patient.area")," "),i(4),h("options",t.areaOptions)("placeholder",s(82,87,"form.selectOrType"))("allowCustom",!0)("hasError",!!((R=t.patientForm.get("area"))!=null&&R.invalid&&((R=t.patientForm.get("area"))!=null&&R.touched))),i(2),g((D=t.patientForm.get("area"))!=null&&D.invalid&&((D=t.patientForm.get("area"))!=null&&D.touched)?83:-1),i(3),f(" ",s(87,89,"patient.street")," "),i(4),b("border-red-500",((k=t.patientForm.get("street"))==null?null:k.invalid)&&((k=t.patientForm.get("street"))==null?null:k.touched)),i(3),u(s(94,91,"patient.notes")),i(5),u(s(99,93,"patient.medicalInfo")),i(4),u(s(103,95,"patient.medicalNotes")),i(2),h("placeholder",s(105,97,"placeholder.medicalNotes")),i(4),f(" ",s(109,99,"common.cancel")," "),i(2),h("loading",t.loading)("disabled",t.patientForm.invalid),i(),f(" ",s(112,101,t.isEdit?"form.updatePatient":"form.createPatient")," ")}},dependencies:[z,ue,ae,pe,se,te,re,ie,ne,le,oe,ge,ve,me,fe,G],encapsulation:2})};export{be as PatientFormComponent};
