import{b as _,d as D,f as S,m as w,n as x,o as M,t as T}from"./chunk-TAU7SGZY.js";import{a as P}from"./chunk-SRZA4AYF.js";import"./chunk-PRIAQIJ7.js";import{a as L}from"./chunk-L2QHXWDV.js";import{b as I}from"./chunk-EO5VULWO.js";import"./chunk-TXY55LQM.js";import{Ea as C,Pa as h,Vb as b,Za as i,_a as n,cb as f,lb as o,mb as y,nb as m,sb as g,tb as u,ub as c,wa as l,yb as s,zb as d}from"./chunk-F5WAPTHD.js";import"./chunk-7CGTOI24.js";var E=class v{loading=!1;filters={entityType:"",user:"",action:"",fromDate:"",toDate:""};allLogs=[{id:"1",timestamp:new Date("2024-11-27T10:30:00"),user:"John Doe",action:"Updated",entity:"Patient",entityId:"PAT001",details:"Updated phone number"},{id:"2",timestamp:new Date("2024-11-27T09:15:00"),user:"Jane Smith",action:"Created",entity:"Invoice",entityId:"INV001",details:"Created new invoice"},{id:"3",timestamp:new Date("2024-11-26T14:20:00"),user:"John Doe",action:"Deleted",entity:"Drug",entityId:"DRG001",details:"Deleted drug"},{id:"4",timestamp:new Date("2024-11-26T11:45:00"),user:"Jane Smith",action:"Viewed",entity:"Patient",entityId:"PAT002",details:"Viewed patient profile"},{id:"5",timestamp:new Date("2024-11-25T16:30:00"),user:"John Doe",action:"Created",entity:"Purchase",entityId:"PUR001",details:"Created purchase invoice"}];filteredLogs=[];pagination={page:1,pageSize:10,total:0,totalPages:0};columns=[{key:"timestamp",label:"patient.audit.timestamp",sortable:!0},{key:"user",label:"patient.audit.user",sortable:!0},{key:"action",label:"patient.audit.action",sortable:!0},{key:"entity",label:"patient.audit.entity",sortable:!0},{key:"entityId",label:"patient.audit.entityId",sortable:!1}];ngOnInit(){this.applyFilters()}applyFilters(){this.loading=!0;let r=[...this.allLogs];if(this.filters.entityType&&(r=r.filter(a=>a.entity===this.filters.entityType)),this.filters.user&&(r=r.filter(a=>a.user.toLowerCase().includes(this.filters.user.toLowerCase()))),this.filters.action&&(r=r.filter(a=>a.action===this.filters.action)),this.filters.fromDate){let a=new Date(this.filters.fromDate);r=r.filter(e=>e.timestamp>=a)}if(this.filters.toDate){let a=new Date(this.filters.toDate);a.setHours(23,59,59,999),r=r.filter(e=>e.timestamp<=a)}let p=(this.pagination.page-1)*this.pagination.pageSize,t=p+this.pagination.pageSize;this.filteredLogs=r.slice(p,t),this.pagination.total=r.length,this.pagination.totalPages=Math.ceil(r.length/this.pagination.pageSize),this.loading=!1}clearFilters(){this.filters={entityType:"",user:"",action:"",fromDate:"",toDate:""},this.pagination.page=1,this.applyFilters()}onPageChange(r){this.pagination.page=r,this.applyFilters()}static \u0275fac=function(p){return new(p||v)};static \u0275cmp=C({type:v,selectors:[["app-audit-logs"]],decls:62,vars:42,consts:[[1,"space-y-[var(--spacing-gap)]"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-[var(--spacing-card)]"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-[var(--text-primary)]"],[1,"bg-[var(--page-bg)]","rounded-[var(--radius-md)]","p-4","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"block","text-sm","font-medium","text-[var(--card-text)]","mb-1"],[1,"w-full","px-4","py-2","border","border-[var(--border-color)]","rounded-[var(--radius-md)]","text-sm","bg-[var(--card-bg)]","text-[var(--text-primary)]","focus:outline-none","focus:ring-2","focus:ring-[var(--primary-color)]",3,"ngModelChange","ngModel"],["value",""],["value","Patient"],["value","Invoice"],["value","Drug"],["value","Purchase"],["type","text",1,"w-full","px-4","py-2","border","border-[var(--border-color)]","rounded-[var(--radius-md)]","text-sm","bg-[var(--card-bg)]","text-[var(--text-primary)]","focus:outline-none","focus:ring-2","focus:ring-[var(--primary-color)]",3,"ngModelChange","ngModel","placeholder"],["value","Created"],["value","Updated"],["value","Deleted"],["value","Viewed"],[1,"flex","gap-2"],["type","date",1,"flex-1","px-4","py-2","border","border-[var(--border-color)]","rounded-[var(--radius-md)]","text-sm","bg-[var(--card-bg)]","text-[var(--text-primary)]","focus:outline-none","focus:ring-2","focus:ring-[var(--primary-color)]",3,"ngModelChange","ngModel"],[1,"flex","gap-3","mt-4"],["variant","primary","size","sm",3,"onClick"],["variant","outline","size","sm",3,"onClick"],[3,"onPageChange","columns","data","pagination","loading","emptyMessage"]],template:function(p,t){p&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),o(4),s(5,"translate"),n()(),i(6,"div",4)(7,"div",5)(8,"div")(9,"label",6),o(10),s(11,"translate"),n(),i(12,"select",7),c("ngModelChange",function(e){return u(t.filters.entityType,e)||(t.filters.entityType=e),e}),i(13,"option",8),o(14),s(15,"translate"),n(),i(16,"option",9),o(17,"Patient"),n(),i(18,"option",10),o(19,"Invoice"),n(),i(20,"option",11),o(21,"Drug"),n(),i(22,"option",12),o(23,"Purchase"),n()()(),i(24,"div")(25,"label",6),o(26),s(27,"translate"),n(),i(28,"input",13),s(29,"translate"),c("ngModelChange",function(e){return u(t.filters.user,e)||(t.filters.user=e),e}),n()(),i(30,"div")(31,"label",6),o(32),s(33,"translate"),n(),i(34,"select",7),c("ngModelChange",function(e){return u(t.filters.action,e)||(t.filters.action=e),e}),i(35,"option",8),o(36),s(37,"translate"),n(),i(38,"option",14),o(39,"Created"),n(),i(40,"option",15),o(41,"Updated"),n(),i(42,"option",16),o(43,"Deleted"),n(),i(44,"option",17),o(45,"Viewed"),n()()(),i(46,"div")(47,"label",6),o(48),s(49,"translate"),n(),i(50,"div",18)(51,"input",19),c("ngModelChange",function(e){return u(t.filters.fromDate,e)||(t.filters.fromDate=e),e}),n(),i(52,"input",19),c("ngModelChange",function(e){return u(t.filters.toDate,e)||(t.filters.toDate=e),e}),n()()()(),i(53,"div",20)(54,"app-button",21),f("onClick",function(){return t.applyFilters()}),o(55),s(56,"translate"),n(),i(57,"app-button",22),f("onClick",function(){return t.clearFilters()}),o(58),s(59,"translate"),n()()(),i(60,"app-table",23),s(61,"translate"),f("onPageChange",function(e){return t.onPageChange(e)}),n()()()),p&2&&(l(4),y(d(5,20,"audit.title")),l(6),m(" ",d(11,22,"audit.entityType")," "),l(2),g("ngModel",t.filters.entityType),l(2),y(d(15,24,"common.all")),l(12),m(" ",d(27,26,"audit.user")," "),l(2),g("ngModel",t.filters.user),h("placeholder",d(29,28,"common.search")),l(4),m(" ",d(33,30,"audit.action")," "),l(2),g("ngModel",t.filters.action),l(2),y(d(37,32,"common.all")),l(12),m(" ",d(49,34,"audit.dateRange")," "),l(3),g("ngModel",t.filters.fromDate),l(),g("ngModel",t.filters.toDate),l(3),m(" ",d(56,36,"audit.applyFilters")," "),l(3),m(" ",d(59,38,"audit.clearFilters")," "),l(2),h("columns",t.columns)("data",t.filteredLogs)("pagination",t.pagination)("loading",t.loading)("emptyMessage",d(61,40,"audit.noLogs")))},dependencies:[b,T,x,M,_,w,D,S,P,L,I],encapsulation:2})};export{E as AuditLogsComponent};
