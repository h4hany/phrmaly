import{a as D,b as x}from"./chunk-IVMEOUAV.js";import{a as T}from"./chunk-THCZEFPZ.js";import"./chunk-P5TE6FOK.js";import"./chunk-N3GUYB4W.js";import"./chunk-YJWIIGXE.js";import{a as S}from"./chunk-YUKQXM5O.js";import"./chunk-M3W4QUEG.js";import"./chunk-BYXBJQAS.js";import"./chunk-QHH3SHC3.js";import{b as R}from"./chunk-7DC7YEPQ.js";import{$a as a,$b as I,A as n,Bb as c,Cb as d,Ga as C,M as h,Ra as p,S as m,ab as l,bb as b,j as o,nb as P,ob as g,xa as r}from"./chunk-OKFD3A6M.js";import{a as u,b as f}from"./chunk-KAT7YFEL.js";var y=class t{pharmacyContextService=m(S);roles=[{id:"role1",pharmacyId:"ph1",name:"Pharmacist",description:"Full access to all operations",permissions:[],isSystemRole:!0,createdAt:new Date,createdBy:"system"},{id:"role2",pharmacyId:"ph1",name:"Cashier",description:"Sales and payment operations",permissions:[],isSystemRole:!1,createdAt:new Date,createdBy:"admin"}];getRoles(){let i=this.pharmacyContextService.getCurrentPharmacy()?.id;if(!i)return o([]).pipe(n(300));let e=this.roles.filter(s=>s.pharmacyId===i);return o(e).pipe(n(300))}hasPermission(i,e){return o(!0).pipe(n(100))}getPermissionsForRole(i){let e=this.pharmacyContextService.getCurrentPharmacy()?.id;if(!e)return o([]).pipe(n(300));let s=this.roles.find(v=>v.id===i&&v.pharmacyId===e);return o(s?.permissions||[]).pipe(n(300))}static \u0275fac=function(e){return new(e||t)};static \u0275prov=h({token:t,factory:t.\u0275fac,providedIn:"root"})};var k=class t{permissionEngine=m(y);roles=[];permissions=[];roleColumns=[{key:"name",label:"permissions.roleName"},{key:"description",label:"permissions.description"},{key:"permissionCount",label:"permissions.permissionCount"}];permissionColumns=[{key:"roleName",label:"permissions.role"},{key:"resource",label:"permissions.resource"},{key:"actionsDisplay",label:"permissions.actions"}];ngOnInit(){this.loadData()}loadData(){this.permissionEngine.getRoles().subscribe({next:i=>{this.roles=i.map(e=>f(u({},e),{permissionCount:e.permissions.length})),this.permissions=i.flatMap(e=>e.permissions.map(s=>f(u({},s),{roleName:e.name,actionsDisplay:s.actions.join(", ")})))}})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=C({type:t,selectors:[["app-permissions"]],decls:13,vars:17,consts:[[1,"space-y-6"],[1,"text-2xl","font-bold"],[3,"title","active"],[1,"p-6"],[3,"columns","data","emptyMessage"]],template:function(e,s){e&1&&(a(0,"div",0)(1,"h2",1),P(2),c(3,"translate"),l(),a(4,"app-tabs")(5,"app-tab",2),c(6,"translate"),a(7,"div",3),b(8,"app-table",4),l()(),a(9,"app-tab",2),c(10,"translate"),a(11,"div",3),b(12,"app-table",4),l()()()()),e&2&&(r(2),g(d(3,11,"permissions.title")),r(3),p("title",d(6,13,"permissions.roles"))("active",!0),r(3),p("columns",s.roleColumns)("data",s.roles)("emptyMessage","permissions.noRoles"),r(),p("title",d(10,15,"permissions.permissions"))("active",!1),r(3),p("columns",s.permissionColumns)("data",s.permissions)("emptyMessage","permissions.noPermissions"))},dependencies:[I,T,x,D,R],encapsulation:2})};export{k as PermissionsComponent};
