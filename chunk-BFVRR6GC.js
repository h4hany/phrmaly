import{a as W}from"./chunk-FF46ICM6.js";import{a as N}from"./chunk-ONVEZIWC.js";import{a as P,b as j}from"./chunk-7YN2F2UA.js";import{d as F}from"./chunk-J2A4D5WT.js";import{Ab as M,Da as B,Ia as v,Oa as _,Q as x,Sa as A,Ta as u,Ub as V,W as y,Wa as S,Wb as $,X as f,Xa as h,Y as E,Ya as t,Za as i,_a as I,ab as D,bb as C,cb as s,kb as a,lb as o,mb as w,nb as b,va as e,yb as p,zb as d}from"./chunk-ILVQMZIM.js";import{a as T,b as k}from"./chunk-7CGTOI24.js";var z=(l,r)=>r.id;function G(l,r){if(l&1){let n=D();t(0,"tr",14)(1,"td",15),a(2),i(),t(3,"td",16),a(4),i(),t(5,"td",15)(6,"span",17),a(7),i()(),t(8,"td",15),a(9),i(),t(10,"td",15),a(11),i(),t(12,"td",18)(13,"button",19),p(14,"translate"),C("click",function(){let c=y(n).$implicit,g=s(2);return f(g.viewDrug(c.id))}),E(),t(15,"svg",20),I(16,"path",21)(17,"path",22),i()()()()}if(l&2){let n=r.$implicit;e(2),o((n.generalDrug==null?null:n.generalDrug.name)||"N/A"),e(2),o(n.internalBarcode),e(3),o(n.stockQuantity),e(2),o(n.minimumStock),e(2),o(n.price),e(2),_("title",d(14,6,"common.view"))}}function Q(l,r){if(l&1&&(t(0,"div",6)(1,"table",9)(2,"thead",10)(3,"tr")(4,"th",11),a(5),p(6,"translate"),i(),t(7,"th",11),a(8),p(9,"translate"),i(),t(10,"th",11),a(11),p(12,"translate"),i(),t(13,"th",11),a(14),p(15,"translate"),i(),t(16,"th",11),a(17),p(18,"translate"),i(),t(19,"th",12),a(20),p(21,"translate"),i()()(),t(22,"tbody",13),S(23,G,18,8,"tr",14,z),i()()()),l&2){let n=s();e(5),o(d(6,6,"drug.name")),e(3),o(d(9,8,"drug.barcode")),e(3),o(d(12,10,"inventory.currentStock")),e(3),o(d(15,12,"inventory.minimumStock")),e(3),o(d(18,14,"drug.price")),e(3),o(d(21,16,"common.view")),e(3),h(n.lowStockDrugs)}}function q(l,r){l&1&&(t(0,"div",7)(1,"p",23),a(2),p(3,"translate"),i()()),l&2&&(e(2),o(d(3,1,"inventory.adequateStock")))}function L(l,r){if(l&1&&(t(0,"span"),a(1),i()),l&2){let n=s().$implicit,m=s(2);A(m.getDaysToExpiryClass(n.daysToExpiry)),e(),w(" ",m.formatDaysToExpiry(n.daysToExpiry)," ")}}function R(l,r){if(l&1){let n=D();t(0,"tr",14)(1,"td",15),a(2),i(),t(3,"td",16),a(4),i(),t(5,"td",15),a(6),p(7,"date"),i(),t(8,"td",24),v(9,L,2,3,"span",25),i(),t(10,"td",15),a(11),i(),t(12,"td",18)(13,"button",19),p(14,"translate"),C("click",function(){let c=y(n).$implicit,g=s(2);return f(g.viewDrug(c.id))}),E(),t(15,"svg",20),I(16,"path",21)(17,"path",22),i()()()()}if(l&2){let n=r.$implicit;e(2),o((n.generalDrug==null?null:n.generalDrug.name)||"N/A"),e(2),o(n.internalBarcode),e(2),w(" ",M(7,6,n.expiryDate,"mediumDate")," "),e(3),u(n.daysToExpiry!==void 0?9:-1),e(2),o(n.stockQuantity),e(2),_("title",d(14,9,"common.view"))}}function H(l,r){if(l&1&&(t(0,"div",6)(1,"table",9)(2,"thead",10)(3,"tr")(4,"th",11),a(5),p(6,"translate"),i(),t(7,"th",11),a(8),p(9,"translate"),i(),t(10,"th",11),a(11),p(12,"translate"),i(),t(13,"th",11),a(14),p(15,"translate"),i(),t(16,"th",11),a(17),p(18,"translate"),i(),t(19,"th",12),a(20),p(21,"translate"),i()()(),t(22,"tbody",13),S(23,R,18,11,"tr",14,z),i()()()),l&2){let n=s();e(5),o(d(6,6,"drug.name")),e(3),o(d(9,8,"drug.barcode")),e(3),o(d(12,10,"drug.expiryDate")),e(3),o(d(15,12,"inventory.daysToExpiry")),e(3),o(d(18,14,"drug.stock")),e(3),o(d(21,16,"common.view")),e(3),h(n.nearExpiryDrugs)}}function J(l,r){l&1&&(t(0,"div",7)(1,"p",23),a(2),p(3,"translate"),i()()),l&2&&(e(2),o(d(3,1,"inventory.noExpiring")))}var O=class l{drugsService=x(W);router=x(F);translationService=x(P);lowStockDrugs=[];nearExpiryDrugs=[];loading=!0;ngOnInit(){this.loadAlerts()}loadAlerts(){this.loading=!0,this.drugsService.getLowStockDrugs().subscribe({next:r=>{this.lowStockDrugs=r,this.loading=!1},error:r=>{console.error("Error loading low stock drugs:",r),this.loading=!1}}),this.drugsService.getExpiringDrugs(30).subscribe({next:r=>{this.nearExpiryDrugs=r.map(n=>k(T({},n),{daysToExpiry:this.calculateDaysToExpiry(n.expiryDate)})).sort((n,m)=>(n.daysToExpiry||999)-(m.daysToExpiry||999))},error:r=>{console.error("Error loading expiring drugs:",r)}})}calculateDaysToExpiry(r){if(!r)return 999;let n=new Date,c=new Date(r).getTime()-n.getTime();return Math.ceil(c/(1e3*60*60*24))}formatDaysToExpiry(r){return r<0?this.translationService.translate("inventory.expired"):r===0?this.translationService.translate("inventory.expiresToday"):`${r} ${this.translationService.translate("common.days")}`}getDaysToExpiryClass(r){return r<0?"text-red-600 font-semibold":r<=7?"text-red-600 font-medium":r<=14?"text-orange-600 font-medium":"text-yellow-600"}viewDrug(r){this.router.navigate(["/drugs",r])}static \u0275fac=function(n){return new(n||l)};static \u0275cmp=B({type:l,selectors:[["app-inventory-alerts"]],decls:29,vars:22,consts:[[1,"space-y-[var(--spacing-gap)]"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-[var(--spacing-card)]"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-xl","font-semibold","text-[var(--text-primary)]"],[1,"text-sm","text-[var(--card-text)]","mt-1"],["variant","warning"],[1,"overflow-x-auto"],[1,"text-center","py-8"],["variant","danger"],[1,"min-w-full","divide-y","divide-[var(--border-color)]"],[1,"bg-[var(--page-bg)]"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-[var(--card-text)]","uppercase","tracking-wider"],[1,"px-6","py-3","text-right","text-xs","font-medium","text-[var(--card-text)]","uppercase","tracking-wider"],[1,"bg-[var(--card-bg)]","divide-y","divide-[var(--border-color)]"],[1,"hover:bg-[var(--page-bg)]","transition-colors"],[1,"px-6","py-4","text-sm","text-[var(--text-primary)]"],[1,"px-6","py-4","text-sm","text-[var(--text-primary)]","font-mono"],[1,"font-medium","text-red-600"],[1,"px-6","py-4","text-sm","text-right"],[1,"p-1","text-[var(--card-text)]","hover:text-[var(--text-primary)]",3,"click","title"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],[1,"text-[var(--card-text)]"],[1,"px-6","py-4","text-sm"],[3,"class"]],template:function(n,m){n&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h2",3),a(5),p(6,"translate"),i(),t(7,"p",4),a(8),p(9,"translate"),i()(),t(10,"app-badge",5),a(11),p(12,"translate"),i()(),v(13,Q,25,18,"div",6)(14,q,4,3,"div",7),i(),t(15,"div",1)(16,"div",2)(17,"div")(18,"h2",3),a(19),p(20,"translate"),i(),t(21,"p",4),a(22),p(23,"translate"),i()(),t(24,"app-badge",8),a(25),p(26,"translate"),i()(),v(27,H,25,18,"div",6)(28,J,4,3,"div",7),i()()),n&2&&(e(5),o(d(6,10,"inventory.lowStock")),e(3),o(d(9,12,"inventory.belowMinimum")),e(3),b("",m.lowStockDrugs.length," ",d(12,14,"inventory.items"),""),e(2),u(m.lowStockDrugs.length>0?13:14),e(6),o(d(20,16,"inventory.nearExpiry")),e(3),o(d(23,18,"inventory.expiringWithin30Days")),e(3),b("",m.nearExpiryDrugs.length," ",d(26,20,"inventory.items"),""),e(2),u(m.nearExpiryDrugs.length>0?27:28))},dependencies:[$,V,N,j],encapsulation:2})};export{O as InventoryAlertsComponent};
