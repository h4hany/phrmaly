import{a as D}from"./chunk-7XN5GXFV.js";import{a as V}from"./chunk-WVGIKFYW.js";import"./chunk-3NBSZF5I.js";import{a as k}from"./chunk-QDLVDHOW.js";import{a as W}from"./chunk-TCUYX7IT.js";import{a as z}from"./chunk-6CFKC637.js";import"./chunk-5PFWNSG3.js";import"./chunk-T542ZMY7.js";import"./chunk-URFUYTQU.js";import"./chunk-BYXBJQAS.js";import{b as E}from"./chunk-3UJCRMW3.js";import{d as w}from"./chunk-C3O3TVFX.js";import{$a as n,Ab as o,Bb as s,Eb as T,Fa as B,Ka as b,Q as g,Qa as f,Va as S,W as x,X as h,_a as t,_b as y,cb as v,db as u,eb as c,mb as r,nb as m,ob as C,pb as I,wa as i}from"./chunk-E4S7NVXB.js";import"./chunk-C6Q5SG76.js";function M(a,p){if(a&1){let e=v();t(0,"div",6)(1,"h3",10),r(2),o(3,"translate"),n(),t(4,"div",11)(5,"div")(6,"label",12),r(7),o(8,"translate"),n(),t(9,"select",13),u("change",function(d){x(e);let _=c();return h(_.fromBranchId=d.target.value)}),t(10,"option",14),r(11),o(12,"translate"),n(),t(13,"option",15),r(14,"Main Branch"),n(),t(15,"option",16),r(16,"North Branch"),n(),t(17,"option",17),r(18,"South Branch"),n()()(),t(19,"div")(20,"label",12),r(21),o(22,"translate"),n(),t(23,"select",13),u("change",function(d){x(e);let _=c();return h(_.toBranchId=d.target.value)}),t(24,"option",14),r(25),o(26,"translate"),n(),t(27,"option",15),r(28,"Main Branch"),n(),t(29,"option",16),r(30,"North Branch"),n(),t(31,"option",17),r(32,"South Branch"),n()()()()()}if(a&2){let e=c();i(2),m(s(3,7,"transfers.selectBranches")),i(5),m(s(8,9,"transfers.fromBranch")),i(2),f("value",e.fromBranchId),i(2),m(s(12,11,"common.all")),i(10),m(s(22,13,"transfers.toBranch")),i(2),f("value",e.toBranchId),i(2),m(s(26,15,"common.all"))}}function P(a,p){if(a&1){let e=v();t(0,"button",23),u("click",function(){let d=x(e).index,_=c(3);return h(_.removeItem(d))}),r(1),o(2,"translate"),n()}a&2&&(i(),C(" ",s(2,1,"common.delete")," "))}function j(a,p){if(a&1&&(t(0,"app-table",21),b(1,P,3,3,"ng-template",null,0,T),n()),a&2){let e=c(2);f("columns",e.itemColumns)("data",e.items)("emptyMessage","transfers.noItems")}}function q(a,p){a&1&&(t(0,"p",22),r(1),o(2,"translate"),n()),a&2&&(i(),m(s(2,1,"transfers.noItems")))}function O(a,p){if(a&1){let e=v();t(0,"div",6)(1,"div",18)(2,"h3",19),r(3),o(4,"translate"),n(),t(5,"app-button",20),u("onClick",function(){x(e);let d=c();return h(d.showAddItem=!0)}),r(6),o(7,"translate"),n()(),b(8,j,3,3,"app-table",21)(9,q,3,3,"p",22),n()}if(a&2){let e=c();i(3),m(s(4,3,"transfers.addItems")),i(3),m(s(7,5,"common.add")),i(2),S(e.items.length>0?8:9)}}function A(a,p){if(a&1&&(t(0,"div",6)(1,"h3",10),r(2),o(3,"translate"),n(),t(4,"div",24)(5,"div",25)(6,"span",26),r(7),o(8,"translate"),n(),t(9,"span",27),r(10),n()(),t(11,"div",25)(12,"span",26),r(13),o(14,"translate"),n(),t(15,"span",27),r(16),n()(),t(17,"div",25)(18,"span",26),r(19),o(20,"translate"),n(),t(21,"span",27),r(22),o(23,"translate"),n()()()()),a&2){let e=c();i(2),m(s(3,8,"transfers.review")),i(5),m(s(8,10,"transfers.fromBranch")),i(3),m(e.getBranchName(e.fromBranchId)),i(3),m(s(14,12,"transfers.toBranch")),i(3),m(e.getBranchName(e.toBranchId)),i(3),m(s(20,14,"transfers.items")),i(3),I("",e.items.length," ",s(23,16,"transfers.items"),"")}}function R(a,p){if(a&1){let e=v();t(0,"app-button",28),u("onClick",function(){x(e);let d=c();return h(d.currentStep=d.currentStep+1)}),r(1),o(2,"translate"),n()}if(a&2){let e=c();f("disabled",!e.canProceed()),i(),C(" ",s(2,2,"common.next")," ")}}function F(a,p){if(a&1){let e=v();t(0,"app-button",28),u("onClick",function(){x(e);let d=c();return h(d.submitTransfer())}),r(1),o(2,"translate"),n()}if(a&2){let e=c();f("disabled",!e.canSubmit()),i(),C(" ",s(2,2,"transfers.submit")," ")}}var N=class a{transferEngine=g(V);drugsService=g(W);router=g(w);currentStep=0;fromBranchId="";toBranchId="";items=[];showAddItem=!1;availableDrugs=[];steps=[{id:"branches",label:"transfers.selectBranches",description:"transfers.selectBranchesDesc"},{id:"items",label:"transfers.addItems",description:"transfers.addItemsDesc"},{id:"review",label:"transfers.review",description:"transfers.reviewDesc"}];itemColumns=[{key:"drugName",label:"transfers.drug"},{key:"requestedQuantity",label:"transfers.quantity"}];ngOnInit(){this.loadDrugs()}loadDrugs(){this.drugsService.getPharmacyDrugs().subscribe({next:p=>{this.availableDrugs=p.data}})}canProceed(){return this.currentStep===0?!!this.fromBranchId&&!!this.toBranchId&&this.fromBranchId!==this.toBranchId:this.currentStep===1?this.items.length>0:!0}canSubmit(){return this.items.length>0&&!!this.fromBranchId&&!!this.toBranchId}removeItem(p){this.items.splice(p,1)}getBranchName(p){return{branch1:"Main Branch",branch2:"North Branch",branch3:"South Branch"}[p]||p}submitTransfer(){let p={fromBranchId:this.fromBranchId,toBranchId:this.toBranchId,items:this.items,requestedBy:"current-user-id",notes:"",createdBy:"current-user-id"};this.transferEngine.createTransfer(p).subscribe({next:()=>{this.router.navigate(["/inventory/transfers"])}})}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=B({type:a,selectors:[["app-transfer-wizard"]],decls:16,vars:11,consts:[["actionTemplate",""],[1,"space-y-6"],[1,"flex","items-center","justify-between"],[1,"text-sm","text-gray-600","hover:text-gray-900",3,"click"],[3,"stepChange","steps","currentStep"],[1,"p-6","rounded-lg",2,"background-color","var(--card-bg)"],[1,"space-y-4"],[1,"flex","justify-between","mt-6","pt-6","border-t"],["variant","outline",3,"onClick","disabled"],["variant","primary",3,"disabled"],[1,"text-lg","font-semibold","mb-4"],[1,"grid","grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","mb-2"],[1,"w-full","px-3","py-2","border","rounded-md",3,"change","value"],["value",""],["value","branch1"],["value","branch2"],["value","branch3"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-lg","font-semibold"],[3,"onClick"],[3,"columns","data","emptyMessage"],[1,"text-center","py-8","text-gray-500"],[1,"text-sm","px-3","py-1","rounded","text-red-600","hover:bg-red-50",3,"click"],[1,"space-y-3"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"font-medium"],["variant","primary",3,"onClick","disabled"]],template:function(e,l){e&1&&(t(0,"div",1)(1,"div",2)(2,"button",3),u("click",function(){return l.router.navigate(["/inventory/transfers"])}),r(3),o(4,"translate"),n()(),t(5,"app-wizard-stepper",4),u("stepChange",function(_){return l.currentStep=_}),n(),t(6,"div",5),b(7,M,33,17,"div",6)(8,O,10,7,"div",6)(9,A,24,18,"div",6),t(10,"div",7)(11,"app-button",8),u("onClick",function(){return l.currentStep=l.currentStep-1}),r(12),o(13,"translate"),n(),b(14,R,3,4,"app-button",9)(15,F,3,4,"app-button",9),n()()()),e&2&&(i(3),C(" \u2190 ",s(4,7,"common.back")," "),i(2),f("steps",l.steps)("currentStep",l.currentStep),i(2),S(l.currentStep===0?7:l.currentStep===1?8:l.currentStep===2?9:-1),i(4),f("disabled",l.currentStep===0),i(),C(" ",s(13,9,"common.previous")," "),i(2),S(l.currentStep<l.steps.length-1?14:15))},dependencies:[y,D,k,z,E],encapsulation:2})};export{N as TransferWizardComponent};
