import{a as oe,b as re}from"./chunk-756M6VZI.js";import{a as O}from"./chunk-UW4RQ676.js";import{a as ie}from"./chunk-KJHJ7I7K.js";import"./chunk-LBIW3N6U.js";import"./chunk-BYXBJQAS.js";import{a as ne}from"./chunk-YKGXHI5L.js";import{a as T}from"./chunk-2SMPNUPY.js";import{a as D}from"./chunk-SRZA4AYF.js";import"./chunk-PRIAQIJ7.js";import{a as ae}from"./chunk-NOBFKF32.js";import{a as te}from"./chunk-77NWAUUO.js";import{a as ee}from"./chunk-L2QHXWDV.js";import{b as x}from"./chunk-EO5VULWO.js";import{b as W,d as X}from"./chunk-5NQMXUDV.js";import"./chunk-TXY55LQM.js";import{$a as c,Ab as w,Bb as P,Ea as f,Ja as y,Pa as m,Qa as K,R as C,Tb as M,Ua as b,Ub as S,Vb as h,X as U,Y as F,Z as G,Za as a,_ as J,_a as i,bb as Q,cb as k,db as g,lb as l,mb as d,nb as _,pb as $,ta as Z,wa as e,yb as o,zb as p}from"./chunk-F5WAPTHD.js";import{a as L,b as H}from"./chunk-7CGTOI24.js";function de(r,s){if(r&1&&(a(0,"div")(1,"label",8),l(2),o(3,"translate"),i(),a(4,"p",10),l(5),i()()),r&2){let t=g();e(2),d(p(3,2,"patient.email")),e(3),d(t.patient.email)}}function se(r,s){if(r&1&&(a(0,"div")(1,"label",8),l(2),o(3,"translate"),i(),a(4,"p",10),l(5),i()()),r&2){let t=g();e(2),d(p(3,2,"patient.occupation")),e(3),d(t.patient.occupation)}}function me(r,s){if(r&1&&(l(0),o(1,"date")),r&2){let t=g(2);_(" ",w(1,1,t.patient.validUntil,"MM/yy")," ")}}function ce(r,s){r&1&&l(0," - ")}function ve(r,s){if(r&1&&(l(0),o(1,"date")),r&2){let t=g(2);_(" ",w(1,1,t.patient.issuedDate,"MM/yy")," ")}}function ue(r,s){r&1&&l(0," - ")}function ge(r,s){if(r&1&&c(0,"img",32),r&2){let t=g(2);m("src",t.getPharmacyLogo(),Z)}}function be(r,s){if(r&1&&(a(0,"div",33)(1,"span",34),l(2),i()()),r&2){let t=g(2);e(2),d(t.getPharmacyInitials())}}function fe(r,s){if(r&1&&(a(0,"div",12)(1,"div",16)(2,"div",17),c(3,"div",18)(4,"div",19)(5,"div",20)(6,"div",21)(7,"div",22),i(),a(8,"div",23)(9,"div")(10,"div",24),l(11),i(),a(12,"div",25),l(13,"CARD NUMBER"),i(),a(14,"div",26),l(15),i()(),a(16,"div",27)(17,"div",28)(18,"div")(19,"div",29),l(20,"VALID"),i(),a(21,"div",30),y(22,me,2,4)(23,ce,1,0),i()(),a(24,"div")(25,"div",29),l(26),o(27,"translate"),i(),a(28,"div",30),y(29,ve,2,4)(30,ue,1,0),i()()(),a(31,"div",31),y(32,ge,1,1,"img",32)(33,be,3,1,"div",33),i()()()()()),r&2){let t=g();e(11),d(t.patient.fullName),e(4),_(" ",t.patient.cardId," "),e(7),b(t.patient.validUntil?22:23),e(4),d(p(27,6,"patient.issuedDate")),e(3),b(t.patient.issuedDate?29:30),e(3),b(t.getPharmacyLogo()?32:33)}}function he(r,s){if(r&1&&(a(0,"div",14)(1,"label",8),l(2),o(3,"translate"),i(),a(4,"p",10),l(5),i()()),r&2){let t=g();e(2),d(p(3,2,"patient.notes")),e(3),d(t.patient.address.notes)}}var j=class r{patient;pharmacyContext=C(ie);totalOrders=12;totalSpent=2450.75;loyaltyPoints=245;walletBalance=150.5;ordersIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>';moneyIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';starIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg>';walletIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>';getPharmacyLogo(){return this.pharmacyContext.getCurrentPharmacy()?.logoUrl||null}getPharmacyInitials(){let s=this.pharmacyContext.getCurrentPharmacy();return s?.name?s.name.split(" ").map(t=>t[0]).join("").toUpperCase().slice(0,2):"PH"}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=f({type:r,selectors:[["patient-overview-tab"]],inputs:{patient:"patient"},decls:87,vars:85,consts:[[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[3,"label","value","icon"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-6"],[1,"text-lg","font-semibold","text-[var(--text-primary)]","mb-4"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6"],[1,"lg:col-span-2"],[1,"grid","grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-[var(--card-text)]","mb-1"],[1,"text-[var(--text-primary)]","font-medium"],[1,"text-[var(--text-primary)]"],[1,"text-[var(--text-primary)]","capitalize"],[1,"lg:col-span-1"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],[1,"md:col-span-2","lg:col-span-3"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","text-sm"],[1,"relative","rounded-2xl","p-8","shadow-xl","overflow-hidden",2,"background-color","var(--sidebar-bg)","min-height","220px"],[1,"absolute","inset-0","opacity-[0.15]","pointer-events-none",2,"color","var(--sidebar-text)"],[1,"absolute","rounded-full",2,"top","-10%","left","-5%","width","120px","height","120px","background-color","currentColor"],[1,"absolute","rounded-full",2,"top","10%","right","-8%","width","80px","height","80px","background-color","currentColor"],[1,"absolute","rounded-full",2,"bottom","-5%","right","10%","width","100px","height","100px","background-color","currentColor"],[1,"absolute","rounded-full",2,"bottom","15%","left","-5%","width","60px","height","60px","background-color","currentColor"],[1,"absolute","rounded-full",2,"top","50%","left","-8%","width","70px","height","70px","background-color","currentColor","transform","translateY(-50%)"],[1,"relative","z-10","flex","flex-col","justify-between","h-full",2,"color","var(--sidebar-text)"],[1,"text-lg","font-semibold","mb-6"],[1,"text-sm","opacity-90","mb-3"],[1,"text-xl","font-mono","tracking-wider","mb-8"],[1,"flex","items-end","justify-between"],[1,"flex","gap-6"],[1,"text-xs","opacity-80","mb-1"],[1,"text-sm","font-semibold"],[1,"flex","items-center","justify-center"],["alt","Pharmacy Logo",1,"h-10","w-auto","object-contain",3,"src"],[1,"w-16","h-10","rounded-lg","flex","items-center","justify-center",2,"background-color","rgba(227, 244, 245, 0.2)"],[1,"font-bold","text-lg",2,"color","var(--sidebar-text)"]],template:function(t,n){if(t&1&&(a(0,"div",0)(1,"div",1),c(2,"app-stat-card",2),o(3,"translate"),c(4,"app-stat-card",2),o(5,"translate"),o(6,"currency"),c(7,"app-stat-card",2),o(8,"translate"),c(9,"app-stat-card",2),o(10,"translate"),o(11,"currency"),i(),a(12,"div",3)(13,"h2",4),l(14),o(15,"translate"),i(),a(16,"div",5)(17,"div",6)(18,"div",7)(19,"div")(20,"label",8),l(21),o(22,"translate"),i(),a(23,"p",9),l(24),i()(),a(25,"div")(26,"label",8),l(27),o(28,"translate"),i(),a(29,"p",10),l(30),o(31,"date"),i()(),a(32,"div")(33,"label",8),l(34),o(35,"translate"),i(),a(36,"p",11),l(37),i()(),a(38,"div")(39,"label",8),l(40),o(41,"translate"),i(),a(42,"p",10),l(43),i()(),y(44,de,6,4,"div")(45,se,6,4,"div"),i()(),y(46,fe,34,8,"div",12),i()(),a(47,"div",3)(48,"h2",4),l(49),o(50,"translate"),i(),a(51,"div",13)(52,"div")(53,"label",8),l(54),o(55,"translate"),i(),a(56,"p",10),l(57),i()(),a(58,"div")(59,"label",8),l(60),o(61,"translate"),i(),a(62,"p",10),l(63),i()(),a(64,"div")(65,"label",8),l(66),o(67,"translate"),i(),a(68,"p",10),l(69),i()(),y(70,he,6,4,"div",14),i()(),a(71,"div",3)(72,"div",15)(73,"div")(74,"label",8),l(75),o(76,"translate"),i(),a(77,"p",10),l(78),o(79,"date"),i()(),a(80,"div")(81,"label",8),l(82),o(83,"translate"),i(),a(84,"p",10),l(85),o(86,"date"),i()()()()()),t&2){let v,u;e(2),m("label",p(3,36,"patient.overview.totalOrders"))("value",n.totalOrders)("icon",n.ordersIcon),e(2),m("label",p(5,38,"patient.overview.totalSpent"))("value",(v=P(6,40,n.totalSpent,"USD","symbol","1.2-2"))!==null&&v!==void 0?v:"0.00")("icon",n.moneyIcon),e(3),m("label",p(8,45,"patient.overview.loyaltyPoints"))("value",n.loyaltyPoints)("icon",n.starIcon),e(2),m("label",p(10,47,"patient.overview.walletBalance"))("value",(u=P(11,49,n.walletBalance,"USD","symbol","1.2-2"))!==null&&u!==void 0?u:"0.00")("icon",n.walletIcon),e(5),d(p(15,54,"patient.personalInfo")),e(7),d(p(22,56,"patient.fullName")),e(3),d(n.patient.fullName),e(3),d(p(28,58,"patient.dateOfBirth")),e(3),d(w(31,60,n.patient.dateOfBirth,"mediumDate")),e(4),d(p(35,63,"patient.gender")),e(3),d(n.patient.gender),e(3),d(p(41,65,"patient.phone")),e(3),d(n.patient.phone),e(),b(n.patient.email?44:-1),e(),b(n.patient.occupation?45:-1),e(),b(n.patient.cardId?46:-1),e(3),d(p(50,67,"patient.addressInfo")),e(5),d(p(55,69,"patient.city")),e(3),d(n.patient.address.city),e(3),d(p(61,71,"patient.area")),e(3),d(n.patient.address.area),e(3),d(p(67,73,"patient.street")),e(3),d(n.patient.address.street),e(),b(n.patient.address.notes?70:-1),e(5),d(p(76,75,"invoice.createdAt")),e(3),d(w(79,77,n.patient.createdAt,"medium")),e(4),d(p(83,80,"common.lastUpdated")),e(3),d(w(86,82,n.patient.updatedAt,"medium"))}},dependencies:[h,S,M,T,x],encapsulation:2})};var N=class r{patientId;invoicesService=C(O);invoices=[];loading=!1;pagination={page:1,pageSize:10,total:0,totalPages:0};columns=[{key:"invoiceNumber",label:"invoice.invoiceNumber",sortable:!0},{key:"createdAt",label:"invoice.createdAt",sortable:!0},{key:"itemsCount",label:"invoice.items",sortable:!1},{key:"total",label:"invoice.total",sortable:!0},{key:"paymentStatus",label:"invoice.paymentStatus",sortable:!0}];ngOnInit(){this.loadInvoices()}loadInvoices(){this.loading=!0,this.invoicesService.getAll({page:this.pagination.page,pageSize:this.pagination.pageSize}).subscribe({next:s=>{let t=s.data.filter(n=>n.patientId===this.patientId);this.invoices=t.map(n=>H(L({},n),{itemsCount:`${n.items.length} items`})),this.pagination=H(L({},this.pagination),{total:t.length,totalPages:Math.ceil(t.length/this.pagination.pageSize)}),this.loading=!1},error:()=>{this.loading=!1}})}onPageChange(s){this.pagination.page=s,this.loadInvoices()}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=f({type:r,selectors:[["patient-orders-tab"]],inputs:{patientId:"patientId"},decls:7,vars:10,consts:[[1,"space-y-6"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-6"],[1,"text-lg","font-semibold","text-[var(--text-primary)]","mb-4"],[3,"onPageChange","columns","data","pagination","loading","emptyMessage"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"div",1)(2,"h2",2),l(3),o(4,"translate"),i(),a(5,"app-table",3),o(6,"translate"),k("onPageChange",function(u){return n.onPageChange(u)}),i()()()),t&2&&(e(3),d(p(4,6,"patient.orders.title")),e(2),m("columns",n.columns)("data",n.invoices)("pagination",n.pagination)("loading",n.loading)("emptyMessage",p(6,8,"patient.orders.noOrders")))},dependencies:[h,D,x],encapsulation:2})};var V=class r{patientId;walletBalance=150.5;loyaltyPoints=245;currentTier="Silver";nextTier="Gold";nextTierPoints=500;pointsToNextTier=255;walletIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>';starIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg>';badgeIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path></svg>';trendIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>';get tierProgress(){return Math.min(100,this.loyaltyPoints/this.nextTierPoints*100)}transactions=[{id:"1",date:new Date("2024-11-27"),type:"earned",points:50,description:"Purchase reward"},{id:"2",date:new Date("2024-11-20"),type:"redeemed",points:-25,description:"Points redemption"},{id:"3",date:new Date("2024-11-15"),type:"earned",points:30,description:"Purchase reward"}];columns=[{key:"date",label:"table.date",sortable:!0},{key:"type",label:"patient.loyalty.type",sortable:!0},{key:"points",label:"patient.loyalty.points",sortable:!0},{key:"description",label:"patient.loyalty.description",sortable:!1}];pagination={page:1,pageSize:10,total:3,totalPages:1};static \u0275fac=function(t){return new(t||r)};static \u0275cmp=f({type:r,selectors:[["patient-loyalty-tab"]],inputs:{patientId:"patientId"},decls:33,vars:50,consts:[[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[3,"label","value","icon"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-6"],[1,"text-lg","font-semibold","text-[var(--text-primary)]","mb-4"],[1,"space-y-2"],[1,"flex","justify-between","text-sm","text-[var(--card-text)]"],[1,"w-full","bg-gray-200","rounded-full","h-4"],[1,"bg-[var(--primary-bg)]","h-4","rounded-full","transition-all","duration-300"],[1,"text-sm","text-[var(--card-text)]"],[3,"columns","data","pagination","emptyMessage"]],template:function(t,n){if(t&1&&(a(0,"div",0)(1,"div",1),c(2,"app-stat-card",2),o(3,"translate"),o(4,"currency"),c(5,"app-stat-card",2),o(6,"translate"),c(7,"app-stat-card",2),o(8,"translate"),c(9,"app-stat-card",2),o(10,"translate"),i(),a(11,"div",3)(12,"h3",4),l(13),o(14,"translate"),i(),a(15,"div",5)(16,"div",6)(17,"span"),l(18),i(),a(19,"span"),l(20),o(21,"translate"),i()(),a(22,"div",7),c(23,"div",8),i(),a(24,"div",9),l(25),o(26,"translate"),i()()(),a(27,"div",3)(28,"h3",4),l(29),o(30,"translate"),i(),c(31,"app-table",10),o(32,"translate"),i()()),t&2){let v;e(2),m("label",p(3,27,"patient.loyalty.walletBalance"))("value",(v=P(4,29,n.walletBalance,"USD","symbol","1.2-2"))!==null&&v!==void 0?v:"0.00")("icon",n.walletIcon),e(3),m("label",p(6,34,"patient.loyalty.loyaltyPoints"))("value",n.loyaltyPoints)("icon",n.starIcon),e(2),m("label",p(8,36,"patient.loyalty.currentTier"))("value",n.currentTier)("icon",n.badgeIcon),e(2),m("label",p(10,38,"patient.loyalty.pointsToNextTier"))("value",n.pointsToNextTier)("icon",n.trendIcon),e(4),d(p(14,40,"patient.loyalty.tierProgress")),e(5),d(n.currentTier),e(2),$("",n.loyaltyPoints," / ",n.nextTierPoints," ",p(21,42,"patient.loyalty.points"),""),e(3),K("width",n.tierProgress,"%"),e(2),$(" ",n.pointsToNextTier," ",p(26,44,"patient.loyalty.pointsUntil")," ",n.nextTier," "),e(4),d(p(30,46,"patient.loyalty.history")),e(2),m("columns",n.columns)("data",n.transactions)("pagination",n.pagination)("emptyMessage",p(32,48,"patient.loyalty.noTransactions"))}},dependencies:[h,S,T,D,x],encapsulation:2})};var z=class r{patientId;invoicesService=C(O);totalRevenue=0;avgOrderValue=0;totalOrders=0;lastOrderDate=new Date;moneyIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';chartIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>';ordersIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>';calendarIcon='<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>';chartData={labels:[],datasets:[{label:"Revenue",data:[],borderColor:"rgb(75, 192, 192)",backgroundColor:"rgba(75, 192, 192, 0.2)",tension:.1}]};chartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top"},tooltip:{enabled:!0}},scales:{y:{beginAtZero:!0,ticks:{callback:function(s){return"$"+s.toFixed(2)}}}}};ngOnInit(){this.loadRevenueData()}loadRevenueData(){this.invoicesService.getAll({page:1,pageSize:100}).subscribe({next:s=>{let t=s.data.filter(u=>u.patientId===this.patientId);if(this.totalOrders=t.length,this.totalRevenue=t.reduce((u,I)=>u+I.total,0),this.avgOrderValue=this.totalOrders>0?this.totalRevenue/this.totalOrders:0,t.length>0){let u=t.sort((I,q)=>new Date(q.createdAt).getTime()-new Date(I.createdAt).getTime());this.lastOrderDate=u[0].createdAt}let n=["Jan","Feb","Mar","Apr","May","Jun"],v=n.map((u,I)=>t.filter(R=>new Date(R.createdAt).getMonth()===I).reduce((R,Y)=>R+Y.total,0));this.chartData={labels:n,datasets:[{label:"Revenue",data:v,borderColor:"rgb(75, 192, 192)",backgroundColor:"rgba(75, 192, 192, 0.2)",tension:.1}]}}})}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=f({type:r,selectors:[["patient-revenue-tab"]],inputs:{patientId:"patientId"},decls:18,vars:39,consts:[[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[3,"label","value","icon"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-6"],[1,"text-lg","font-semibold","text-[var(--text-primary)]","mb-4"],["type","line",3,"data","options","height"]],template:function(t,n){if(t&1&&(a(0,"div",0)(1,"div",1),c(2,"app-stat-card",2),o(3,"translate"),o(4,"currency"),c(5,"app-stat-card",2),o(6,"translate"),o(7,"currency"),c(8,"app-stat-card",2),o(9,"translate"),c(10,"app-stat-card",2),o(11,"translate"),o(12,"date"),i(),a(13,"div",3)(14,"h3",4),l(15),o(16,"translate"),i(),c(17,"app-chart",5),i()()),t&2){let v,u,I;e(2),m("label",p(3,16,"patient.revenue.totalRevenue"))("value",(v=P(4,18,n.totalRevenue,"USD","symbol","1.2-2"))!==null&&v!==void 0?v:"0.00")("icon",n.moneyIcon),e(3),m("label",p(6,23,"patient.revenue.avgOrderValue"))("value",(u=P(7,25,n.avgOrderValue,"USD","symbol","1.2-2"))!==null&&u!==void 0?u:"0.00")("icon",n.chartIcon),e(3),m("label",p(9,30,"patient.revenue.totalOrders"))("value",n.totalOrders)("icon",n.ordersIcon),e(2),m("label",p(11,32,"patient.revenue.lastOrderDate"))("value",(I=w(12,34,n.lastOrderDate,"shortDate"))!==null&&I!==void 0?I:"-")("icon",n.calendarIcon),e(5),d(p(16,37,"patient.revenue.chartTitle")),e(2),m("data",n.chartData)("options",n.chartOptions)("height",300)}},dependencies:[h,S,M,ne,T,x],encapsulation:2})};function xe(r,s){if(r&1&&(a(0,"div")(1,"label",5),l(2),o(3,"translate"),i(),a(4,"div",6)(5,"p",7),l(6),i()()()),r&2){let t=g();e(2),d(p(3,2,"patient.medicalNotes")),e(4),d(t.patient.medicalNotes)}}function ye(r,s){r&1&&(a(0,"div",3)(1,"p",4),l(2),o(3,"translate"),i()()),r&2&&(e(2),d(p(3,1,"patient.medical.noNotes")))}var A=class r{patient;static \u0275fac=function(t){return new(t||r)};static \u0275cmp=f({type:r,selectors:[["patient-medical-tab"]],inputs:{patient:"patient"},decls:15,vars:10,consts:[[1,"space-y-6"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-6"],[1,"text-lg","font-semibold","text-[var(--text-primary)]","mb-4"],[1,"text-center","py-12"],[1,"text-[var(--card-text)]"],[1,"block","text-sm","font-medium","text-[var(--card-text)]","mb-2"],[1,"bg-[var(--page-bg)]","rounded-[var(--radius-md)]","p-4"],[1,"text-[var(--text-primary)]","whitespace-pre-wrap"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"div",1)(2,"h2",2),l(3),o(4,"translate"),i(),y(5,xe,7,4,"div")(6,ye,4,3,"div",3),i(),a(7,"div",1)(8,"h3",2),l(9),o(10,"translate"),i(),a(11,"div",3)(12,"p",4),l(13),o(14,"translate"),i()()()()),t&2&&(e(3),d(p(4,4,"patient.medicalInfo")),e(2),b(n.patient.medicalNotes?5:6),e(4),d(p(10,6,"patient.medical.additionalInfo")),e(4),d(p(14,8,"patient.medical.comingSoon")))},dependencies:[h,x],encapsulation:2})};function Ce(r,s){if(r&1&&c(0,"app-alert",1),r&2){let t=g();m("title",t.errorMessage)}}function Ie(r,s){if(r&1){let t=Q();a(0,"div",2)(1,"div",4)(2,"h1",5),l(3),o(4,"translate"),i(),a(5,"div",6)(6,"app-button",7),k("onClick",function(){U(t);let v=g();return F(v.editPatient())}),G(),a(7,"svg",8),c(8,"path",9),i(),l(9),o(10,"translate"),i(),J(),a(11,"app-button",7),k("onClick",function(){U(t);let v=g();return F(v.goBack())}),G(),a(12,"svg",8),c(13,"path",10),i(),l(14),o(15,"translate"),i()()(),J(),a(16,"app-tabs")(17,"app-tab",11),o(18,"translate"),c(19,"patient-overview-tab",12),i(),a(20,"app-tab",11),o(21,"translate"),c(22,"patient-orders-tab",13),i(),a(23,"app-tab",11),o(24,"translate"),c(25,"patient-loyalty-tab",13),i(),a(26,"app-tab",11),o(27,"translate"),c(28,"patient-revenue-tab",13),i(),a(29,"app-tab",11),o(30,"translate"),c(31,"patient-medical-tab",12),i()()()}if(r&2){let t=g();e(3),d(p(4,18,"patient.details")),e(6),_(" ",p(10,20,"common.edit")," "),e(5),_(" ",p(15,22,"common.back")," "),e(3),m("title",p(18,24,"patient.tabs.overview"))("active",!0),e(2),m("patient",t.patient),e(),m("title",p(21,26,"patient.tabs.orders"))("active",!1),e(2),m("patientId",t.patient.id),e(),m("title",p(24,28,"patient.tabs.loyalty"))("active",!1),e(2),m("patientId",t.patient.id),e(),m("title",p(27,30,"patient.tabs.revenue"))("active",!1),e(2),m("patientId",t.patient.id),e(),m("title",p(30,32,"patient.tabs.medical"))("active",!1),e(2),m("patient",t.patient)}}function we(r,s){r&1&&(a(0,"div",3)(1,"p",14),l(2,"Loading patient details..."),i()())}var pe=class r{route=C(W);router=C(X);patientsService=C(ae);patient=null;loading=!0;errorMessage="";ngOnInit(){let s=this.route.snapshot.paramMap.get("id");s?this.loadPatient(s):(this.errorMessage="Patient ID is required",this.loading=!1)}loadPatient(s){this.loading=!0,this.errorMessage="",this.patientsService.getById(s).subscribe({next:t=>{this.patient=t,this.loading=!1,t||(this.errorMessage="Patient not found")},error:t=>{this.errorMessage="Failed to load patient details",this.loading=!1,console.error("Error loading patient:",t)}})}editPatient(){this.patient&&this.router.navigate(["/patients",this.patient.id,"edit"])}goBack(){this.router.navigate(["/patients"])}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=f({type:r,selectors:[["app-patient-detail"]],decls:4,vars:2,consts:[[1,"space-y-[var(--spacing-gap)]"],["type","error",3,"title"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-[var(--spacing-card)]"],[1,"text-center","py-12"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-[var(--text-primary)]"],[1,"flex","gap-3"],["variant","outline",3,"onClick"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","inline","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[3,"title","active"],[3,"patient"],[3,"patientId"],[1,"text-[var(--card-text)]"]],template:function(t,n){t&1&&(a(0,"div",0),y(1,Ce,1,1,"app-alert",1)(2,Ie,32,34,"div",2)(3,we,3,0,"div",3),i()),t&2&&(e(),b(n.errorMessage?1:-1),e(),b(n.patient?2:n.loading?3:-1))},dependencies:[h,ee,te,x,re,oe,j,N,V,z,A],encapsulation:2})};export{pe as PatientDetailComponent};
