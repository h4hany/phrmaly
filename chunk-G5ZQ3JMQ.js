import{a as U}from"./chunk-ZBG5VS73.js";import{a as Q}from"./chunk-EKSGP2SL.js";import{a as K}from"./chunk-55KWSP26.js";import{a as W,b as J}from"./chunk-4PK2EB7K.js";import{a as z}from"./chunk-CPH2TRFL.js";import{a as H}from"./chunk-PUVF5ECJ.js";import"./chunk-Y5QUESDN.js";import{d as f,e as k,f as A,h as T,k as G,n as R,t as V,v as B,w as D,x as j}from"./chunk-VW37JDOU.js";import{a as L}from"./chunk-YUKQXM5O.js";import"./chunk-M3W4QUEG.js";import"./chunk-BYXBJQAS.js";import{b as P,d as q}from"./chunk-QHH3SHC3.js";import"./chunk-KPWAPXFF.js";import"./chunk-ACQN7LQS.js";import{b as O}from"./chunk-7DC7YEPQ.js";import{$a as o,$b as w,Bb as C,Cb as F,Ga as E,La as N,Ra as a,S as p,Sa as M,Wa as x,_ as g,ab as i,bb as n,eb as y,nb as b,pb as S,xa as t}from"./chunk-OKFD3A6M.js";import{a as _,b as I}from"./chunk-KAT7YFEL.js";function Y(s,r){s&1&&(g(),o(0,"svg",14),n(1,"circle",16)(2,"path",17),i())}function Z(s,r){s&1&&(g(),o(0,"svg",15),n(1,"path",18),i())}var X=class s{fb=p(B);router=p(q);route=p(P);pharmacyStaffService=p(U);pharmacyContext=p(L);staffForm;loading=!1;errorMessage="";isEdit=!1;staffId=null;roleOptions=[{value:"account_owner",label:"staff.accountOwner"},{value:"pharmacy_manager",label:"staff.pharmacyManager"},{value:"pharmacy_staff",label:"staff.pharmacyStaff"}];statusOptions=[{value:"active",label:"common.active"},{value:"inactive",label:"common.inactive"}];ngOnInit(){this.staffId=this.route.snapshot.paramMap.get("id"),this.isEdit=!!this.staffId&&this.route.snapshot.url[this.route.snapshot.url.length-1]?.path==="edit";let l=this.pharmacyContext.getCurrentPharmacy()?.id||"ph1";this.staffForm=this.fb.group({fullName:["",[f.required]],email:["",[f.required,f.email]],phone:[""],username:[""],role:["",[f.required]],status:["active"],notes:[""]}),this.isEdit&&this.staffId&&this.loadStaff()}loadStaff(){this.loading=!0,this.pharmacyStaffService.getById(this.staffId).subscribe({next:r=>{r&&this.staffForm.patchValue({fullName:r.fullName,email:r.email,phone:r.phone||"",username:r.username||"",role:r.role,status:r.status,notes:""}),this.loading=!1},error:()=>{this.errorMessage="error.loadStaff",this.loading=!1}})}onSubmit(){if(this.staffForm.invalid){this.staffForm.markAllAsTouched();return}this.loading=!0,this.errorMessage="";let l=this.pharmacyContext.getCurrentPharmacy()?.id||"ph1",e=I(_({},this.staffForm.value),{pharmacyId:l});(this.isEdit?this.pharmacyStaffService.update(this.staffId,e):this.pharmacyStaffService.create(e)).subscribe({next:()=>{this.router.navigate(["/pharmacy-staff"])},error:()=>{this.errorMessage=this.isEdit?"error.updateStaff":"error.createStaff",this.loading=!1}})}onCancel(){this.router.navigate(["/pharmacy-staff"])}static \u0275fac=function(l){return new(l||s)};static \u0275cmp=E({type:s,selectors:[["app-pharmacy-staff-form"]],decls:30,vars:39,consts:[[3,"title","description","errorMessage"],[1,"p-8",3,"ngSubmit","formGroup"],[3,"title"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["type","text","formControlName","fullName","prefixIcon","user",3,"label","required","hasError","errorMessage"],["type","email","formControlName","email","prefixIcon","mail",3,"label","required","hasError","errorMessage"],["type","tel","formControlName","phone","prefixIcon","phone",3,"label"],["type","text","formControlName","username","prefixIcon","user",3,"label"],["formControlName","role","prefixIcon","id-badge",3,"label","required","options","placeholder","hasError","errorMessage"],["formControlName","status",3,"label","radioOptions"],["formControlName","notes","prefixIcon","document-text",3,"label","rows"],[1,"flex","items-center","justify-end","gap-4","pt-8","border-t-2","border-gray-100"],["type","button",1,"px-6","py-3","border-2","border-gray-300","text-gray-700","rounded-xl","font-semibold","hover:bg-gray-50","hover:border-gray-400","transition-all","duration-200",3,"click"],["type","submit",1,"px-6","py-3","rounded-xl","font-semibold","hover:shadow-xl","hover:scale-105","active:scale-95","disabled:opacity-50","disabled:cursor-not-allowed","disabled:hover:scale-100","disabled:hover:shadow-none","transition-all","duration-200","flex","items-center","gap-2",3,"disabled"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"]],template:function(l,e){if(l&1&&(o(0,"app-modern-form-wrapper",0)(1,"form",1),y("ngSubmit",function(){return e.onSubmit()}),o(2,"app-form-section",2)(3,"div",3)(4,"div"),n(5,"app-text-input",4),i(),o(6,"div"),n(7,"app-text-input",5),i(),o(8,"div"),n(9,"app-text-input",6),i(),o(10,"div"),n(11,"app-text-input",7),i()()(),o(12,"app-form-section",2)(13,"div",3)(14,"div"),n(15,"app-autocomplete-input",8),i(),o(16,"div"),n(17,"app-radio-input",9),i()()(),o(18,"app-form-section",2)(19,"div"),n(20,"app-textarea-input",10),i()(),o(21,"div",11)(22,"button",12),y("click",function(){return e.onCancel()}),b(23),C(24,"translate"),i(),o(25,"button",13),N(26,Y,3,0,":svg:svg",14)(27,Z,2,0,":svg:svg",15),b(28),C(29,"translate"),i()()()()),l&2){let m,d,u,c,h,v;a("title",e.isEdit?"staff.edit":"staff.add")("description",e.isEdit?"form.editStaffDescription":"form.addStaffDescription")("errorMessage",e.errorMessage),t(),a("formGroup",e.staffForm),t(),a("title","staff.personalInfo"),t(3),a("label","patient.fullName")("required",!0)("hasError",!!((m=e.staffForm.get("fullName"))!=null&&m.invalid&&((m=e.staffForm.get("fullName"))!=null&&m.touched)))("errorMessage",(d=e.staffForm.get("fullName"))!=null&&d.invalid&&((d=e.staffForm.get("fullName"))!=null&&d.touched)?"validation.fullNameRequired":void 0),t(2),a("label","patient.email")("required",!0)("hasError",!!((u=e.staffForm.get("email"))!=null&&u.invalid&&((u=e.staffForm.get("email"))!=null&&u.touched)))("errorMessage",(c=e.staffForm.get("email"))!=null&&c.invalid&&((c=e.staffForm.get("email"))!=null&&c.touched)?"validation.emailInvalid":void 0),t(2),a("label","patient.phone"),t(2),a("label","staff.username"),t(),a("title","staff.roleAndStatus"),t(3),a("label","staff.role")("required",!0)("options",e.roleOptions)("placeholder","form.selectRole")("hasError",!!((h=e.staffForm.get("role"))!=null&&h.invalid&&((h=e.staffForm.get("role"))!=null&&h.touched)))("errorMessage",(v=e.staffForm.get("role"))!=null&&v.invalid&&((v=e.staffForm.get("role"))!=null&&v.touched)?"validation.roleRequired":void 0),t(2),a("label","staff.status")("radioOptions",e.statusOptions),t(),a("title","form.staff.notes"),t(2),a("label","form.staff.notes")("rows",3),t(3),S(" ",F(24,35,"common.cancel")," "),t(2),M("background","var(--primary-bg)")("color","var(--primary-text)"),a("disabled",e.staffForm.invalid||e.loading),t(),x(e.loading?26:27),t(2),S(" ",F(29,37,e.isEdit?"staff.update":"staff.create")," ")}},dependencies:[w,j,T,k,A,V,G,R,D,W,J,O,H,K,Q,z],encapsulation:2})};export{X as PharmacyStaffFormComponent};
