import{a as U}from"./chunk-2XH43HDT.js";import{a as K}from"./chunk-IONILDPT.js";import{e as H,g as P,n as j,o as W,p as D,u as O}from"./chunk-J4RW7IXS.js";import{a as q}from"./chunk-JBZ5JDSH.js";import"./chunk-ONVEZIWC.js";import{a as R}from"./chunk-K7KLI742.js";import{a as A}from"./chunk-H653ED7N.js";import{b as G}from"./chunk-7YN2F2UA.js";import{d as Q}from"./chunk-J2A4D5WT.js";import{Cb as z,Da as L,Ia as C,Oa as f,Q as b,Ta as B,W as u,Wb as F,X as m,Y as _,Ya as t,Z as y,Za as r,_a as v,ab as M,bb as S,cb as w,gb as I,hb as E,ib as N,kb as s,lb as c,mb as x,rb as k,sb as T,tb as V,va as l,yb as a,zb as o}from"./chunk-ILVQMZIM.js";import"./chunk-7CGTOI24.js";var X=["deleteModal"];function Y(h,i){if(h&1&&v(0,"app-alert",3),h&2){let n=w();f("title",n.errorMessage)}}function Z(h,i){if(h&1){let n=M();t(0,"div",23)(1,"button",24),a(2,"translate"),S("click",function(){let p=u(n).$implicit,d=w();return m(d.editSupplier(p.id))}),_(),t(3,"svg",25),v(4,"path",26),r()(),y(),t(5,"button",27),a(6,"translate"),S("click",function(){let p=u(n).$implicit,d=w();return m(d.confirmDelete(p))}),_(),t(7,"svg",25),v(8,"path",28),r()()()}h&2&&(l(),f("title",o(2,2,"common.edit")),l(4),f("title",o(6,4,"common.delete")))}var J=class h{router=b(Q);suppliersService=b(U);suppliers=[];searchQuery="";selectedType="";selectedStatus="";errorMessage="";loading=!1;deleting=!1;selectedSupplierId=null;selectedSupplierName="";deleteModal;columns=[{key:"id",label:"table.supplierId",sortable:!0},{key:"name",label:"table.name",sortable:!0},{key:"type",label:"table.type",sortable:!0},{key:"phone",label:"table.phone"},{key:"email",label:"table.email"},{key:"status",label:"table.status"},{key:"actions",label:"table.action"}];pagination={page:1,pageSize:10,total:0,totalPages:0};ngOnInit(){this.loadSuppliers()}loadSuppliers(){this.loading=!0,this.suppliersService.getAll({page:this.pagination.page,pageSize:this.pagination.pageSize}).subscribe({next:i=>{let n=i.data;this.selectedType&&(n=n.filter(e=>e.type===this.selectedType)),this.selectedStatus&&(n=n.filter(e=>e.status===this.selectedStatus)),this.suppliers=n,this.pagination={page:i.page,pageSize:i.pageSize,total:n.length,totalPages:Math.ceil(n.length/i.pageSize)},this.loading=!1},error:()=>{this.errorMessage="Failed to load suppliers",this.loading=!1}})}onSearch(){this.searchQuery.trim()?(this.loading=!0,this.suppliersService.search(this.searchQuery).subscribe({next:i=>{this.suppliers=i,this.pagination={page:1,pageSize:10,total:i.length,totalPages:Math.ceil(i.length/10)},this.loading=!1},error:()=>{this.errorMessage="Search failed",this.loading=!1}})):this.loadSuppliers()}onFilterChange(){this.loadSuppliers()}navigateToNew(){this.router.navigate(["/suppliers/new"])}editSupplier(i){this.router.navigate(["/suppliers",i,"edit"])}confirmDelete(i){this.selectedSupplierId=i.id,this.selectedSupplierName=i.name,this.deleteModal.open()}deleteSupplier(){this.selectedSupplierId&&(this.deleting=!0,this.suppliersService.delete(this.selectedSupplierId).subscribe({next:i=>{i&&(this.loadSuppliers(),this.deleteModal.close(),this.selectedSupplierId=null,this.selectedSupplierName=""),this.deleting=!1},error:()=>{this.errorMessage="Failed to delete supplier",this.deleting=!1}}))}static \u0275fac=function(n){return new(n||h)};static \u0275cmp=L({type:h,selectors:[["app-suppliers-list"]],viewQuery:function(n,e){if(n&1&&I(X,5),n&2){let p;E(p=N())&&(e.deleteModal=p.first)}},decls:52,vars:51,consts:[["actionTemplate",""],["deleteModal",""],[1,"space-y-6"],["type","error",3,"title"],[1,"flex","items-center","justify-between","gap-4"],[1,"flex-1","max-w-lg"],[1,"relative"],["type","text",1,"w-full","px-4","py-2","pl-10","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]",3,"input","placeholder","value"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","absolute","left-3","top-2.5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],[1,"flex","gap-3"],[1,"px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]",3,"ngModelChange","change","ngModel"],["value",""],["value","manufacturer"],["value","warehouse"],["value","active"],["value","inactive"],["variant","outline"],["variant","primary",3,"onClick"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","inline","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],["rowIdKey","id",3,"columns","data","pagination","emptyMessage","loading"],[3,"confirmed","title","showFooter","confirmText","confirmLoading"],[1,"flex","items-center","gap-2"],[1,"p-1","text-gray-600","hover:text-gray-900",3,"click","title"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"p-1","text-gray-600","hover:text-red-600",3,"click","title"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"]],template:function(n,e){if(n&1){let p=M();t(0,"div",2),C(1,Y,1,1,"app-alert",3),t(2,"div",4)(3,"div",5)(4,"div",6)(5,"input",7),a(6,"translate"),S("input",function(g){return u(p),e.searchQuery=g.target.value,m(e.onSearch())}),r(),_(),t(7,"svg",8),v(8,"path",9),r()()(),y(),t(9,"div",10)(10,"select",11),V("ngModelChange",function(g){return u(p),T(e.selectedType,g)||(e.selectedType=g),m(g)}),S("change",function(){return u(p),m(e.onFilterChange())}),t(11,"option",12),s(12),a(13,"translate"),r(),t(14,"option",13),s(15),a(16,"translate"),r(),t(17,"option",14),s(18),a(19,"translate"),r()(),t(20,"select",11),V("ngModelChange",function(g){return u(p),T(e.selectedStatus,g)||(e.selectedStatus=g),m(g)}),S("change",function(){return u(p),m(e.onFilterChange())}),t(21,"option",12),s(22),a(23,"translate"),r(),t(24,"option",15),s(25),a(26,"translate"),r(),t(27,"option",16),s(28),a(29,"translate"),r()(),t(30,"app-button",17),s(31),a(32,"translate"),r(),t(33,"app-button",18),S("onClick",function(){return u(p),m(e.navigateToNew())}),_(),t(34,"svg",19),v(35,"path",20),r(),s(36),a(37,"translate"),r()()(),y(),t(38,"app-table",21),C(39,Z,9,6,"ng-template",null,0,z),r(),t(41,"app-modal",22,1),a(43,"translate"),a(44,"translate"),S("confirmed",function(){return u(p),m(e.deleteSupplier())}),t(45,"p"),s(46),a(47,"translate"),t(48,"strong"),s(49),r(),s(50),a(51,"translate"),r()()()}n&2&&(l(),B(e.errorMessage?1:-1),l(4),f("placeholder",o(6,25,"common.search"))("value",e.searchQuery),l(5),k("ngModel",e.selectedType),l(2),c(o(13,27,"button.allTypes")),l(3),c(o(16,29,"button.manufacturer")),l(3),c(o(19,31,"button.warehouse")),l(2),k("ngModel",e.selectedStatus),l(2),c(o(23,33,"button.allStatus")),l(3),c(o(26,35,"button.active")),l(3),c(o(29,37,"button.inactive")),l(3),c(o(32,39,"common.export")),l(5),x(" ",o(37,41,"button.addNewSupplier")," "),l(2),f("columns",e.columns)("data",e.suppliers)("pagination",e.pagination)("emptyMessage","empty.noSuppliers")("loading",e.loading),l(3),f("title",o(43,43,"button.deleteSupplier"))("showFooter",!0)("confirmText",o(44,45,"common.delete"))("confirmLoading",e.deleting),l(5),x("",o(47,47,"modal.deleteSupplierConfirm")," "),l(3),c(e.selectedSupplierName),l(),c(o(51,49,"modal.cannotUndo")))},dependencies:[F,O,W,D,j,H,P,R,q,K,A,G],encapsulation:2})};export{J as SuppliersListComponent};
