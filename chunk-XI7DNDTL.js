import{a as Q}from"./chunk-J55IG6XL.js";import{a as H}from"./chunk-DLU7ZGG4.js";import{a as j}from"./chunk-THCZEFPZ.js";import"./chunk-P5TE6FOK.js";import"./chunk-N3GUYB4W.js";import{a as z}from"./chunk-YJWIIGXE.js";import{d as B}from"./chunk-QHH3SHC3.js";import{a as N}from"./chunk-KPWAPXFF.js";import{b as E}from"./chunk-7DC7YEPQ.js";import{$ as f,$a as t,$b as I,Bb as l,Cb as s,Fb as L,Ga as C,La as b,Ra as u,S as k,Wa as x,Y as g,Z as h,_ as c,ab as n,bb as p,db as y,eb as v,fb as w,jb as M,kb as V,lb as T,nb as _,ob as S,pb as P,xa as a}from"./chunk-OKFD3A6M.js";import"./chunk-KAT7YFEL.js";var F=["deleteModal"];function A(d,e){if(d&1&&p(0,"app-alert",3),d&2){let o=w();u("title",o.errorMessage)}}function O(d,e){if(d&1){let o=y();t(0,"div",19)(1,"button",20),l(2,"translate"),v("click",function(){let r=g(o).$implicit,m=w();return h(m.viewPatient(r.id))}),c(),t(3,"svg",21),p(4,"path",22)(5,"path",23),n()(),f(),t(6,"button",24),l(7,"translate"),v("click",function(){let r=g(o).$implicit,m=w();return h(m.confirmDelete(r))}),c(),t(8,"svg",21),p(9,"path",25),n()(),f(),t(10,"button",20),l(11,"translate"),v("click",function(){let r=g(o).$implicit,m=w();return h(m.editPatient(r.id))}),c(),t(12,"svg",21),p(13,"path",26),n()()()}d&2&&(a(),u("title",s(2,3,"common.view")),a(5),u("title",s(7,5,"common.delete")),a(4),u("title",s(11,7,"common.edit")))}var G=class d{router=k(B);patientsService=k(Q);patients=[];searchQuery="";errorMessage="";loading=!1;deleting=!1;selectedPatientId=null;selectedPatientName="";deleteModal;columns=[{key:"id",label:"table.patientId",sortable:!0},{key:"fullName",label:"table.fullName",sortable:!0},{key:"email",label:"table.email"},{key:"phone",label:"table.phone"},{key:"address.city",label:"table.city"},{key:"actions",label:"table.action"}];pagination={page:1,pageSize:10,total:0,totalPages:0};ngOnInit(){this.loadPatients()}loadPatients(){this.loading=!0,this.patientsService.getAll({page:this.pagination.page,pageSize:this.pagination.pageSize}).subscribe({next:e=>{this.patients=e.data,this.pagination={page:e.page,pageSize:e.pageSize,total:e.total,totalPages:e.totalPages},this.loading=!1},error:e=>{this.errorMessage="Failed to load patients",this.loading=!1}})}onSearch(){this.searchQuery.trim()?(this.loading=!0,this.patientsService.search(this.searchQuery).subscribe({next:e=>{this.patients=e,this.pagination={page:1,pageSize:10,total:e.length,totalPages:Math.ceil(e.length/10)},this.loading=!1},error:()=>{this.errorMessage="Search failed",this.loading=!1}})):this.loadPatients()}navigateToNew(){this.router.navigate(["/patients/new"])}viewPatient(e){this.router.navigate(["/patients",e])}editPatient(e){this.router.navigate(["/patients",e,"edit"])}confirmDelete(e){this.selectedPatientId=e.id,this.selectedPatientName=e.fullName,this.deleteModal.open()}deletePatient(){this.selectedPatientId&&(this.deleting=!0,this.patientsService.delete(this.selectedPatientId).subscribe({next:e=>{e&&(this.loadPatients(),this.deleteModal.close(),this.selectedPatientId=null,this.selectedPatientName=""),this.deleting=!1},error:()=>{this.errorMessage="Failed to delete patient",this.deleting=!1}}))}static \u0275fac=function(o){return new(o||d)};static \u0275cmp=C({type:d,selectors:[["app-patients-list"]],viewQuery:function(o,i){if(o&1&&M(F,5),o&2){let r;V(r=T())&&(i.deleteModal=r.first)}},decls:39,vars:34,consts:[["actionTemplate",""],["deleteModal",""],[1,"space-y-6"],["type","error",3,"title"],[1,"flex","items-center","justify-between","gap-4"],[1,"flex-1","max-w-lg"],[1,"relative"],["type","text",1,"w-full","px-4","py-2","pl-10","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]",3,"input","placeholder","value"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","absolute","left-3","top-2.5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],[1,"flex","gap-3"],["variant","outline"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","inline","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"],["variant","primary",3,"onClick"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],["rowIdKey","id",3,"columns","data","pagination","emptyMessage","loading"],[3,"confirmed","title","showFooter","confirmText","confirmLoading"],[1,"flex","items-center","gap-2"],[1,"p-1","text-gray-600","hover:text-gray-900",3,"click","title"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],[1,"p-1","text-gray-600","hover:text-red-600",3,"click","title"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"]],template:function(o,i){if(o&1){let r=y();t(0,"div",2),b(1,A,1,1,"app-alert",3),t(2,"div",4)(3,"div",5)(4,"div",6)(5,"input",7),l(6,"translate"),v("input",function(D){return g(r),i.searchQuery=D.target.value,h(i.onSearch())}),n(),c(),t(7,"svg",8),p(8,"path",9),n()()(),f(),t(9,"div",10)(10,"app-button",11),c(),t(11,"svg",12),p(12,"path",13),n(),_(13),l(14,"translate"),n(),f(),t(15,"app-button",11),c(),t(16,"svg",12),p(17,"path",14),n(),_(18),l(19,"translate"),n(),f(),t(20,"app-button",15),v("onClick",function(){return g(r),h(i.navigateToNew())}),c(),t(21,"svg",12),p(22,"path",16),n(),_(23),l(24,"translate"),n()()(),f(),t(25,"app-table",17),b(26,O,14,9,"ng-template",null,0,L),n(),t(28,"app-modal",18,1),l(30,"translate"),l(31,"translate"),v("confirmed",function(){return g(r),h(i.deletePatient())}),t(32,"p"),_(33),l(34,"translate"),t(35,"strong"),_(36),n(),_(37),l(38,"translate"),n()()()}o&2&&(a(),x(i.errorMessage?1:-1),a(4),u("placeholder",s(6,18,"common.search"))("value",i.searchQuery),a(8),P(" ",s(14,20,"common.filters")," "),a(5),P(" ",s(19,22,"common.export")," "),a(5),P(" ",s(24,24,"button.addNewPatient")," "),a(2),u("columns",i.columns)("data",i.patients)("pagination",i.pagination)("emptyMessage","empty.noPatients")("loading",i.loading),a(3),u("title",s(30,26,"button.deletePatient"))("showFooter",!0)("confirmText",s(31,28,"common.delete"))("confirmLoading",i.deleting),a(5),P("",s(34,30,"modal.deletePatientConfirm")," "),a(3),S(i.selectedPatientName),a(),S(s(38,32,"modal.cannotUndo")))},dependencies:[I,z,j,H,N,E],encapsulation:2})};export{G as PatientsListComponent};
