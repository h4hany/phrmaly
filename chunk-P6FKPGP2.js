import{a as B}from"./chunk-LPVW7747.js";import{a as M}from"./chunk-3DTIOVPA.js";import{a as V}from"./chunk-XFUAL6PF.js";import{a as P}from"./chunk-THCZEFPZ.js";import"./chunk-P5TE6FOK.js";import"./chunk-N3GUYB4W.js";import"./chunk-YJWIIGXE.js";import"./chunk-YUKQXM5O.js";import"./chunk-M3W4QUEG.js";import"./chunk-BYXBJQAS.js";import{d as I}from"./chunk-QHH3SHC3.js";import{a as L}from"./chunk-JEDHGX64.js";import"./chunk-ACQN7LQS.js";import{b as k}from"./chunk-7DC7YEPQ.js";import{$a as i,$b as E,Bb as m,Cb as d,Fb as T,Ga as R,La as y,Ra as l,S as b,Y as f,Z as u,Za as x,_a as S,ab as n,bb as D,db as _,eb as v,fb as C,nb as s,ob as p,pb as w,xa as a}from"./chunk-OKFD3A6M.js";import"./chunk-KAT7YFEL.js";var F=(o,e)=>e.id;function O(o,e){if(o&1&&(i(0,"app-profile-card",10)(1,"div",12)(2,"div",13)(3,"span",14),s(4),m(5,"translate"),n(),i(6,"span",15),s(7),n()(),i(8,"div",13)(9,"span",14),s(10),m(11,"translate"),n(),i(12,"span",15),s(13),n()()()()),o&2){let r=e.$implicit,t=C();l("title",r.name)("subtitle",r.specialty||"General"),a(4),p(d(5,6,"referrals.referrals")),a(3),p(r.totalReferrals),a(3),p(d(11,8,"referrals.revenue")),a(3),p(t.formatRevenue(r.totalRevenue))}}function $(o,e){if(o&1){let r=_();i(0,"div",16)(1,"button",17),v("click",function(){let c=f(r).$implicit,g=C();return u(g.viewDetail(c.id))}),s(2),m(3,"translate"),n()()}o&2&&(a(2),w(" ",d(3,1,"common.view")," "))}var N=class o{referralsService=b(B);router=b(I);referrals=[];doctors=[];topDoctors=[];loading=!1;pagination=null;totalReferrals=0;totalRevenue=0;columns=[{key:"referralDate",label:"referrals.date",sortable:!0},{key:"doctorName",label:"referrals.doctor"},{key:"patientName",label:"referrals.patient"},{key:"revenue",label:"referrals.revenue",sortable:!0}];ngOnInit(){this.loadData()}loadData(){this.loading=!0,this.referralsService.getReferrals().subscribe({next:e=>{this.referrals=e,this.totalReferrals=e.length,this.totalRevenue=e.reduce((r,t)=>r+t.revenue,0),this.loading=!1}}),this.referralsService.getDoctors().subscribe({next:e=>{this.doctors=e,this.topDoctors=[...e].sort((r,t)=>t.totalRevenue-r.totalRevenue).slice(0,3)}})}handlePageChange(e){this.pagination&&(this.pagination.page=e,this.loadData())}handleSearch(e){this.loadData()}viewDetail(e){this.router.navigate(["/growth/referrals",e])}formatRevenue(e){return e.toFixed(2)}static \u0275fac=function(r){return new(r||o)};static \u0275cmp=R({type:o,selectors:[["app-referrals-list"]],decls:16,vars:12,consts:[["actionTemplate",""],[1,"space-y-6"],["title","referrals.title",3,"onSearch","showSearch"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],["label","referrals.totalReferrals",3,"value"],["label","referrals.totalRevenue",3,"value"],["label","referrals.totalDoctors",3,"value"],[1,"p-6","rounded-lg",2,"background-color","var(--card-bg)"],[1,"text-lg","font-semibold","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[3,"title","subtitle"],[3,"onPageChange","columns","data","pagination","loading","emptyMessage"],[1,"mt-4","space-y-2","text-sm"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"font-medium"],[1,"flex","gap-2"],[1,"text-sm","px-3","py-1","rounded","text-blue-600","hover:bg-blue-50",3,"click"]],template:function(r,t){if(r&1){let c=_();i(0,"div",1)(1,"app-action-toolbar",2),v("onSearch",function(h){return f(c),u(t.handleSearch(h))}),n(),i(2,"div",3),D(3,"app-stat-card",4)(4,"app-stat-card",5)(5,"app-stat-card",6),n(),i(6,"div",7)(7,"h3",8),s(8),m(9,"translate"),n(),i(10,"div",9),x(11,O,14,10,"app-profile-card",10,F),n()(),i(13,"app-table",11),v("onPageChange",function(h){return f(c),u(t.handlePageChange(h))}),y(14,$,4,3,"ng-template",null,0,T),n()()}r&2&&(a(),l("showSearch",!0),a(2),l("value",t.totalReferrals),a(),l("value",t.formatRevenue(t.totalRevenue)),a(),l("value",t.doctors.length),a(3),p(d(9,10,"referrals.topDoctors")),a(3),S(t.topDoctors),a(2),l("columns",t.columns)("data",t.referrals)("pagination",t.pagination)("loading",t.loading)("emptyMessage","referrals.empty"))},dependencies:[E,P,V,L,M,k],encapsulation:2})};export{N as ReferralsListComponent};
