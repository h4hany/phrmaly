import{a as Q}from"./chunk-XB3VLMSQ.js";import{a as H}from"./chunk-NMDNQUB4.js";import{a as F}from"./chunk-JYPY3KCN.js";import{a as A}from"./chunk-XG6FMBJJ.js";import{a as z}from"./chunk-6CFKC637.js";import"./chunk-BYXBJQAS.js";import{a as N,b as j}from"./chunk-3UJCRMW3.js";import{d as I}from"./chunk-C3O3TVFX.js";import{$a as r,Ab as s,Bb as p,Fa as P,Ka as w,Q as x,Qa as S,Va as M,W as d,X as c,Y as u,Ya as L,Z as v,Za as T,_a as a,_b as E,ab as h,cb as b,db as y,eb as g,ib as k,jb as V,kb as B,mb as f,nb as C,ob as _,wa as o}from"./chunk-E4S7NVXB.js";import"./chunk-C6Q5SG76.js";var G=["deleteModal"],D=(n,e)=>e.id;function U(n,e){if(n&1&&h(0,"app-alert",2),n&2){let t=g();S("title",t.errorMessage)}}function $(n,e){n&1&&(a(0,"div",16)(1,"div",20),f(2),s(3,"translate"),r()()),n&2&&(o(2),C(p(3,1,"staff.loading")))}function q(n,e){n&1&&(a(0,"div",17),u(),a(1,"svg",21),h(2,"path",22),r(),v(),a(3,"p",23),f(4),s(5,"translate"),r()()),n&2&&(o(4),C(p(5,1,"staff.noMembers")))}function W(n,e){if(n&1){let t=b();a(0,"app-profile-card",25),y("view",function(){let l=d(t).$implicit,m=g(2);return c(m.viewStaff(l.id))})("edit",function(){let l=d(t).$implicit,m=g(2);return c(m.editStaff(l.id))})("delete",function(){let l=d(t).$implicit,m=g(2);return c(m.confirmDelete(l))}),r()}if(n&2){let t=e.$implicit,i=g(2);S("avatar",t.avatarUrl)("name",t.fullName)("role",i.getRoleLabel(t.role))("email",t.email)("phone",t.phone)("joinedAt",t.createdAt)("badges",i.getBadges(t))("status",t.status)}}function Y(n,e){if(n&1&&(a(0,"div",18),L(1,W,1,8,"app-profile-card",24,D),r()),n&2){let t=g();o(),T(t.staff)}}var R=class n{router=x(I);pharmacyStaffService=x(H);translationService=x(N);deleteModal;staff=[];loading=!1;errorMessage="";searchQuery="";deleting=!1;selectedStaffId=null;selectedStaffName="";pagination={page:1,pageSize:10,total:0,totalPages:0};ngOnInit(){this.loadStaff()}loadStaff(){this.loading=!0,this.pharmacyStaffService.getAll({page:this.pagination.page,pageSize:this.pagination.pageSize}).subscribe({next:e=>{this.staff=e.data,this.pagination={page:e.page,pageSize:e.pageSize,total:e.total,totalPages:e.totalPages},this.loading=!1},error:e=>{this.errorMessage="Failed to load staff members",this.loading=!1}})}onSearch(){this.searchQuery.trim()?this.pharmacyStaffService.search(this.searchQuery).subscribe({next:e=>{this.staff=e,this.pagination={page:1,pageSize:10,total:e.length,totalPages:Math.ceil(e.length/10)}},error:()=>{this.errorMessage="Search failed"}}):this.loadStaff()}navigateToNew(){this.router.navigate(["/pharmacy-staff","new"])}viewStaff(e){this.router.navigate(["/pharmacy-staff",e])}editStaff(e){this.router.navigate(["/pharmacy-staff",e,"edit"])}confirmDelete(e){this.selectedStaffId=e.id,this.selectedStaffName=e.fullName,this.deleteModal.open()}deleteStaff(){this.selectedStaffId&&(this.deleting=!0,this.pharmacyStaffService.delete(this.selectedStaffId).subscribe({next:e=>{e?(this.deleteModal.close(),this.loadStaff(),this.selectedStaffId=null,this.selectedStaffName=""):this.errorMessage="Failed to delete staff member",this.deleting=!1},error:()=>{this.errorMessage="Failed to delete staff member",this.deleting=!1}}))}getRoleLabel(e){let i={account_owner:"staff.accountOwner",pharmacy_manager:"staff.pharmacyManager",pharmacy_staff:"staff.pharmacyStaff"}[e]||e;return this.translationService.translate(i)||e}getBadges(e){let t=[];return e.role==="pharmacy_manager"?t.push({label:"Manager",variant:"info"}):e.role==="account_owner"&&t.push({label:"Owner",variant:"warning"}),t}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=P({type:n,selectors:[["app-pharmacy-staff-list"]],viewQuery:function(t,i){if(t&1&&k(G,5),t&2){let l;V(l=B())&&(i.deleteModal=l.first)}},decls:39,vars:30,consts:[["deleteModal",""],[1,"space-y-6"],["type","error",3,"title"],[1,"flex","items-center","justify-between","gap-4"],[1,"flex-1","max-w-lg"],[1,"relative"],["type","text",1,"w-full","px-4","py-2","pl-10","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-[#166534]","focus:border-[#166534]",3,"input","placeholder","value"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","absolute","left-3","top-2.5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],[1,"flex","gap-3"],["variant","outline"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","inline","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"],["variant","primary",3,"onClick"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"flex","items-center","justify-center","py-12"],[1,"flex","flex-col","items-center","justify-center","py-12","text-gray-500"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],[3,"confirmed","title","showFooter","confirmText","confirmLoading"],[1,"text-gray-500"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","mb-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"text-lg","font-medium"],[3,"avatar","name","role","email","phone","joinedAt","badges","status"],[3,"view","edit","delete","avatar","name","role","email","phone","joinedAt","badges","status"]],template:function(t,i){if(t&1){let l=b();a(0,"div",1),w(1,U,1,1,"app-alert",2),a(2,"div",3)(3,"div",4)(4,"div",5)(5,"input",6),s(6,"translate"),y("input",function(O){return d(l),i.searchQuery=O.target.value,c(i.onSearch())}),r(),u(),a(7,"svg",7),h(8,"path",8),r()()(),v(),a(9,"div",9)(10,"app-button",10),u(),a(11,"svg",11),h(12,"path",12),r(),f(13),s(14,"translate"),r(),v(),a(15,"app-button",10),u(),a(16,"svg",11),h(17,"path",13),r(),f(18),s(19,"translate"),r(),v(),a(20,"app-button",14),y("onClick",function(){return d(l),c(i.navigateToNew())}),u(),a(21,"svg",11),h(22,"path",15),r(),f(23),s(24,"translate"),r()()(),w(25,$,4,3,"div",16)(26,q,6,3,"div",17)(27,Y,3,0,"div",18),v(),a(28,"app-modal",19,0),s(30,"translate"),s(31,"translate"),y("confirmed",function(){return d(l),c(i.deleteStaff())}),a(32,"p"),f(33),s(34,"translate"),a(35,"strong"),f(36),r(),f(37),s(38,"translate"),r()()()}t&2&&(o(),M(i.errorMessage?1:-1),o(4),S("placeholder",p(6,14,"common.search"))("value",i.searchQuery),o(8),_(" ",p(14,16,"common.filters")," "),o(5),_(" ",p(19,18,"common.export")," "),o(5),_(" ",p(24,20,"staff.addNew")," "),o(2),M(i.loading?25:i.staff.length===0?26:27),o(3),S("title",p(30,22,"staff.delete"))("showFooter",!0)("confirmText",p(31,24,"common.delete"))("confirmLoading",i.deleting),o(5),_("",p(34,26,"staff.deleteConfirm")," "),o(3),C(i.selectedStaffName),o(),_("? ",p(38,28,"modal.cannotUndo"),""))},dependencies:[E,z,F,A,j,Q],encapsulation:2})};export{R as PharmacyStaffListComponent};
