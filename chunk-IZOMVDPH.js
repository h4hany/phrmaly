import{a as G}from"./chunk-3MRMRH3F.js";import{a as H}from"./chunk-QDLVDHOW.js";import{a as U}from"./chunk-JYPY3KCN.js";import{e as R,g as F,o as W,p as O,q as z,w as D}from"./chunk-TK76J465.js";import{a as N}from"./chunk-6CFKC637.js";import{a as j}from"./chunk-EIOKHCL2.js";import{a as q}from"./chunk-5PFWNSG3.js";import{a as V,b as A}from"./chunk-3UJCRMW3.js";import{$a as a,Ab as r,Bb as p,Cb as P,Fa as I,Ka as C,Q as T,Qa as u,Va as x,W as y,X as S,Xb as M,_a as i,_b as L,ab as E,cb as _,db as g,eb as f,mb as o,nb as l,ob as v,tb as b,ub as h,vb as k,wa as t}from"./chunk-E4S7NVXB.js";import{a as w,b as B}from"./chunk-C6Q5SG76.js";function K(c,n){if(c&1){let e=_();i(0,"app-button",23),g("onClick",function(){y(e);let m=f(2);return S(m.assignTicket())}),o(1),r(2,"translate"),a()}c&2&&(t(),v(" ",p(2,1,"platform.support.assign")," "))}function Q(c,n){if(c&1){let e=_();i(0,"app-button",23),g("onClick",function(){y(e);let m=f(2);return S(m.resolveTicket())}),o(1),r(2,"translate"),a()}c&2&&(t(),v(" ",p(2,1,"platform.support.resolve")," "))}function X(c,n){if(c&1){let e=_();i(0,"app-modal",27,0),r(2,"translate"),g("confirmed",function(){y(e);let m=f();return S(m.selectedTicket=null)}),i(3,"div",1)(4,"div",28)(5,"div")(6,"label",7),o(7),r(8,"translate"),a(),i(9,"app-badge",29),o(10),r(11,"translate"),a()(),i(12,"div")(13,"label",7),o(14),r(15,"translate"),a(),i(16,"app-badge",29),o(17),r(18,"translate"),a()(),i(19,"div")(20,"label",7),o(21),r(22,"translate"),a(),i(23,"p",30),o(24),r(25,"translate"),a()(),i(26,"div")(27,"label",7),o(28),r(29,"translate"),a(),i(30,"p",30),o(31),r(32,"date"),a()()(),i(33,"div")(34,"label",7),o(35),r(36,"translate"),a(),i(37,"p",31),o(38),a()(),i(39,"div",32),C(40,K,3,3,"app-button",33)(41,Q,3,3,"app-button",33),a()()()}if(c&2){let e=f();u("title",e.selectedTicket.subject)("showFooter",!0)("confirmText",p(2,17,"common.close")),t(7),l(p(8,19,"platform.support.status")),t(2),u("variant",e.getStatusVariant(e.selectedTicket.status)),t(),v(" ",p(11,21,e.getStatusLabel(e.selectedTicket.status))," "),t(4),l(p(15,23,"platform.support.priority")),t(2),u("variant",e.getPriorityVariant(e.selectedTicket.priority)),t(),v(" ",p(18,25,e.getPriorityLabel(e.selectedTicket.priority))," "),t(4),l(p(22,27,"platform.support.category")),t(3),l(p(25,29,e.getCategoryLabel(e.selectedTicket.category))),t(4),l(p(29,31,"platform.support.createdAt")),t(3),l(P(32,33,e.selectedTicket.createdAt,"short")),t(4),l(p(36,36,"platform.support.description")),t(3),l(e.selectedTicket.description),t(2),x(e.selectedTicket.status==="open"?40:-1),t(),x(e.selectedTicket.status==="assigned"||e.selectedTicket.status==="in_progress"?41:-1)}}var J=class c{ticketsService=T(G);translationService=T(V);loading=!1;tickets=[];selectedTicket=null;filters={status:"",priority:"",category:""};openTickets=0;inProgressTickets=0;resolvedTickets=0;avgResponseTime=2.5;pagination={page:1,pageSize:10,total:0,totalPages:0};columns=[{key:"subject",label:"platform.support.subject",sortable:!0},{key:"accountId",label:"platform.support.account",sortable:!0},{key:"priority",label:"platform.support.priority",sortable:!0},{key:"status",label:"platform.support.status",sortable:!0},{key:"createdAt",label:"platform.support.createdAt",sortable:!0}];ngOnInit(){this.loadTickets()}loadTickets(){this.loading=!0,this.ticketsService.getAll({page:this.pagination.page,pageSize:this.pagination.pageSize,status:this.filters.status||void 0,priority:this.filters.priority||void 0,category:this.filters.category||void 0}).subscribe({next:n=>{this.tickets=n.data.map(e=>B(w({},e),{priority:this.translationService.translate(this.getPriorityLabel(e.priority)),status:this.translationService.translate(this.getStatusLabel(e.status)),createdAt:new Date(e.createdAt).toLocaleDateString()})),this.pagination={page:n.page,pageSize:n.pageSize,total:n.total,totalPages:n.totalPages},this.calculateStats(n.data),this.loading=!1},error:()=>{this.loading=!1}})}calculateStats(n){this.openTickets=n.filter(e=>e.status==="open").length,this.inProgressTickets=n.filter(e=>e.status==="in_progress"||e.status==="assigned").length,this.resolvedTickets=n.filter(e=>e.status==="resolved"||e.status==="closed").length}applyFilters(){this.pagination.page=1,this.loadTickets()}onPageChange(n){this.pagination.page=n,this.loadTickets()}viewTicket(n){this.ticketsService.getById(n.id).subscribe({next:e=>{this.selectedTicket=e}})}assignTicket(){this.selectedTicket&&this.ticketsService.assignTicket(this.selectedTicket.id,"admin001").subscribe({next:n=>{this.selectedTicket=n,this.loadTickets()}})}resolveTicket(){this.selectedTicket&&this.ticketsService.updateStatus(this.selectedTicket.id,"resolved").subscribe({next:n=>{this.selectedTicket=n,this.loadTickets()}})}getStatusLabel(n){return{open:"platform.support.statusOpen",assigned:"platform.support.statusAssigned",in_progress:"platform.support.statusInProgress",resolved:"platform.support.statusResolved",closed:"platform.support.statusClosed"}[n]||n}getStatusVariant(n){return{open:"danger",assigned:"warning",in_progress:"info",resolved:"success",closed:"default"}[n]||"default"}getPriorityLabel(n){return{urgent:"platform.support.priorityUrgent",high:"platform.support.priorityHigh",medium:"platform.support.priorityMedium",low:"platform.support.priorityLow"}[n]||n}getPriorityVariant(n){return{urgent:"danger",high:"warning",medium:"info",low:"default"}[n]||"default"}getCategoryLabel(n){return{technical:"platform.support.categoryTechnical",billing:"platform.support.categoryBilling",feature_request:"platform.support.categoryFeatureRequest",bug:"platform.support.categoryBug",other:"platform.support.categoryOther"}[n]||n}static \u0275fac=function(e){return new(e||c)};static \u0275cmp=I({type:c,selectors:[["app-support"]],decls:83,vars:86,consts:[["ticketModal",""],[1,"space-y-6"],[1,"text-2xl","font-bold","text-[var(--text-primary)]"],[1,"text-sm","text-[var(--card-text)]","mt-1"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[3,"label","value","icon"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-4"],[1,"block","text-sm","font-medium","text-[var(--card-text)]","mb-1"],[1,"w-full","px-4","py-2","border","border-[var(--border-color)]","rounded-[var(--radius-md)]","text-sm","bg-[var(--card-bg)]","text-[var(--text-primary)]",3,"ngModelChange","ngModel"],["value",""],["value","open"],["value","assigned"],["value","in_progress"],["value","resolved"],["value","urgent"],["value","high"],["value","medium"],["value","low"],["value","technical"],["value","billing"],["value","feature_request"],["value","bug"],[1,"flex","items-end"],["variant","primary","size","sm",3,"onClick"],[1,"bg-[var(--card-bg)]","rounded-[var(--radius-lg)]","shadow-[var(--shadow-sm)]","p-6"],[3,"onPageChange","onRowClick","columns","data","pagination","loading","emptyMessage"],[3,"title","showFooter","confirmText"],[3,"confirmed","title","showFooter","confirmText"],[1,"grid","grid-cols-2","gap-4"],[3,"variant"],[1,"text-[var(--text-primary)]"],[1,"text-[var(--text-primary)]","whitespace-pre-wrap"],[1,"flex","gap-2"],["variant","primary","size","sm"]],template:function(e,s){e&1&&(i(0,"div",1)(1,"div")(2,"h1",2),o(3),r(4,"translate"),a(),i(5,"p",3),o(6),r(7,"translate"),a()(),i(8,"div",4),E(9,"app-stat-card",5)(10,"app-stat-card",5)(11,"app-stat-card",5)(12,"app-stat-card",5),a(),i(13,"div",6)(14,"div",4)(15,"div")(16,"label",7),o(17),r(18,"translate"),a(),i(19,"select",8),k("ngModelChange",function(d){return h(s.filters.status,d)||(s.filters.status=d),d}),i(20,"option",9),o(21),r(22,"translate"),a(),i(23,"option",10),o(24),r(25,"translate"),a(),i(26,"option",11),o(27),r(28,"translate"),a(),i(29,"option",12),o(30),r(31,"translate"),a(),i(32,"option",13),o(33),r(34,"translate"),a()()(),i(35,"div")(36,"label",7),o(37),r(38,"translate"),a(),i(39,"select",8),k("ngModelChange",function(d){return h(s.filters.priority,d)||(s.filters.priority=d),d}),i(40,"option",9),o(41),r(42,"translate"),a(),i(43,"option",14),o(44),r(45,"translate"),a(),i(46,"option",15),o(47),r(48,"translate"),a(),i(49,"option",16),o(50),r(51,"translate"),a(),i(52,"option",17),o(53),r(54,"translate"),a()()(),i(55,"div")(56,"label",7),o(57),r(58,"translate"),a(),i(59,"select",8),k("ngModelChange",function(d){return h(s.filters.category,d)||(s.filters.category=d),d}),i(60,"option",9),o(61),r(62,"translate"),a(),i(63,"option",18),o(64),r(65,"translate"),a(),i(66,"option",19),o(67),r(68,"translate"),a(),i(69,"option",20),o(70),r(71,"translate"),a(),i(72,"option",21),o(73),r(74,"translate"),a()()(),i(75,"div",22)(76,"app-button",23),g("onClick",function(){return s.applyFilters()}),o(77),r(78,"translate"),a()()()(),i(79,"div",24)(80,"app-table",25),r(81,"translate"),g("onPageChange",function(d){return s.onPageChange(d)})("onRowClick",function(d){return s.viewTicket(d)}),a()()(),C(82,X,42,38,"app-modal",26)),e&2&&(t(3),l(p(4,42,"platform.support.title")),t(3),l(p(7,44,"platform.support.subtitle")),t(3),u("label","platform.support.openTickets")("value",s.openTickets)("icon","alert"),t(),u("label","platform.support.inProgress")("value",s.inProgressTickets)("icon","clock"),t(),u("label","platform.support.resolved")("value",s.resolvedTickets)("icon","check-circle"),t(),u("label","platform.support.avgResponseTime")("value",s.avgResponseTime+"h")("icon","chart"),t(5),l(p(18,46,"platform.support.status")),t(2),b("ngModel",s.filters.status),t(2),l(p(22,48,"common.all")),t(3),l(p(25,50,"platform.support.statusOpen")),t(3),l(p(28,52,"platform.support.statusAssigned")),t(3),l(p(31,54,"platform.support.statusInProgress")),t(3),l(p(34,56,"platform.support.statusResolved")),t(4),l(p(38,58,"platform.support.priority")),t(2),b("ngModel",s.filters.priority),t(2),l(p(42,60,"common.all")),t(3),l(p(45,62,"platform.support.priorityUrgent")),t(3),l(p(48,64,"platform.support.priorityHigh")),t(3),l(p(51,66,"platform.support.priorityMedium")),t(3),l(p(54,68,"platform.support.priorityLow")),t(4),l(p(58,70,"platform.support.category")),t(2),b("ngModel",s.filters.category),t(2),l(p(62,72,"common.all")),t(3),l(p(65,74,"platform.support.categoryTechnical")),t(3),l(p(68,76,"platform.support.categoryBilling")),t(3),l(p(71,78,"platform.support.categoryFeatureRequest")),t(3),l(p(74,80,"platform.support.categoryBug")),t(4),v(" ",p(78,82,"common.search")," "),t(3),u("columns",s.columns)("data",s.tickets)("pagination",s.pagination)("loading",s.loading)("emptyMessage",p(81,84,"platform.support.noTickets")),t(2),x(s.selectedTicket?82:-1))},dependencies:[L,M,D,O,z,W,R,F,H,N,A,U,j,q],encapsulation:2})};export{J as SupportComponent};
